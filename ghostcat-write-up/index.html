
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Retro | write-up</title>
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" type="text/css" href="../assets/built/screen.css?v=0a4893ecd9">

    <link rel="icon" href="../favicon.png" type="image/png">
    <link rel="canonical" href="index.html">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <link rel="amphtml" href="amp/index.html">
    
    <meta property="og:site_name" content="fr33s0ul">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Retro | write-up">
    <meta property="og:description" content="Hello everyone, today's CTF is provided by tryhackme.com and made by Darkstar7471 it is a web server based on windows, before we start enumerating the machine we have to take in consideration the note we got, which is we won't get any response for any ping request, nmap does">
    <meta property="og:url" content="https://fr33s0ul.tech/ghostcat-write-up/">
    <meta property="og:image" content="https://fr33s0ul.tech/content/images/size/w1000/2020/04/HJI.png">
    <meta property="article:published_time" content="2020-04-03T11:01:50.000Z">
    <meta property="article:modified_time" content="2020-04-10T15:48:17.000Z">
    <meta property="article:tag" content="CTF">
    
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Retro | write-up">
    <meta name="twitter:description" content="Hello everyone, today's CTF is provided by tryhackme.com and made by Darkstar7471 it is a web server based on windows, before we start enumerating the machine we have to take in consideration the note we got, which is we won't get any response for any ping request, nmap does">
    <meta name="twitter:url" content="https://fr33s0ul.tech/ghostcat-write-up/">
    <meta name="twitter:image" content="https://fr33s0ul.tech/content/images/size/w1000/2020/04/HJI.png">
    <meta name="twitter:label1" content="Written by">
    <meta name="twitter:data1" content="fr33s0ul">
    <meta name="twitter:label2" content="Filed under">
    <meta name="twitter:data2" content="CTF">
    <meta name="twitter:site" content="@fr33soul_">
    <meta name="twitter:creator" content="@fr33soul_">
    <meta property="og:image:width" content="700">
    <meta property="og:image:height" content="543">
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "fr33s0ul",
        "url": "https://fr33s0ul.tech/",
        "logo": {
            "@type": "ImageObject",
            "url": "https://fr33s0ul.tech/content/images/size/w1000/2020/03/logo.gif",
            "width": 300,
            "height": 41
        }
    },
    "author": {
        "@type": "Person",
        "name": "fr33s0ul",
        "image": {
            "@type": "ImageObject",
            "url": "https://fr33s0ul.tech/content/images/size/w1000/2020/03/asdasd.gif",
            "width": 600,
            "height": 594
        },
        "url": "https://fr33s0ul.tech/author/fr33s0ul/",
        "sameAs": [
            "https://twitter.com/fr33soul_"
        ]
    },
    "headline": "Retro | write-up",
    "url": "https://fr33s0ul.tech/ghostcat-write-up/",
    "datePublished": "2020-04-03T11:01:50.000Z",
    "dateModified": "2020-04-10T15:48:17.000Z",
    "image": {
        "@type": "ImageObject",
        "url": "https://fr33s0ul.tech/content/images/size/w1000/2020/04/HJI.png",
        "width": 700,
        "height": 543
    },
    "keywords": "CTF",
    "description": "Hello everyone, today&#x27;s CTF is provided by tryhackme.com and made by\nDarkstar7471 it is a web server based on windows, before we start enumerating\nthe machine we have to take in consideration the note we got, which is we won&#x27;t\nget any response for any ping request, nmap does have a flag for that -nP\n\nsudo nmap -Pn -sV -p- -vv &lt;target-machine&gt;\n\nAfter the quick scan we did on our target, we can see that it is a IIS Windows\nServer, port 80 is running an http server and we have port 3389 that can al",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://fr33s0ul.tech/"
    }
}
    </script>

    <meta name="generator" content="Ghost 3.38">
    <link rel="alternate" type="application/rss+xml" title="fr33s0ul" href="../rss/index.html">
    <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-111725042-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-111725042-2');
</script>

</head>
<body class="post-template tag-ctf">

    <div class="site-wrapper">

        

<header class="site-header">
    <div class="outer site-nav-main">
    <div class="inner">
        <nav class="site-nav">
    <div class="site-nav-left-wrapper">
        <div class="site-nav-left">
                <a class="site-nav-logo" href="../"><img src="../content/images/size/w1000/2020/03/logo.gif" alt="fr33s0ul"></a>
            <div class="site-nav-content">
                    <ul class="nav">
    <li class="nav-home"><a href="../">Home</a></li>
    <li class="nav-whoami"><a href="../whoami/">whoami</a></li>
    <li class="nav-whispers"><a href="../whispers/">Whispers</a></li>
    <li class="nav-ai"><a href="../tag/ai/">Ai</a></li>
    <li class="nav-ctf"><a href="../tag/ctf/">CTF</a></li>
</ul>

                    <span class="nav-post-title ">Retro | write-up</span>
            </div>
        </div>
    </div>
    <div class="site-nav-right">
            <div class="social-links">
                    <a class="social-link social-link-tw" href="https://twitter.com/fr33soul_" title="Twitter" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 32 32"><path d="M30.063 7.313c-.813 1.125-1.75 2.125-2.875 2.938v.75c0 1.563-.188 3.125-.688 4.625a15.088 15.088 0 0 1-2.063 4.438c-.875 1.438-2 2.688-3.25 3.813a15.015 15.015 0 0 1-4.625 2.563c-1.813.688-3.75 1-5.75 1-3.25 0-6.188-.875-8.875-2.625.438.063.875.125 1.375.125 2.688 0 5.063-.875 7.188-2.5-1.25 0-2.375-.375-3.375-1.125s-1.688-1.688-2.063-2.875c.438.063.813.125 1.125.125.5 0 1-.063 1.5-.25-1.313-.25-2.438-.938-3.313-1.938a5.673 5.673 0 0 1-1.313-3.688v-.063c.813.438 1.688.688 2.625.688a5.228 5.228 0 0 1-1.875-2c-.5-.875-.688-1.813-.688-2.75 0-1.063.25-2.063.75-2.938 1.438 1.75 3.188 3.188 5.25 4.25s4.313 1.688 6.688 1.813a5.579 5.579 0 0 1 1.5-5.438c1.125-1.125 2.5-1.688 4.125-1.688s3.063.625 4.188 1.813a11.48 11.48 0 0 0 3.688-1.375c-.438 1.375-1.313 2.438-2.563 3.188 1.125-.125 2.188-.438 3.313-.875z"></path></svg>
</a>
            </div>
                <a class="rss-button" href="https://feedly.com/i/subscription/feed/https://fr33s0ul.tech/rss/" title="RSS" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><circle cx="6.18" cy="17.82" r="2.18"></circle><path d="M4 4.44v2.83c7.03 0 12.73 5.7 12.73 12.73h2.83c0-8.59-6.97-15.56-15.56-15.56zm0 5.66v2.83c3.9 0 7.07 3.17 7.07 7.07h2.83c0-5.47-4.43-9.9-9.9-9.9z"></path></svg>
</a>

    </div>
</nav>
    </div>
</div></header>


<main id="site-main" class="site-main outer">
    <div class="inner">

        <article class="post-full post tag-ctf ">

            <header class="post-full-header">

                <section class="post-full-tags">
                    <a href="../tag/ctf/">CTF</a>
                </section>

                <h1 class="post-full-title">Retro | write-up</h1>


                <div class="post-full-byline">

                    <section class="post-full-byline-content">

                        <ul class="author-list">
                            <li class="author-list-item">

                                <div class="author-card">
                                    <img class="author-profile-image" src="../content/images/size/w100/2020/03/asdasd.gif" alt="fr33s0ul">
                                    <div class="author-info">
                                        <h2>fr33s0ul</h2>
                                        <p>Read <a href="../author/fr33s0ul/">more posts</a> by this author.</p>
                                    </div>
                                </div>

                                <a href="../author/fr33s0ul/" class="author-avatar">
                                    <img class="author-profile-image" src="../content/images/size/w100/2020/03/asdasd.gif" alt="fr33s0ul">
                                </a>

                            </li>
                        </ul>

                        <section class="post-full-byline-meta">
                            <h4 class="author-name"><a href="../author/fr33s0ul/">fr33s0ul</a></h4>
                            <div class="byline-meta-content">
                                <time class="byline-meta-date" datetime="2020-04-03">3 Apr 2020</time>
                                <span class="byline-reading-time"><span class="bull">•</span> 4 min read</span>
                            </div>
                        </section>

                    </section>


                </div>
            </header>

            <figure class="post-full-image">
                <img srcset="../content/images/size/w300/2020/04/HJI.png 300w,
                           ../content/images/size/w600/2020/04/HJI.png 600w,
                          ../content/images/size/w1000/2020/04/HJI. png 1000w,
                         ../content/images/size/w2000/2020/04/HJI. png 2000w" sizes="(max-width: 800px) 400px,
                        (max-width: 1170px) 1170px,
                            2000px" src="../content/images/size/w2000/2020/04/HJI.png" alt="Retro | write-up">
            </figure>

            <section class="post-full-content">
                <div class="post-content">
                    <p>Hello everyone, today's CTF is provided by tryhackme.com and made by Darkstar7471 it is a web server based on windows, before we start enumerating the machine we have to take in consideration the note we got, which is we won't get any response for any ping request, nmap does have a flag for that <strong>-nP</strong></p><pre><code>sudo nmap -Pn -sV -p- -vv &lt;target-machine&gt;</code></pre><figure class="kg-card kg-image-card"><img src="../content/images/2020/04/Screenshot-2020-03-31-at-12.55.36-1.png" class="kg-image"></figure><p>After the quick scan we did on our target, we can see that it is a IIS Windows Server, port 80 is running an http server and we have port 3389 that can allow us to get a remote desktop {RDP} </p><figure class="kg-card kg-image-card"><img src="../content/images/2020/04/Screenshot-2020-03-31-at-12.56.26.png" class="kg-image"></figure><figure class="kg-card kg-image-card"><img src="../content/images/2020/04/Screenshot-2020-03-31-at-12.59.08.png" class="kg-image"></figure><figure class="kg-card kg-image-card"><img src="../content/images/2020/04/Screenshot-2020-03-31-at-12.59.36.png" class="kg-image"></figure><p>So we visited the port 80, found the landing page of windows server kept digging for directories the only one that is available is <strong>/retro</strong> or <strong>/Retro</strong>, it doesn't matter.</p><p>the first thing got my eye is the User who shared the article in this site <strong>"Wade"</strong> I clicked on the user it showed me all the articles shared by the user, it felt like a wordpress but I wanted to make sure that it is! I ran another directory scan in the directory <strong>/retro</strong> to see if we have anything, but before that, a comment got my eye.</p><p>It looks like our user Wade doesn't have a very good memory so he left us a little note in a comment on one of his articles.</p><figure class="kg-card kg-image-card"><img src="../content/images/2020/04/Screenshot-2020-03-31-at-13.00.38.png" class="kg-image"></figure><figure class="kg-card kg-image-card"><img src="../content/images/2020/04/Screenshot-2020-03-31-at-13.01.50.png" class="kg-image"></figure><p>Just like I thought, it is a wordpress! let's jump to wp-login.php and use the username we have and the note the user left just in case he forgets it, maybe its a bluff or maybe a hint for the password.</p><figure class="kg-card kg-image-card"><img src="../content/images/2020/04/Screenshot-2020-03-31-at-13.02.35.png" class="kg-image"></figure><p>well guess what it is the password for the user, the next part of the logging, I got too excited and forgot to take screenshots, so the step after I created a php reverse shell with <strong>msfvenom</strong> and went to the theme editor in the dashboard, used the <strong>404.php</strong> to insert my php code opened metasploit set up my settings and ran the listener and we got a shell </p><figure class="kg-card kg-image-card"><img src="../content/images/2020/04/Screenshot-2020-03-31-at-13.04.41.png" class="kg-image"></figure><figure class="kg-card kg-image-card"><img src="../content/images/2020/04/Screenshot-2020-03-31-at-13.09.18.png" class="kg-image"></figure><!--kg-card-begin: html--><iframe src="https://giphy.com/embed/IPqbZhStIeZdS" width="480" height="480" frameborder="0" class="giphy-embed" allowfullscreen></iframe><p><a href="https://giphy.com/gifs/rainbow-nintendo-mario-IPqbZhStIeZdS"></a></p><!--kg-card-end: html--><blockquote>Privilege escalation time </blockquote><p>It is a windows machine so i ran <strong><a href="https://github.com/AonCyberLabs/Windows-Exploit-Suggester">Windows-Exploit-Suggester</a> </strong>made<strong> </strong>by<strong> <a href="https://github.com/AonCyberLabs">Aon's Cyber Labs</a> </strong>it's a very powerful python script and straight forward so I saved the systeminfo of the machine, ran the command and got all the exploits that can be used for this specific version of window server, in the command I added at the end <strong>-l</strong> to tell our script to find local exploits, because we want <strong>Administrator</strong> user</p><pre><code>python windows-exploit-suggester.py --database &lt;xls database  of exploits provided with the script&gt; --systeminfor &lt;systeminfo saved in a txt file&gt; --ostext &lt;Os&gt; -l</code></pre><figure class="kg-card kg-image-card"><img src="../content/images/2020/04/Screenshot-2020-03-31-at-13.41.27.png" class="kg-image"></figure><figure class="kg-card kg-image-card"><img src="../content/images/2020/04/Screenshot-2020-03-31-at-13.36.40-1.png" class="kg-image"></figure><p>Let's use <strong>MS16-075</strong>, as we can see the bug is considered a medium risk because you need to have access first to the machine and then exploit it if you want to read more about this vulnerability click <strong><a href="https://docs.microsoft.com/en-us/security-updates/SecurityBulletins/2016/ms16-075">MS16-075</a></strong></p><figure class="kg-card kg-image-card"><img src="../content/images/2020/04/Screenshot-2020-03-31-at-13.43.22.png" class="kg-image"></figure><p>metasploit does have the exploit there, all you have to do is use the exploit look at the options, one of the requirements is a session in metasploit that we already have you set the number of the session, run the exploit and we have a shell running NT AUTHORITY\SYSTEM.</p><p>That's it for today if you have any question don't be shy getting in touch, and don't forget that what I used is the easy way to exploit this machine, feel free to explore the other ways in.</p><p>Happy Hacking!</p>
                </div>
            </section>



        </article>

    </div>
</main>

<aside class="read-next outer">
    <div class="inner">
        <div class="read-next-feed">
                <article class="read-next-card">
                    <header class="read-next-card-header">
                        <h3><span>More in</span> <a href="../tag/ctf/">CTF</a></h3>
                    </header>
                    <div class="read-next-card-content">
                        <ul>
                            <li>
                                <h4><a href="../yearoftherabbit-ctf-write-up/">YearOfTheRabbit | CTF write-up</a></h4>
                                <div class="read-next-card-meta">
                                    <p><time datetime="2020-04-22">22 Apr 2020</time> –
                                        9 min read</p>
                                </div>
                            </li>
                            <li>
                                <h4><a href="../dogcat-thm-write-up/">dogcat | THM write-up</a></h4>
                                <div class="read-next-card-meta">
                                    <p><time datetime="2020-04-19">19 Apr 2020</time> –
                                        6 min read</p>
                                </div>
                            </li>
                            <li>
                                <h4><a href="../lfi/">Local file inclusion | write-up</a></h4>
                                <div class="read-next-card-meta">
                                    <p><time datetime="2020-04-17">17 Apr 2020</time> –
                                        6 min read</p>
                                </div>
                            </li>
                        </ul>
                    </div>
                    <footer class="read-next-card-footer">
                        <a href="../tag/ctf/">See all 15 posts
                            →</a>
                    </footer>
                </article>

                <article class="post-card post tag-ctf ">

    <a class="post-card-image-link" href="../toolsrus-ctf-write-up/">
        <img class="post-card-image" srcset="../content/images/size/w300/2020/04/77fd9d1804d33b5cf3adf1a2f3dcc34b-1.jpg 300w,
                   ../content/images/size/w600/2020/04/77fd9d1804d33b5cf3adf1a2f3dcc34b-1.jpg 600w,
                  ../content/images/size/w1000/2020/04/77fd9d1804d33b5cf3adf1a2f3dcc34b-1.jpg 1000w,
                 ../content/images/size/w2000/2020/04/77fd9d1804d33b5cf3adf1a2f3dcc34b-1.jpg 2000w" sizes="(max-width: 1000px) 400px, 700px" loading="lazy" src="../content/images/size/w600/2020/04/77fd9d1804d33b5cf3adf1a2f3dcc34b-1.jpg" alt="ToolsRus CTF | write-up">
    </a>

    <div class="post-card-content">

        <a class="post-card-content-link" href="../toolsrus-ctf-write-up/">

            <header class="post-card-header">
                    <div class="post-card-primary-tag">CTF</div>
                <h2 class="post-card-title">ToolsRus CTF | write-up</h2>
            </header>

            <section class="post-card-excerpt">
                    <p>Hello all, today's challenge is made by Tryhackme.com, it's a fun CTF ratted as easy, totally straight forward. Let's enumerate the machine root@kali:~# nmap -sC -sV 10.10.</p>
            </section>

        </a>

        <footer class="post-card-meta">
            <ul class="author-list">
                <li class="author-list-item">
            
                    <div class="author-name-tooltip">
                        fr33s0ul
                    </div>
            
                    <a href="../author/fr33s0ul/" class="static-avatar">
                        <img class="author-profile-image" src="../content/images/size/w100/2020/03/asdasd.gif" alt="fr33s0ul">
                    </a>
                </li>
            </ul>
            <div class="post-card-byline-content">
                <span><a href="../author/fr33s0ul/">fr33s0ul</a></span>
                <span class="post-card-byline-date"><time datetime="2020-04-03">3 Apr 2020</time> <span class="bull">•</span> 6 min read</span>
            </div>
        </footer>

    </div>

</article>

                <article class="post-card post tag-ctf ">

    <a class="post-card-image-link" href="../pickle-rick/">
        <img class="post-card-image" srcset="../content/images/size/w300/2020/04/rick_morty.jpg 300w,
                   ../content/images/size/w600/2020/04/rick_morty.jpg 600w,
                  ../content/images/size/w1000/2020/04/rick_morty.jpg 1000w,
                 ../content/images/size/w2000/2020/04/rick_morty.jpg 2000w" sizes="(max-width: 1000px) 400px, 700px" loading="lazy" src="../content/images/size/w600/2020/04/rick_morty.jpg" alt="Pickle Rick CTF | write-up">
    </a>

    <div class="post-card-content">

        <a class="post-card-content-link" href="../pickle-rick/">

            <header class="post-card-header">
                    <div class="post-card-primary-tag">CTF</div>
                <h2 class="post-card-title">Pickle Rick CTF | write-up</h2>
            </header>

            <section class="post-card-excerpt">
                    <p>Hello again, today we'll cover another CTF made by Tryhackme.com such a cool box I enjoyed every second of it, I hope you do and let's start our challenge</p>
            </section>

        </a>

        <footer class="post-card-meta">
            <ul class="author-list">
                <li class="author-list-item">
            
                    <div class="author-name-tooltip">
                        fr33s0ul
                    </div>
            
                    <a href="../author/fr33s0ul/" class="static-avatar">
                        <img class="author-profile-image" src="../content/images/size/w100/2020/03/asdasd.gif" alt="fr33s0ul">
                    </a>
                </li>
            </ul>
            <div class="post-card-byline-content">
                <span><a href="../author/fr33s0ul/">fr33s0ul</a></span>
                <span class="post-card-byline-date"><time datetime="2020-04-02">2 Apr 2020</time> <span class="bull">•</span> 3 min read</span>
            </div>
        </footer>

    </div>

</article>
        </div>
    </div>
</aside>




        <footer class="site-footer outer">
            <div class="site-footer-content inner">
                <section class="copyright"><a href="../">fr33s0ul</a> © 2020</section>
                <nav class="site-footer-nav">
                    <a href="../">Latest Posts</a>
                    
                    <a href="https://twitter.com/fr33soul_" target="_blank" rel="noopener">Twitter</a>
                    <a href="https://ghost.org" target="_blank" rel="noopener">Ghost</a>
                </nav>
            </div>
        </footer>

    </div>


    <script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous">
    </script>
    <script src="../assets/built/casper.js?v=0a4893ecd9"></script>

    <script>
        // Parse the URL parameter
        function getParameterByName(name, url) {
            if (!url) url = window.location.href;
            name = name.replace(/[\[\]]/g, "\\$&");
            var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
                results = regex.exec(url);
            if (!results) return null;
            if (!results[2]) return '';
            return decodeURIComponent(results[2].replace(/\+/g, " "));
        }

        // Give the parameter a variable name
        var action = getParameterByName('action');
        var success = getParameterByName('success');

        $(document).ready(function () {
            if (action == 'subscribe' && (success === null || success === 'true')) {
                $('body').addClass('subscribe-success');
            }

            if (action == 'subscribe' && success === 'false') {
                $('body').addClass('subscribe-failure');
            }

            $('.subscribe-notification .subscribe-close-button').click(function () {
                $('.subscribe-notification').addClass('close');
            });

            // Reset form on opening subscrion overlay
            $('.subscribe-button').click(function() {
                $('.subscribe-overlay form').removeClass();
                $('.subscribe-email').val('');
            });
        });
    </script>

    <script>
    $(document).ready(function () {
        // FitVids - start
        var $postContent = $(".post-full-content");
        $postContent.fitVids();
        // FitVids - end

        // Replace nav with title on scroll - start
        Casper.stickyNavTitle({
            navSelector: '.site-nav-main',
            titleSelector: '.post-full-title',
            activeClass: 'nav-post-title-active'
        });
        // Replace nav with title on scroll - end

        // Hover on avatar
        var hoverTimeout;
        $('.author-list-item').hover(function () {
            var $this = $(this);

            clearTimeout(hoverTimeout);

            $('.author-card').removeClass('hovered');
            $(this).children('.author-card').addClass('hovered');

        }, function () {
            var $this = $(this);

            hoverTimeout = setTimeout(function () {
                $this.children('.author-card').removeClass('hovered');
            }, 800);
        });
    });
</script>


    

</body>
